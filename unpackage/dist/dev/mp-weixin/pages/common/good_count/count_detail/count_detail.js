(global.webpackJsonp=global.webpackJsonp||[]).push([["pages/common/good_count/count_detail/count_detail"],{220:
/*!**********************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/wechat/kcb_all/main.js?{"page":"pages%2Fcommon%2Fgood_count%2Fcount_detail%2Fcount_detail"} ***!
  \**********************************************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";(function(e){o(/*! uni-pages */4),o(/*! @dcloudio/uni-stat */5);t(o(/*! vue */2));function t(e){return e&&e.__esModule?e:{default:e}}e(t(o(/*! ./pages/common/good_count/count_detail/count_detail.vue */221)).default)}).call(this,o(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1).createPage)},221:
/*!***********************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue ***!
  \***********************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";o.r(t);var r=o(/*! ./count_detail.vue?vue&type=template&id=44c7c1e0& */222),s=o(/*! ./count_detail.vue?vue&type=script&lang=js& */224);for(var n in s)"default"!==n&&function(e){o.d(t,e,function(){return s[e]})}(n);o(/*! ./count_detail.vue?vue&type=style&index=0&lang=css& */226);var u=o(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */70),d=Object(u.default)(s.default,r.render,r.staticRenderFns,!1,null,null,null,!1,r.components,void 0);d.options.__file="C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue",t.default=d.exports},222:
/*!******************************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue?vue&type=template&id=44c7c1e0& ***!
  \******************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,o){"use strict";o.r(t);var r=o(/*! -!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./count_detail.vue?vue&type=template&id=44c7c1e0& */223);o.d(t,"render",function(){return r.render}),o.d(t,"staticRenderFns",function(){return r.staticRenderFns}),o.d(t,"recyclableRender",function(){return r.recyclableRender}),o.d(t,"components",function(){return r.components})},223:
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue?vue&type=template&id=44c7c1e0& ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,o){"use strict";o.r(t),o.d(t,"render",function(){return r}),o.d(t,"staticRenderFns",function(){return n}),o.d(t,"recyclableRender",function(){return s}),o.d(t,"components",function(){});var r=function(){var e=this.$createElement,t=(this._self._c,this.nowDay.split(" "));this.$mp.data=Object.assign({},{$root:{g0:t}})},s=!1,n=[];r._withStripped=!0},224:
/*!************************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue?vue&type=script&lang=js& ***!
  \************************************************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";o.r(t);var r=o(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./count_detail.vue?vue&type=script&lang=js& */225),s=o.n(r);for(var n in r)"default"!==n&&function(e){o.d(t,e,function(){return r[e]})}(n);t.default=s.a},225:
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue?vue&type=script&lang=js& ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,s,n=c(o(/*! hydrogen-js-sdk */13)),u=c(o(/*! @/utils/common.js */77)),d=c(o(/*! @/utils/print.js */87));function c(e){return e&&e.__esModule?e:{default:e}}var a={data:function(){return{products:null,button_disabled:!1,beizhu_text:"",real_money:0,all_money:0,total_num:0,producer:null,nowDay:u.default.getDay(0,!0,!0)}},onLoad:function(){s=this,r=e.getStorageSync("uid"),this.products=e.getStorageSync("products");for(var t=0;t<this.products.length;t++)this.total_num+=Number(this.products[t].num)},methods:{bindDateChange:function(e){s.nowDay=e.detail.value+" 00:00:00"},formSubmit:function(t){console.log(t),this.button_disabled=!0,e.showLoading({title:"上传中..."});for(var o=new Array,c=[],a=[],i=0;i<this.products.length;i++){var l=n.default.Query("Bills"),f={},p=n.default.Pointer("_User").set(r),m=n.default.Pointer("Goods").set(this.products[i].header?this.products[i].header.objectId:this.products[i].objectId),h=e.getStorageSync("masterId"),g=n.default.Pointer("_User").set(h);if(l.set("goodsName",this.products[i].goodsName),l.set("retailPrice",this.products[i].modify_retailPrice.toString()),l.set("num",Number(this.products[i].num)),l.set("reserve",Number(this.products[i].reserve)),l.set("now_reserve",this.products[i].num.toString()),l.set("total_money",this.products[i].total_money),l.set("opreater",g),l.set("goodsId",m),l.set("userId",p),l.set("type",3),l.set("createdTime",{__type:"Date",iso:s.nowDay}),s.products[i].stocks&&s.products[i].stocks.objectId){var v=n.default.Pointer("stocks").set(s.products[i].stocks.objectId);l.set("stock",v),a.push(this.products[i].stocks.objectId),f.stock=s.products[i].stocks.stock_name}var _={};this.products[i].selectd_model&&(_.selected_model=this.products[i].selected_model,_.models=this.products[i].models,f.goodsId=_),f.goodsName=this.products[i].goodsName,f.reserve=this.products[i].reserve,f.now_reserve=this.products[i].num.toString(),f.packingUnit=this.products[i].packingUnit,o.push(l),c.push(f)}n.default.Query("Bills").saveAll(o).then(function(o){var i=n.default.Pointer("_User").set(r),l=e.getStorageSync("masterId"),f=n.default.Pointer("_User").set(l),p=n.default.Query("order_opreations");p.set("beizhu",t.detail.value.input_beizhu),p.set("detail",c),p.set("type",3),p.set("opreater",f),p.set("master",i),p.set("goodsName",s.products[0].goodsName),p.set("stockIds",a),p.set("createdTime",{__type:"Date",iso:s.nowDay}),p.save().then(function(t){var o=t.objectId;e.hideLoading(),e.showToast({title:"产品盘点成功",icon:"success",success:function(){for(var r=function(e){var t=0;n.default.Query("Goods").get(s.products[e].objectId).then(function(o){if(s.products[e].selectd_model){var r=!0,d=!1,c=void 0;try{for(var a,i=s.products[e].selected_model[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){delete a.value.num}}catch(e){d=!0,c=e}finally{try{r||null==i.return||i.return()}finally{if(d)throw c}}o.set("models",s.products[e].selected_model),t=Number(s.products[e].num)}else t=Number(s.products[e].num);if(o.set("reserve",t),o.save(),s.products[e].header){var l=n.default.Query("Goods");l.equalTo("header","==",s.products[e].header.objectId),l.equalTo("order","==",1),l.statTo("sum","reserve"),l.find().then(function(t){var o=t[0]._sumReserve;n.default.Query("Goods").get(s.products[e].header.objectId).then(function(t){t.set("reserve",o),t.save(),u.default.modifyStockType(s.products[e].header.objectId)})})}else u.default.modifyStockType(s.products[e].objectId)}).catch(function(e){console.log(e)})},c=0;c<s.products.length;c++)r(c);s.button_disabled=!1,e.setStorageSync("is_option",!0),setTimeout(function(){e.removeStorageSync("_warehouse"),e.removeStorageSync("out_warehouse"),e.removeStorageSync("category"),e.removeStorageSync("warehouse"),u.default.log(e.getStorageSync("user").nickName+"盘点了'"+s.products[0].goodsName+"'等"+s.products.length+"商品",3,t.objectId),e.getStorageSync("setting").auto_print&&d.default.autoPrint(o),e.navigateBack({delta:2})},500)}})})},function(e){console.log("异常处理")})}}};t.default=a}).call(this,o(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1).default)},226:
/*!********************************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue?vue&type=style&index=0&lang=css& ***!
  \********************************************************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";o.r(t);var r=o(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-1!./node_modules/css-loader??ref--6-oneOf-1-2!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./count_detail.vue?vue&type=style&index=0&lang=css& */227),s=o.n(r);for(var n in r)"default"!==n&&function(e){o.d(t,e,function(){return r[e]})}(n);t.default=s.a},227:
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-1!./node_modules/css-loader??ref--6-oneOf-1-2!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue?vue&type=style&index=0&lang=css& ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,o){}},[[220,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/pages/common/good_count/count_detail/count_detail.js.map