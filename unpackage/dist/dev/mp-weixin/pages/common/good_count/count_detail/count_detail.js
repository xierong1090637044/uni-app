(global.webpackJsonp=global.webpackJsonp||[]).push([["pages/common/good_count/count_detail/count_detail"],{220:
/*!**********************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/wechat/kcb_all/main.js?{"page":"pages%2Fcommon%2Fgood_count%2Fcount_detail%2Fcount_detail"} ***!
  \**********************************************************************************************************************************/
/*! no static exports found */function(t,e,o){"use strict";(function(t){o(/*! uni-pages */4),o(/*! @dcloudio/uni-stat */5);e(o(/*! vue */2));function e(t){return t&&t.__esModule?t:{default:t}}t(e(o(/*! ./pages/common/good_count/count_detail/count_detail.vue */221)).default)}).call(this,o(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1).createPage)},221:
/*!***********************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue ***!
  \***********************************************************************************************************/
/*! no static exports found */function(t,e,o){"use strict";o.r(e);var s=o(/*! ./count_detail.vue?vue&type=template&id=44c7c1e0& */222),r=o(/*! ./count_detail.vue?vue&type=script&lang=js& */224);for(var n in r)"default"!==n&&function(t){o.d(e,t,function(){return r[t]})}(n);o(/*! ./count_detail.vue?vue&type=style&index=0&lang=css& */226);var u=o(/*! ./node_modules/vue-loader/lib/runtime/componentNormalizer.js */70),d=Object(u.default)(r.default,s.render,s.staticRenderFns,!1,null,null,null);d.options.__file="C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue",e.default=d.exports},222:
/*!******************************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue?vue&type=template&id=44c7c1e0& ***!
  \******************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */function(t,e,o){"use strict";o.r(e);var s=o(/*! -!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./count_detail.vue?vue&type=template&id=44c7c1e0& */223);o.d(e,"render",function(){return s.render}),o.d(e,"staticRenderFns",function(){return s.staticRenderFns})},223:
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue?vue&type=template&id=44c7c1e0& ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */function(t,e,o){"use strict";o.r(e),o.d(e,"render",function(){return s}),o.d(e,"staticRenderFns",function(){return r});var s=function(){var t=this.$createElement,e=(this._self._c,this.nowDay.split(" "));this.$mp.data=Object.assign({},{$root:{g0:e}})},r=[];s._withStripped=!0},224:
/*!************************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue?vue&type=script&lang=js& ***!
  \************************************************************************************************************************************/
/*! no static exports found */function(t,e,o){"use strict";o.r(e);var s=o(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./count_detail.vue?vue&type=script&lang=js& */225),r=o.n(s);for(var n in s)"default"!==n&&function(t){o.d(e,t,function(){return s[t]})}(n);e.default=r.a},225:
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue?vue&type=script&lang=js& ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s,r,n=a(o(/*! hydrogen-js-sdk */13)),u=a(o(/*! @/utils/common.js */77)),d=a(o(/*! @/utils/print.js */89));function a(t){return t&&t.__esModule?t:{default:t}}var c={data:function(){return{products:null,button_disabled:!1,beizhu_text:"",real_money:0,all_money:0,total_num:0,producer:null,nowDay:u.default.getDay(0,!0,!0)}},onLoad:function(){r=this,s=t.getStorageSync("uid"),this.products=t.getStorageSync("products");for(var e=0;e<this.products.length;e++)this.total_num+=Number(this.products[e].num)},methods:{bindDateChange:function(t){r.nowDay=t.detail.value+" 00:00:00"},formSubmit:function(e){console.log(e),this.button_disabled=!0,t.showLoading({title:"上传中..."});for(var o=new Array,a=[],c=[],i=0;i<this.products.length;i++){var l=n.default.Query("Bills"),f={},p=n.default.Pointer("_User").set(s),m=n.default.Pointer("Goods").set(this.products[i].header?this.products[i].header.objectId:this.products[i].objectId),h=t.getStorageSync("masterId"),g=n.default.Pointer("_User").set(h);if(l.set("goodsName",this.products[i].goodsName),l.set("retailPrice",this.products[i].modify_retailPrice.toString()),l.set("num",Number(this.products[i].num)),l.set("reserve",Number(this.products[i].reserve)),l.set("now_reserve",this.products[i].num.toString()),l.set("total_money",this.products[i].total_money),l.set("opreater",g),l.set("goodsId",m),l.set("userId",p),l.set("type",3),l.set("createdTime",{__type:"Date",iso:r.nowDay}),r.products[i].stocks&&r.products[i].stocks.objectId){var _=n.default.Pointer("stocks").set(r.products[i].stocks.objectId);l.set("stock",_),c.push(this.products[i].stocks.objectId),f.stock=r.products[i].stocks.stock_name}var v={};this.products[i].selectd_model&&(v.selected_model=this.products[i].selected_model,v.models=this.products[i].models,f.goodsId=v),f.goodsName=this.products[i].goodsName,f.reserve=this.products[i].reserve,f.now_reserve=this.products[i].num.toString(),o.push(l),a.push(f)}n.default.Query("Bills").saveAll(o).then(function(o){var i=n.default.Pointer("_User").set(s),l=t.getStorageSync("masterId"),f=n.default.Pointer("_User").set(l),p=n.default.Query("order_opreations");p.set("beizhu",e.detail.value.input_beizhu),p.set("detail",a),p.set("type",3),p.set("opreater",f),p.set("master",i),p.set("goodsName",r.products[0].goodsName),p.set("stockIds",c),p.set("createdTime",{__type:"Date",iso:r.nowDay}),p.save().then(function(e){var o=e.objectId;t.hideLoading(),t.showToast({title:"产品盘点成功",icon:"success",success:function(){for(var s=function(t){var e=0;n.default.Query("Goods").get(r.products[t].objectId).then(function(o){if(r.products[t].selectd_model){var s=!0,u=!1,d=void 0;try{for(var a,c=r.products[t].selected_model[Symbol.iterator]();!(s=(a=c.next()).done);s=!0){delete a.value.num}}catch(t){u=!0,d=t}finally{try{s||null==c.return||c.return()}finally{if(u)throw d}}o.set("models",r.products[t].selected_model),e=Number(r.products[t].num)}else e=Number(r.products[t].num);if(o.set("reserve",e),o.set("stocktype",e>r.products[t].warning_num?1:0),o.save(),r.products[t].header){var i=n.default.Query("Goods");i.equalTo("header","==",r.products[t].header.objectId),i.equalTo("order","==",1),i.statTo("sum","reserve"),i.find().then(function(e){console.log("dasds",e);var o=e[0]._sumReserve;n.default.Query("Goods").get(r.products[t].header.objectId).then(function(e){e.set("reserve",o),e.set("stocktype",o>r.products[t].warning_num?1:0),e.save()})})}}).catch(function(t){console.log(t)})},a=0;a<r.products.length;a++)s(a);r.button_disabled=!1,t.setStorageSync("is_option",!0),setTimeout(function(){t.removeStorageSync("_warehouse"),t.removeStorageSync("out_warehouse"),t.removeStorageSync("category"),t.removeStorageSync("warehouse"),u.default.log(t.getStorageSync("user").nickName+"盘点了'"+r.products[0].goodsName+"'等"+r.products.length+"商品",3,e.objectId),t.getStorageSync("setting").auto_print&&d.default.autoPrint(o),t.navigateBack({delta:2})},500)}})})},function(t){console.log("异常处理")})}}};e.default=c}).call(this,o(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1).default)},226:
/*!********************************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue?vue&type=style&index=0&lang=css& ***!
  \********************************************************************************************************************************************/
/*! no static exports found */function(t,e,o){"use strict";o.r(e);var s=o(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-1!./node_modules/css-loader??ref--6-oneOf-1-2!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./count_detail.vue?vue&type=style&index=0&lang=css& */227),r=o.n(s);for(var n in s)"default"!==n&&function(t){o.d(e,t,function(){return s[t]})}(n);e.default=r.a},227:
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-1!./node_modules/css-loader??ref--6-oneOf-1-2!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/wechat/kcb_all/pages/common/good_count/count_detail/count_detail.vue?vue&type=style&index=0&lang=css& ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,o){}},[[220,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/pages/common/good_count/count_detail/count_detail.js.map