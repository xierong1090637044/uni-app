<view class="page"><block wx:if="{{loading}}"><loading vue-id="1e0224b0-1" bind:__l="__l"></loading></block><block wx:else><view><view class="frist"><block wx:if="{{product.goodsIcon}}"><image style="width:100%;height:100%;" src="{{product.goodsIcon}}" mode="aspectFit"></image></block><block wx:else><image style="height:100%;" src="/static/goods-default.png" mode="aspectFit"></image></block></view><view class="second"><view class="second_one"><view style="color:#3d3d3d;font-weight:bold;font-size:34rpx;">{{product.goodsName}}</view><block wx:if="{{user.rights&&user.rights.othercurrent[0]!='0'}}"><view></view></block><block wx:else><view>成本价:<text style="color:#FD2E32;margin-left:20rpx;">{{product.costPrice?product.costPrice:"未填写"}}</text></view></block><view>零售价:<text style="color:#FD2E32;margin-left:20rpx;">{{product.retailPrice?product.retailPrice:"未填写"}}</text></view></view><view class="second_one"><view>品牌:<text class="second_right_text">{{product.producer?product.producer:"未填写"}}</text></view><view>型号:<text class="second_right_text">{{(product.packageContent?product.packageContent:"未填写")+"*"+(product.packingUnit?product.packingUnit:"未填写")}}</text></view><view>简介:<text class="second_right_text">{{product.product_info?product.product_info:"未填写"}}</text></view><view>存放位置:<text style="margin-left:20rpx;color:#3D3D3D;">{{product.position?product.position:"未填写"}}</text></view><block wx:if="{{product.nousetime}}"><view>过期时间:<text style="margin-left:20rpx;color:#3D3D3D;">{{product.nousetime}}</text></view></block><block wx:if="{{product.goodsClass&&product.goodsClass.class_text}}"><view>所属一级分类<text style="margin-left:20rpx;color:#3D3D3D;">{{product.goodsClass.class_text}}</text></view></block><block wx:if="{{product.second_class&&product.second_class.class_text}}"><view>所属二级分类<text style="margin-left:20rpx;color:#3D3D3D;">{{product.second_class.class_text}}</text></view></block></view><view class="second_one display_flex_bet"><view>总库存:<text class="second_right_text">{{product.all_reserve}}</text></view><view class="display_flex"><text style="margin-right:10rpx;">分库存</text><switch checked="{{get_reserve_checked}}" data-event-opts="{{[['change',[['change_state',['$event']]]]]}}" bindchange="__e"></switch></view></view><block wx:for="{{product.stocks}}" wx:for-item="item" wx:for-index="index" wx:key="index"><block wx:if="{{get_reserve_checked}}"><view class="second_one"><view>存放店仓:<text style="margin-left:20rpx;color:#3D3D3D;">{{item.stock_name?item.stock_name:"未填写"}}</text></view><view>当前库存:<text style="color:#FD2E32;margin-left:20rpx;">{{item.reserve}}</text></view><block wx:if="{{item.models}}"><view style="color:#3D3D3D;"><block wx:for="{{item.models}}" wx:for-item="model" wx:for-index="index" wx:key="index"><view class="display_flex_bet"><view style="font-size:24rpx;">{{model.custom1.value+model.custom2.value+model.custom3.value+model.custom4.value}}</view><view style="color:#FD2E32;font-size:24rpx;">{{"库存:"+model.reserve}}</view></view></block></view></block><view>预警数量:<text style="color:#FD2E32;margin-left:20rpx;">{{item.warning_num?item.warning_num:0}}</text></view><navigator class="display_flex_bet" hover-class="none" url="{{'/pages/manage/good_det/bad_history/bad_history?id='+item.good_id}}"><view>货损数量:<text style="color:#FD2E32;margin-left:20rpx;">{{item.bad_num?item.bad_num:0}}</text></view><fa-icon vue-id="{{'1e0224b0-2-'+index}}" type="angle-right" size="20" color="#999" bind:__l="__l"></fa-icon></navigator><view>条码:<text class="second_right_text">{{item.productCode}}</text></view><view class="display_flex"><view data-event-opts="{{[['tap',[['show_qrcode',['$0'],[[['product.stocks','',index]]]]]]]}}" class="opion_item" bindtap="__e">生成二维码</view><navigator class="opion_item" hover-class="none" url="{{'custom_detail/custom_detail?id='+item.good_id}}">客户统计</navigator><navigator class="opion_item" hover-class="none" url="{{'../operations/operations?objectId='+item.good_id+'&goodsName='+product.goodsName}}">此产品的操作记录</navigator></view><view class="display_flex"><view data-event-opts="{{[['tap',[['print_info',['$0'],[[['product.stocks','',index]]]]]]]}}" class="opion_item" bindtap="__e">打印</view><view data-event-opts="{{[['tap',[['modify',['$0'],[[['product.stocks','',index]]]]]]]}}" class="opion_item" bindtap="__e">编辑</view><view data-event-opts="{{[['tap',[['add_badnum',['$0'],[[['product.stocks','',index]]]]]]]}}" class="opion_item" bindtap="__e">记录货损</view><view data-event-opts="{{[['tap',[['delete_good',['$0','$1',index],[[['product.stocks','',index,'good_id']],[['product.stocks','',index,'accessory']]]]]]]}}" class="opion_item" bindtap="__e">删除</view></view></view></block></block></view><block wx:if="{{is_show}}"><view class="qrimg"><view data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" style="text-align:right;margin-right:20rpx;" bindtap="__e"><fa-icon vue-id="1e0224b0-3" type="times-circle" size="20" color="#fff" bind:__l="__l"></fa-icon></view><view data-event-opts="{{[['tap',[['saveQrcode',['$event']]]]]}}" style="margin-top:20%;" bindtap="__e"><view style="padding:20rpx;background:#fff;"><tki-qrcode class="vue-ref" vue-id="1e0224b0-4" cid="qrcode" val="{{select_qrcode}}" size="{{200}}" loadMake="{{true}}" usingComponents="{{true}}" unit="rpx" data-ref="qrcode" data-event-opts="{{[['^result',[['qrR']]]]}}" bind:result="__e" bind:__l="__l"></tki-qrcode></view><view style="color:#fff;margin-top:30rpx;font-size:32rpx;">{{"产品:"+product.goodsName}}</view><view style="color:#fff;margin-top:20rpx;font-size:24rpx;">(点击二维码可下载)</view></view></view></block><uni-popup class="popup" vue-id="1e0224b0-5" show="{{bad_numshow}}" type="top" mode="fixed" data-event-opts="{{[['^hidePopup',[['e1']]]]}}" bind:hidePopup="__e" bind:__l="__l" vue-slots="{{['default']}}"><view class="popup_content"><view class="popup_title" style="text-align:center;margin-bottom:20rpx;">记录货损</view><view style="margin-bottom:20rpx;"><input class="popup_input" placeholder="请输入该产品的货损数量" data-event-opts="{{[['input',[['__set_model',['$0','num','$event',[]],['badnum']]]]]}}" value="{{badnum.num}}" bindinput="__e"/></view><view style="margin-bottom:20rpx;"><input class="popup_input" placeholder="请输入备注" data-event-opts="{{[['input',[['__set_model',['$0','desc','$event',[]],['badnum']]]]]}}" value="{{badnum.desc}}" bindinput="__e"/></view><view><button data-event-opts="{{[['tap',[['confrim_badnum',['$event']]]]]}}" class="popup_button" bindtap="__e">确认</button></view></view></uni-popup></view></block></view>