(global.webpackJsonp=global.webpackJsonp||[]).push([["pages/report/EnteringHistory/detail/detail"],{187:
/*!******************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/新建文件夹 (8)/kcbThou/main.js?{"page":"pages%2Freport%2FEnteringHistory%2Fdetail%2Fdetail"} ***!
  \******************************************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";(function(e){o(/*! uni-pages */4),o(/*! @dcloudio/uni-stat */5);t(o(/*! vue */2));function t(e){return e&&e.__esModule?e:{default:e}}e(t(o(/*! ./pages/report/EnteringHistory/detail/detail.vue */188)).default)}).call(this,o(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1).createPage)},188:
/*!*******************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/新建文件夹 (8)/kcbThou/pages/report/EnteringHistory/detail/detail.vue ***!
  \*******************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";o.r(t);var n=o(/*! ./detail.vue?vue&type=template&id=422d461c& */189),i=o(/*! ./detail.vue?vue&type=script&lang=js& */191);for(var r in i)"default"!==r&&function(e){o.d(t,e,function(){return i[e]})}(r);o(/*! ./detail.vue?vue&type=style&index=0&lang=css& */193);var s=o(/*! ../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/runtime/componentNormalizer.js */70),c=Object(s.default)(i.default,n.render,n.staticRenderFns,!1,null,null,null);c.options.__file="Desktop/新建文件夹 (8)/kcbThou/pages/report/EnteringHistory/detail/detail.vue",t.default=c.exports},189:
/*!**************************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/新建文件夹 (8)/kcbThou/pages/report/EnteringHistory/detail/detail.vue?vue&type=template&id=422d461c& ***!
  \**************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */function(e,t,o){"use strict";o.r(t);var n=o(/*! -!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib??vue-loader-options!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=template&id=422d461c& */190);o.d(t,"render",function(){return n.render}),o.d(t,"staticRenderFns",function(){return n.staticRenderFns})},190:
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/新建文件夹 (8)/kcbThou/pages/report/EnteringHistory/detail/detail.vue?vue&type=template&id=422d461c& ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */function(e,t,o){"use strict";o.r(t),o.d(t,"render",function(){return n}),o.d(t,"staticRenderFns",function(){return i});var n=function(){var e=this.$createElement;this._self._c},i=[];n._withStripped=!0},191:
/*!********************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/新建文件夹 (8)/kcbThou/pages/report/EnteringHistory/detail/detail.vue?vue&type=script&lang=js& ***!
  \********************************************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";o.r(t);var n=o(/*! -!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib??vue-loader-options!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=script&lang=js& */192),i=o.n(n);for(var r in n)"default"!==r&&function(e){o.d(t,e,function(){return n[e]})}(r);t.default=i.a},192:
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/新建文件夹 (8)/kcbThou/pages/report/EnteringHistory/detail/detail.vue?vue&type=script&lang=js& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(o(/*! hydrogen-js-sdk */13)),i=s(o(/*! @/utils/print.js */88)),r=s(o(/*! @/utils/common.js */77));function s(e){return e&&e.__esModule?e:{default:e}}var c,u,a=e.getStorageSync("uid"),l={components:{loading:function(){return o.e(/*! import() | components/Loading/index */"components/Loading/index").then(o.bind(null,/*! @/components/Loading/index.vue */819))},uniNavBar:function(){return o.e(/*! import() | components/uni-nav-bar/uni-nav-bar */"components/uni-nav-bar/uni-nav-bar").then(o.bind(null,/*! @/components/uni-nav-bar/uni-nav-bar.vue */831))}},data:function(){return{user:e.getStorageSync("user"),identity:e.getStorageSync("identity"),othercurrent:"",bills:[],loading:!0,products:null,detail:null,stock:""}},onLoad:function(e){console.log(e),c=this,u=e.id,c.user.rights&&c.user.rights.othercurrent&&(c.othercurrent=c.user.rights.othercurrent),c.getdetail(u)},onShow:function(){c.stock=e.getStorageSync("warehouse")?e.getStorageSync("warehouse")[0].stock:""},onShareAppMessage:function(e){return"button"===e.from&&console.log(e.target),{title:"高明燃气库存管理-操作单详情",path:"/pages/report/EnteringHistory/detail/detail?id="+u}},methods:{gotoexpressDet:function(){c.user.is_vip?e.navigateTo({url:"../expressDet/expressDet?number="+c.detail.expressNum}):e.showToast({title:"您还不是会员，无法使用",icon:"none"})},priview:function(t){e.previewImage({current:t,urls:c.detail.Images})},show_options:function(){var t=["打印"];-1!=c.detail.type&&1!=c.detail.type||(-1!=c.othercurrent.indexOf("3")||1==c.identity&&1==c.detail.extra_type?(t=-1==c.detail.type?["销售出库","撤销","打印"]:["采购入库","撤销","打印"],e.showActionSheet({itemList:t,success:function(t){if(0==t.tapIndex){if(1==c.detail.type)if(c.detail.status)e.showToast({title:"该笔采购单已入库",icon:"none"});else{if(""==e.getStorageSync("warehouse")||null==e.getStorageSync("warehouse"))return void e.showToast({icon:"none",title:"请选择仓库"});c.confrimOrder()}else if(-1==c.detail.type)if(c.detail.status)e.showToast({title:"该笔销售单已出库",icon:"none"});else{if(""==e.getStorageSync("warehouse")||null==e.getStorageSync("warehouse"))return void e.showToast({icon:"none",title:"请选择仓库"});c.confrimOrder()}e.setStorageSync("is_option",!0)}else 1==t.tapIndex?(c.revoke(),e.setStorageSync("is_option",!0)):2==t.tapIndex&&i.default.print_operations(c.detail,c.products)},fail:function(e){console.log(e.errMsg)}})):(t=["撤销","打印"],e.showActionSheet({itemList:t,success:function(t){0==t.tapIndex?(c.revoke(),e.setStorageSync("is_option",!0)):1==t.tapIndex&&i.default.print_operations(c.detail,c.products)},fail:function(e){console.log(e.errMsg)}})))},getdetail:function(e){var t=n.default.Query("order_opreations");t.include("opreater","custom","producer","stock"),t.get(e).then(function(e){console.log(e),c.detail=e,c.products=e.detail,c.bills=e.bills,c.loading=!1}).catch(function(e){console.log(e)})},revoke:function(){wx.showModal({title:"提示",content:"数据撤销后不可恢复，请谨慎撤销！",success:function(t){t.confirm&&e.showToast({title:"等待下次更新",icon:"none"})}})},confrimOrder:function(){wx.showModal({title:"提示",content:"确定进行此操作！",success:function(t){if(t.confirm){e.showLoading({title:"操作中，请勿退出该页面..."});var o=n.default.Pointer("stocks").set(c.stock.objectId),i=n.default.Query("order_opreations");i.set("id",u),i.set("stock",o),i.set("status",!0),i.save().then(function(e){var t=0;if(1==c.detail.type){var o=!0,n=!1,i=void 0;try{for(var r,s=c.products[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var u=r.value;c.addOrReduceGoodReserve(u,t),t+=1}}catch(e){n=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(n)throw i}}}else if(-1==c.detail.type){var a=!0,l=!1,d=void 0;try{for(var f,g=c.products[Symbol.iterator]();!(a=(f=g.next()).done);a=!0){var h=f.value;c.ReduceGoodReserve(h,t),t+=1}}catch(e){l=!0,d=e}finally{try{a||null==g.return||g.return()}finally{if(l)throw d}}}}).catch(function(e){console.log(e)})}}})},addOrReduceGoodReserve:function(t,o){n.default.Query("NGoods").get(t.goodsId.objectId).then(function(i){console.log("当前主产品",i);var s=i;i.set("reserve",i.reserve+t.num),i.save().then(function(i){var l=n.default.Query("NGoods");l.equalTo("userId","==",a),l.equalTo("header","==",t.goodsId.objectId),l.equalTo("stocks","==",c.stock.objectId),l.find().then(function(i){(console.log("仓库里的产品",i),0==i.length)?(t.objectId=t.goodsId.objectId,t.costPrice=s.costPrice,t.retailPrice=s.retailPrice,r.default.upload_good_withNoCan(t,c.stock,Number(t.num)).then(function(t){if(console.log(t),o==c.products.length-1){var i=n.default.Pointer("stocks").set(c.stock.objectId),r=n.default.Query("NBills");r.containedIn("objectId",c.bills),r.find().then(function(t){t.set("status",!0),t.set("stock",i),t.saveAll().then(function(t){e.hideLoading(),c.getdetail(u),setTimeout(function(){e.showToast({title:"采购入库成功"})},1e3)}).catch(function(e){console.log(e)})})}})):n.default.Query("NGoods").get(i[0].objectId).then(function(i){i.set("reserve",i.reserve+t.num),i.save().then(function(t){var i=n.default.Pointer("stocks").set(c.stock.objectId);if(o==c.products.length-1){var r=n.default.Query("NBills");r.containedIn("objectId",c.bills),r.find().then(function(t){t.set("status",!0),t.set("stock",i),t.saveAll().then(function(t){e.hideLoading(),c.getdetail(u),setTimeout(function(){e.showToast({title:"采购入库成功"})},1e3)}).catch(function(e){console.log(e)})})}})})})})})},ReduceGoodReserve:function(t,o){n.default.Query("NGoods").get(t.goodsId.objectId).then(function(i){console.log("当前主产品",i),i.set("reserve",i.reserve-t.num),i.save().then(function(i){var s=n.default.Query("NGoods");s.equalTo("userId","==",a),s.equalTo("header","==",t.goodsId.objectId),s.equalTo("stocks","==",c.stock.objectId),s.find().then(function(i){(console.log("仓库里的产品",i),0==i.length)?(t.objectId=t.goodsId.objectId,t.costPrice=headerGood.costPrice,t.retailPrice=headerGood.retailPrice,r.default.upload_good_withNoCan(t,c.stock,0-Number(t.num)).then(function(t){if(console.log(t),o==c.products.length-1){var i=n.default.Pointer("stocks").set(c.stock.objectId),r=n.default.Query("NBills");r.containedIn("objectId",c.bills),r.find().then(function(t){t.set("status",!0),t.set("stock",i),t.saveAll().then(function(t){e.hideLoading(),c.getdetail(u),setTimeout(function(){e.showToast({title:"销售出库成功"})},1e3)}).catch(function(e){console.log(e)})})}})):n.default.Query("NGoods").get(i[0].objectId).then(function(i){i.set("reserve",i.reserve-t.num),i.save().then(function(t){if(o==c.products.length-1){var i=n.default.Pointer("stocks").set(c.stock.objectId),r=n.default.Query("NBills");r.containedIn("objectId",c.bills),r.find().then(function(t){t.set("status",!0),t.set("stock",i),t.saveAll().then(function(t){e.hideLoading(),c.getdetail(u),setTimeout(function(){e.showToast({title:"销售出库成功"})},1e3)}).catch(function(e){console.log(e)})})}})})})})})},delete_bill:function(t){var o=c.products[t],i=(c.bills[t],n.default.Query("NGoods"));i.set("id",o.goodsId.objectId),1==o.type?i.set("reserve",o.goodsId.reserve-o.num):-1==o.type&&i.set("reserve",o.goodsId.reserve+o.num),i.save().then(function(o){t==c.products.length-1&&(e.hideLoading(),e.navigateBack({delta:1}),setTimeout(function(){e.showToast({title:"撤销成功"})},1e3))})}}};t.default=l}).call(this,o(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1).default)},193:
/*!****************************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/新建文件夹 (8)/kcbThou/pages/report/EnteringHistory/detail/detail.vue?vue&type=style&index=0&lang=css& ***!
  \****************************************************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";o.r(t);var n=o(/*! -!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-1!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader??ref--6-oneOf-1-2!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src??ref--6-oneOf-1-3!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib??vue-loader-options!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!../../../../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=style&index=0&lang=css& */194),i=o.n(n);for(var r in n)"default"!==r&&function(e){o.d(t,e,function(){return n[e]})}(r);t.default=i.a},194:
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-1!./node_modules/css-loader??ref--6-oneOf-1-2!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/新建文件夹 (8)/kcbThou/pages/report/EnteringHistory/detail/detail.vue?vue&type=style&index=0&lang=css& ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,o){}},[[187,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/pages/report/EnteringHistory/detail/detail.js.map