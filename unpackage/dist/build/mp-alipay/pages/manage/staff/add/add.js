(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/manage/staff/add/add"],{"2f8e":function(t,e,n){"use strict";(function(t){n("d510"),n("921b");s(n("66fd"));var e=s(n("6052"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("c11b")["createPage"])},"3c86":function(t,e,n){"use strict";var s=n("6d26"),a=n.n(s);a.a},6052:function(t,e,n){"use strict";n.r(e);var s=n("db06"),a=n("e134");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("3c86");var f,i=n("f0c5"),d=Object(i["a"])(a["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],f);e["default"]=d.exports},"62b6":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(n("9546"));function a(t){return t&&t.__esModule?t:{default:t}}var o,f,i,d,r=function(){n.e("components/kilvn-fa-icon/fa-icon").then(function(){return resolve(n("4d52"))}.bind(null,n)).catch(n.oe)},c=function(){n.e("components/uni-nav-bar/uni-nav-bar").then(function(){return resolve(n("96bd"))}.bind(null,n)).catch(n.oe)},u={},l={components:{faIcon:r,uniNavBar:c},data:function(){return{stocks:t.getStorageSync("_warehouse"),modify_desc:"添加",disabled:!0,shop_name:"",staff_name:"",staff_address:"",staff_phone:"",staff_password:""}},onLoad:function(e){o=this,t.getStorageSync("uid")},onShow:function(){d=t.getStorageSync("staff"),i=t.getStorageSync("shop"),u=t.getStorageSync("staffRights")||{},d&&(t.setNavigationBarTitle({title:"修改员工信息"}),o.modify_desc="修改",o.shop_name=d.shop?d.shop.name:"",o.staff_name=d.nickName,o.staff_address=d.address,o.staff_phone=d.mobilePhoneNumber,o.staff_password=d.pwd||"",t.setStorageSync("staffRights",d.rights))},methods:{switchChange:function(t){o.disabled=t.detail.value},start_add:function(){null==this.staff_name?t.showToast({title:"请输入姓名",icon:"none"}):this.staff_phone.length<11?t.showToast({title:"账号不能少于11位",icon:"none"}):""==this.staff_password||null==this.staff_password||void 0==this.staff_password?t.showToast({title:"请输入密码",icon:"none"}):this.staff_password.length<6?t.showToast({title:"密码不能少于6位",icon:"none"}):o.add_data()},add_data:function(){if(t.showLoading({title:"上传中..."}),d){t.hideLoading();var e=t.getStorageSync("uid"),n=s.default.Pointer("_User"),a=(n.set(e),s.default.Query("_User"));a.set("username",o.staff_phone),a.set("nickName",o.staff_name),a.set("password",o.staff_password),a.set("pwd",o.staff_password),a.set("mobilePhoneNumber",o.staff_phone),a.set("address",null==o.staff_address?"":o.staff_address),a.set("avatarUrl","http://bmob-cdn-23134.b0.upaiyun.com/2019/04/29/4705b31340bfff8080c068f52fd17e2c.png"),a.set("disabled",!o.disabled),a.set("identity",2),a.set("id",d.objectId),a.save().then((function(e){o.select_stocks=[],t.removeStorageSync("staffRights"),setTimeout((function(){t.showToast({title:"修改成功"})}),1e3),t.navigateBack({delta:2})})).catch((function(t){console.log(t)}))}else{var r=s.default.Query("_User");r.equalTo("mobilePhoneNumber","==",o.staff_phone),r.find().then((function(e){if(console.log(e),0==e.length){t.hideLoading();var n=t.getStorageSync("uid"),a=s.default.Pointer("_User"),d=a.set(n),r=s.default.Query("_User");r.set("username",o.staff_phone),i&&r.set("shop",f),r.set("stocks",u.select_stocks||[]),r.set("nickName",o.staff_name),r.set("password",o.staff_password),r.set("pwd",o.staff_password),r.set("mobilePhoneNumber",o.staff_phone),r.set("rights",u),r.set("address",null==o.staff_address?"":o.staff_address),r.set("avatarUrl","http://bmob-cdn-23134.b0.upaiyun.com/2019/04/29/4705b31340bfff8080c068f52fd17e2c.png"),r.set("masterId",d),r.set("have_out",0),r.set("identity",2),r.set("disabled",!o.disabled),r.save().then((function(e){console.log(e),t.showToast({title:"添加成功"}),o.select_stocks=[],t.removeStorageSync("staffRights")})).catch((function(e){209==e.code&&t.showToast({title:"已存在此账号",icon:"none"})}))}else t.hideLoading(),t.showToast({title:"已存在此账号",icon:"none"})}))}}}};e.default=l}).call(this,n("c11b")["default"])},"6d26":function(t,e,n){},db06:function(t,e,n){"use strict";var s={"uni-nav-bar":function(){return n.e("components/uni-nav-bar/uni-nav-bar").then(n.bind(null,"96bd"))}},a=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return s}))},e134:function(t,e,n){"use strict";n.r(e);var s=n("62b6"),a=n.n(s);for(var o in s)"default"!==o&&function(t){n.d(e,t,(function(){return s[t]}))}(o);e["default"]=a.a}},[["2f8e","common/runtime","common/vendor"]]]);