(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/manage/staff/add/add"],{"2f8e":function(t,e,s){"use strict";(function(t){s("d510"),s("921b");n(s("66fd"));var e=n(s("6052"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,s("c11b")["createPage"])},"3c86":function(t,e,s){"use strict";var n=s("6d26"),a=s.n(n);a.a},6052:function(t,e,s){"use strict";s.r(e);var n=s("6444"),a=s("e134");for(var o in a)"default"!==o&&function(t){s.d(e,t,(function(){return a[t]}))}(o);s("3c86");var f,i=s("f0c5"),d=Object(i["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],f);e["default"]=d.exports},"62b6":function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(s("9546"));function a(t){return t&&t.__esModule?t:{default:t}}var o,f,i,d,c=function(){s.e("components/kilvn-fa-icon/fa-icon").then(function(){return resolve(s("4d52"))}.bind(null,s)).catch(s.oe)},r=function(){s.e("components/uni-nav-bar/uni-nav-bar").then(function(){return resolve(s("96bd"))}.bind(null,s)).catch(s.oe)},u={},l={components:{faIcon:c,uniNavBar:r},data:function(){return{stocks:t.getStorageSync("_warehouse"),modify_desc:"添加",disabled:!0,shop_name:"",staff_name:"",staff_address:"",staff_phone:"",staff_password:""}},onLoad:function(e){o=this,t.getStorageSync("uid")},onShow:function(){d=t.getStorageSync("staff"),i=t.getStorageSync("shop"),u=t.getStorageSync("staffRights")||{},d&&(t.setNavigationBarTitle({title:"修改员工信息"}),o.modify_desc="修改",o.shop_name=d.shop?d.shop.name:"",o.staff_name=d.nickName,o.staff_address=d.address,o.staff_phone=d.mobilePhoneNumber,o.staff_password=d.pwd||"",t.setStorageSync("staffRights",d.rights))},methods:{switchChange:function(t){o.disabled=t.detail.value},start_add:function(){null==this.staff_name?t.showToast({title:"请输入姓名",icon:"none"}):this.staff_phone.length<11?t.showToast({title:"账号不能少于11位",icon:"none"}):""==this.staff_password||null==this.staff_password||void 0==this.staff_password?t.showToast({title:"请输入密码",icon:"none"}):this.staff_password.length<6?t.showToast({title:"密码不能少于6位",icon:"none"}):o.add_data()},add_data:function(){if(t.showLoading({title:"上传中..."}),d){t.hideLoading();var e=t.getStorageSync("uid"),s=n.default.Pointer("_User"),a=s.set(e),c=n.default.Query("_User");c.set("username",o.staff_phone),c.set("nickName",o.staff_name),c.set("password",o.staff_password),c.set("pwd",o.staff_password),c.set("mobilePhoneNumber",o.staff_phone),c.set("rights",u),c.set("address",null==o.staff_address?"":o.staff_address),c.set("avatarUrl","http://bmob-cdn-23134.b0.upaiyun.com/2019/04/29/4705b31340bfff8080c068f52fd17e2c.png"),c.set("masterId",a),c.set("disabled",!o.disabled),c.set("stocks",u.select_stocks||[]),c.set("identity",2),c.set("id",d.objectId),c.save().then((function(e){o.select_stocks=[],t.removeStorageSync("staffRights"),setTimeout((function(){t.showToast({title:"修改成功"})}),1e3),t.navigateBack({delta:2})})).catch((function(t){console.log(t)}))}else{var r=n.default.Query("_User");r.equalTo("mobilePhoneNumber","==",o.staff_phone),r.find().then((function(e){if(console.log(e),0==e.length){t.hideLoading();var s=t.getStorageSync("uid"),a=n.default.Pointer("_User"),d=a.set(s),c=n.default.Query("_User");c.set("username",o.staff_phone),i&&c.set("shop",f),c.set("stocks",u.select_stocks||[]),c.set("nickName",o.staff_name),c.set("password",o.staff_password),c.set("pwd",o.staff_password),c.set("mobilePhoneNumber",o.staff_phone),c.set("rights",u),c.set("address",null==o.staff_address?"":o.staff_address),c.set("avatarUrl","http://bmob-cdn-23134.b0.upaiyun.com/2019/04/29/4705b31340bfff8080c068f52fd17e2c.png"),c.set("masterId",d),c.set("have_out",0),c.set("disabled",!o.disabled),c.save().then((function(e){console.log(e),t.showToast({title:"添加成功"}),o.select_stocks=[],t.removeStorageSync("staffRights")})).catch((function(e){209==e.code&&t.showToast({title:"已存在此账号",icon:"none"})}))}else t.hideLoading(),t.showToast({title:"已存在此账号",icon:"none"})}))}}}};e.default=l}).call(this,s("c11b")["default"])},6444:function(t,e,s){"use strict";var n={"uni-nav-bar":function(){return s.e("components/uni-nav-bar/uni-nav-bar").then(s.bind(null,"96bd"))}},a=function(){var t=this,e=t.$createElement;t._self._c},o=[];s.d(e,"b",(function(){return a})),s.d(e,"c",(function(){return o})),s.d(e,"a",(function(){return n}))},"6d26":function(t,e,s){},e134:function(t,e,s){"use strict";s.r(e);var n=s("62b6"),a=s.n(n);for(var o in n)"default"!==o&&function(t){s.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a}},[["2f8e","common/runtime","common/vendor"]]]);