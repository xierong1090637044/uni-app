(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/report/EnteringHistory/detail/detail"],{"134a":function(t,e,n){"use strict";n.r(e);var o=n("c8a7"),i=n.n(o);for(var u in o)"default"!==u&&function(t){n.d(e,t,function(){return o[t]})}(u);e["default"]=i.a},"2b0c":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement;t._self._c},i=[];n.d(e,"a",function(){return o}),n.d(e,"b",function(){return i})},"3ac5":function(t,e,n){"use strict";(function(t){n("a961"),n("921b");o(n("66fd"));var e=o(n("ff7e"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"7b55":function(t,e,n){"use strict";var o=n("c78d"),i=n.n(o);i.a},c78d:function(t,e,n){},c8a7:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=u(n("c74b")),i=u(n("b410"));function u(t){return t&&t.__esModule?t:{default:t}}var r,a,l=function(){return n.e("components/Loading/index").then(n.bind(null,"524a"))},c=function(){return n.e("components/uni-nav-bar/uni-nav-bar").then(n.bind(null,"b92d"))},d={components:{loading:l,uniNavBar:c},data:function(){return{bills:[],loading:!0,products:null,detail:null}},onLoad:function(t){console.log(t),r=this,a=t.id,r.getdetail(a)},methods:{show_options:function(){t.showActionSheet({itemList:["打印"],success:function(t){0==t.tapIndex&&i.default.print_operations(r.detail,r.products)},fail:function(t){console.log(t.errMsg)}})},getdetail:function(t){var e=o.default.Query("order_opreations");e.include("opreater","custom","producer","stock"),e.get(t).then(function(t){if(console.log(t),r.detail=t,t.detail)r.products=t.detail,r.bills=t.bills,r.loading=!1;else{var e=o.default.Query("order_opreations");e.include("goodsId"),e.field("relations",t.objectId),e.relation("Bills").then(function(t){r.products=t.results,r.loading=!1})}}).catch(function(t){console.log(t)})},revoke:function(){wx.showModal({title:"提示",content:"数据撤销后不可恢复，请谨慎撤销！",success:function(e){if(e.confirm){t.showLoading({title:"撤销中..."});var n=o.default.Query("order_opreations");n.destroy(r.detail.objectId).then(function(t){for(var e=0;e<r.products.length;e++)r.delete_bill(e)}).catch(function(t){console.log(t)})}}})},delete_bill:function(e){var n=r.products[e],i=r.bills[e],u=o.default.Query("Bills");u.destroy(i).then(function(i){var u=o.default.Query("Goods");u.set("id",n.goodsId.objectId),1==n.type?u.set("reserve",n.goodsId.reserve-n.num):-1==n.type&&u.set("reserve",n.goodsId.reserve+n.num),u.save().then(function(n){e==r.products.length-1&&(t.hideLoading(),t.navigateBack({delta:1}),setTimeout(function(){t.showToast({title:"撤销成功"})},1e3))})})}}};e.default=d}).call(this,n("543d")["default"])},ff7e:function(t,e,n){"use strict";n.r(e);var o=n("2b0c"),i=n("134a");for(var u in i)"default"!==u&&function(t){n.d(e,t,function(){return i[t]})}(u);n("7b55");var r=n("2877"),a=Object(r["a"])(i["default"],o["a"],o["b"],!1,null,null,null);e["default"]=a.exports}},[["3ac5","common/runtime","common/vendor"]]]);