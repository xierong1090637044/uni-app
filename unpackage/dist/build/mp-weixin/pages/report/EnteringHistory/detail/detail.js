(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/report/EnteringHistory/detail/detail"],{"3e55":function(t,e,n){"use strict";n.r(e);var o=n("f358"),i=n("bc68");for(var u in i)"default"!==u&&function(t){n.d(e,t,function(){return i[t]})}(u);n("3f54");var r=n("2877"),l=Object(r["a"])(i["default"],o["a"],o["b"],!1,null,null,null);e["default"]=l.exports},"3f54":function(t,e,n){"use strict";var o=n("52a6"),i=n.n(o);i.a},"52a6":function(t,e,n){},"788f":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=u(n("b739")),i=u(n("41a2"));function u(t){return t&&t.__esModule?t:{default:t}}var r,l,a=function(){return n.e("components/Loading/index").then(n.bind(null,"0190"))},c=function(){return n.e("components/uni-nav-bar/uni-nav-bar").then(n.bind(null,"f190"))},d={components:{loading:a,uniNavBar:c},data:function(){return{bills:[],loading:!0,products:null,detail:null}},onLoad:function(t){console.log(t),r=this,l=t.id,r.getdetail(l)},methods:{show_options:function(){t.showActionSheet({itemList:["打印"],success:function(t){0==t.tapIndex&&i.default.print_operations(r.detail,r.products)},fail:function(t){console.log(t.errMsg)}})},getdetail:function(t){var e=o.default.Query("order_opreations");e.include("opreater","custom","producer","stock"),e.get(t).then(function(t){if(console.log(t),r.detail=t,t.detail)r.products=t.detail,r.bills=t.bills,r.loading=!1;else{var e=o.default.Query("order_opreations");e.include("goodsId"),e.field("relations",t.objectId),e.relation("Bills").then(function(t){r.products=t.results,r.loading=!1})}}).catch(function(t){console.log(t)})},revoke:function(){wx.showModal({title:"提示",content:"数据撤销后不可恢复，请谨慎撤销！",success:function(e){if(e.confirm){t.showLoading({title:"撤销中..."});var n=o.default.Query("order_opreations");n.destroy(r.detail.objectId).then(function(t){for(var e=0;e<r.products.length;e++)r.delete_bill(e)}).catch(function(t){console.log(t)})}}})},delete_bill:function(e){var n=r.products[e],i=r.bills[e],u=o.default.Query("Bills");u.destroy(i).then(function(i){var u=o.default.Query("Goods");u.set("id",n.goodsId.objectId),1==n.type?u.set("reserve",n.goodsId.reserve-n.num):-1==n.type&&u.set("reserve",n.goodsId.reserve+n.num),u.save().then(function(n){e==r.products.length-1&&(t.hideLoading(),t.navigateBack({delta:1}),setTimeout(function(){t.showToast({title:"撤销成功"})},1e3))})})}}};e.default=d}).call(this,n("543d")["default"])},"8d98":function(t,e,n){"use strict";(function(t){n("9511"),n("921b");o(n("66fd"));var e=o(n("3e55"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},bc68:function(t,e,n){"use strict";n.r(e);var o=n("788f"),i=n.n(o);for(var u in o)"default"!==u&&function(t){n.d(e,t,function(){return o[t]})}(u);e["default"]=i.a},f358:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement;t._self._c},i=[];n.d(e,"a",function(){return o}),n.d(e,"b",function(){return i})}},[["8d98","common/runtime","common/vendor"]]]);