(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/report/EnteringHistory/detail/detail"],{"0d2d":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n("ee11"));function i(e){return e&&e.__esModule?e:{default:e}}var l,r,u=function(){return n.e("components/Loading/index").then(n.bind(null,"524a"))},d={components:{loading:u},data:function(){return{bills:[],loading:!0,products:null,detail:null}},onLoad:function(e){console.log(e),l=this,r=e.id,l.getdetail(r)},methods:{getdetail:function(e){var t=o.default.Query("order_opreations");t.include("opreater","custom","producer"),t.get(e).then(function(e){if(console.log(e),l.detail=e,e.detail)l.products=e.detail,l.bills=e.bills,l.loading=!1;else{var t=o.default.Query("order_opreations");t.include("goodsId"),t.field("relations",e.objectId),t.relation("Bills").then(function(e){l.products=e.results,l.loading=!1})}}).catch(function(e){console.log(e)})},revoke:function(){wx.showModal({title:"提示",content:"数据撤销后不可恢复，请谨慎撤销！",success:function(t){if(t.confirm){e.showLoading({title:"撤销中..."});var n=o.default.Query("order_opreations");n.destroy(l.detail.objectId).then(function(e){for(var t=0;t<l.products.length;t++)l.delete_bill(t)}).catch(function(e){console.log(e)})}}})},delete_bill:function(t){var n=l.products[t],i=l.bills[t],r=o.default.Query("Bills");r.destroy(i).then(function(i){var r=o.default.Query("Goods");r.set("id",n.goodsId.objectId),1==n.type?r.set("reserve",n.goodsId.reserve-n.num):-1==n.type&&r.set("reserve",n.goodsId.reserve+n.num),r.save().then(function(n){t==l.products.length-1&&(e.hideLoading(),e.navigateBack({delta:1}),setTimeout(function(){e.showToast({title:"撤销成功"})},1e3))})})}}};t.default=d}).call(this,n("543d")["default"])},"134a":function(e,t,n){"use strict";n.r(t);var o=n("0d2d"),i=n.n(o);for(var l in o)"default"!==l&&function(e){n.d(t,e,function(){return o[e]})}(l);t["default"]=i.a},2440:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement;e._self._c},i=[];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i})},"53e2":function(e,t,n){},"7b55":function(e,t,n){"use strict";var o=n("53e2"),i=n.n(o);i.a},ff7e:function(e,t,n){"use strict";n.r(t);var o=n("2440"),i=n("134a");for(var l in i)"default"!==l&&function(e){n.d(t,e,function(){return i[e]})}(l);n("7b55");var r=n("2877"),u=Object(r["a"])(i["default"],o["a"],o["b"],!1,null,null,null);t["default"]=u.exports}},[["3ac5","common/runtime","common/vendor"]]]);