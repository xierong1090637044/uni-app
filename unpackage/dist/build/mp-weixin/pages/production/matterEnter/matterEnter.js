(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/production/matterEnter/matterEnter"],{"0a89":function(t,e,o){"use strict";var n={"uni-nav-bar":()=>o.e("components/uni-nav-bar/uni-nav-bar").then(o.bind(null,"b92d"))},r=function(){var t=this,e=t.$createElement,o=(t._self._c,t.__map(t.products,(function(e,o){var n=Number(e.reserve),r=Number(e.reserve),u=Number(e.num);return{$orig:t.__get_orig(e),m0:n,m1:r,m2:u}})));t.$mp.data=Object.assign({},{$root:{l0:o}})},u=[];o.d(e,"b",(function(){return r})),o.d(e,"c",(function(){return u})),o.d(e,"a",(function(){return n}))},4836:function(t,e,o){"use strict";(function(t){o("a961"),o("921b");n(o("66fd"));var e=n(o("e785"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},7885:function(t,e,o){},"7d64":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(o("c74b"));r(o("df06"));function r(t){return t&&t.__esModule?t:{default:t}}var u,i,a=function(){o.e("components/uni-card/uni-card").then(function(){return resolve(o("872f"))}.bind(null,o)).catch(o.oe)},c=function(){o.e("components/uni-number-box/uni-number-box").then(function(){return resolve(o("8fad"))}.bind(null,o)).catch(o.oe)},l=function(){o.e("components/kilvn-fa-icon/fa-icon").then(function(){return resolve(o("0914"))}.bind(null,o)).catch(o.oe)},s=function(){o.e("components/uni-nav-bar/uni-nav-bar").then(function(){return resolve(o("b92d"))}.bind(null,o)).catch(o.oe)},d=function(){o.e("components/uni-icon/uni-icon").then(function(){return resolve(o("5753"))}.bind(null,o)).catch(o.oe)},f={components:{unicard:a,faIcon:l,uninumberbox:c,uniNavBar:s,uniIcon:d},data:function(){return{products:[],user:t.getStorageSync("user"),type:"",id:""}},onLoad:function(e){var o=this;if(this.products=[],i=this,t.removeStorageSync("is_option"),u=t.getStorageSync("uid"),i.type=e.type,i.id=e.id,e.id&&"production"!=e.type&&"productionEdit"!=e.type){t.showLoading({title:"加载中..."});var r=n.default.Query("Goods");"false"==e.type?r.equalTo("objectId","==",e.id):r.equalTo("productCode","==",e.id),r.equalTo("userId","==",u),r.equalTo("status","!=",-1),r.find().then((function(e){console.log(e);var n=!0,r=!1,u=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var c=i.value;if(c.num=1,c.total_money=1*c.costPrice,c.really_total_money=1*c.costPrice,c.modify_retailPrice=c.costPrice,c.models){var l=0,s=!0,d=!1,f=void 0;try{for(var m,v=c.models[Symbol.iterator]();!(s=(m=v.next()).done);s=!0){var y=m.value;y.num=0,l+=1}}catch(h){d=!0,f=h}finally{try{s||null==v.return||v.return()}finally{if(d)throw f}}c.num=l,c.selectd_model=c.models,c.selected_model=c.models}}}catch(h){r=!0,u=h}finally{try{n||null==a.return||a.return()}finally{if(r)throw u}}o.products=e,t.hideLoading()}))}else{this.products=t.getStorageSync("products");var a=!0,c=!1,l=void 0;try{for(var s,d=this.products[Symbol.iterator]();!(a=(s=d.next()).done);a=!0){var f=s.value;if(f.models){var m=0,v=!0,y=!1,h=void 0;try{for(var p,b=f.models[Symbol.iterator]();!(v=(p=b.next()).done);v=!0){var g=p.value;g.num=0,m+=1}}catch(_){y=!0,h=_}finally{try{v||null==b.return||b.return()}finally{if(y)throw h}}f.num=m,f.selectd_model=f.models,f.selected_model=f.models}}}catch(_){c=!0,l=_}finally{try{a||null==d.return||d.return()}finally{if(c)throw l}}this.products=this.products}},methods:{scanGoods:function(){t.scanCode({success:function(e){t.showLoading({title:"加载中..."});var o=e.result,r=o.split("-"),a=n.default.Query("Goods");"false"==r[1]?a.equalTo("objectId","==",r[0]):a.equalTo("productCode","==",r[0]),a.equalTo("userId","==",u),a.find().then((function(e){console.log(e);var o=!0,n=!1,r=void 0;try{for(var u,a=e[Symbol.iterator]();!(o=(u=a.next()).done);o=!0){var c=u.value;if(c.num=1,c.total_money=1*c.costPrice,c.really_total_money=1*c.costPrice,c.modify_retailPrice=c.costPrice,c.models){var l=0,s=!0,d=!1,f=void 0;try{for(var m,v=c.models[Symbol.iterator]();!(s=(m=v.next()).done);s=!0){var y=m.value;y.num=0,l+=1}}catch(h){d=!0,f=h}finally{try{s||null==v.return||v.return()}finally{if(d)throw f}}c.num=l,c.selectd_model=c.models,c.selected_model=c.models}}}catch(h){n=!0,r=h}finally{try{o||null==a.return||a.return()}finally{if(n)throw r}}i.products=i.products.concat(e),t.hideLoading()}))},fail:function(e){t.showToast({title:"未识别到条形码",icon:"none"})}})},confrim_this:function(){var e=this;if("production"==i.type)i.confrimMatter();else if("productionEdit"==i.type){var o=n.default.Query("order_opreations");o.get(i.id).then((function(o){console.log(o),o.set("mattersId",e.products),o.save(),t.showToast({title:"物料修改成功",icon:"success",duration:1e3,complete:function(){i.button_disabled=!1,t.setStorageSync("is_option",!0),t.removeStorageSync("_warehouse"),t.removeStorageSync("out_warehouse"),t.removeStorageSync("category"),t.removeStorageSync("warehouse"),setTimeout((function(){t.navigateBack({delta:2})}),500)}})}))}else t.navigateTo({url:"/pages/production/matterEnter/enterDetail/enterDetail"})},confrimMatter:function(){var e=this,o=n.default.Query("order_opreations");o.get(i.id).then((function(o){console.log(o),o.add("mattersId",e.products),o.save(),t.showToast({title:"物料添加成功",icon:"success",duration:1e3,complete:function(){i.button_disabled=!1,t.setStorageSync("is_option",!0),t.removeStorageSync("_warehouse"),t.removeStorageSync("out_warehouse"),t.removeStorageSync("category"),t.removeStorageSync("warehouse"),setTimeout((function(){t.navigateBack({delta:2})}),500)}})}))},handleNumChange:function(e,o){this.products[o].num=Number(e),this.products[o].total_money=Number(e)*Number(this.products[o].modify_retailPrice),this.products[o].really_total_money=Number(e)*Number(this.products[o].costPrice),t.setStorageSync("products",this.products)},handleModelNumChange:function(e,o,n,r){r.num=Number(e),this.products[o].selected_model[n]=r;var u=0,i=!0,a=!1,c=void 0;try{for(var l,s=this.products[o].selected_model[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var d=l.value;u+=d.num}}catch(f){a=!0,c=f}finally{try{i||null==s.return||s.return()}finally{if(a)throw c}}this.products[o].num=u,this.products[o].total_money=u*Number(this.products[o].modify_retailPrice),this.products[o].really_total_money=u*Number(this.products[o].costPrice),t.setStorageSync("products",this.products)},handleDel:function(e){console.log(e),1==this.products.length?t.showToast({title:"最少选择一个产品",icon:"none"}):(this.products.splice(e,1),t.setStorageSync("products",this.products))},getrealprice:function(e,o){this.products[o].modify_retailPrice=e.target.value,this.products[o].total_money=this.products[o].num*Number(e.target.value),t.setStorageSync("products",this.products)}}};e.default=f}).call(this,o("543d")["default"])},d574:function(t,e,o){"use strict";var n=o("7885"),r=o.n(n);r.a},d5e3:function(t,e,o){"use strict";o.r(e);var n=o("7d64"),r=o.n(n);for(var u in n)"default"!==u&&function(t){o.d(e,t,(function(){return n[t]}))}(u);e["default"]=r.a},e785:function(t,e,o){"use strict";o.r(e);var n=o("0a89"),r=o("d5e3");for(var u in r)"default"!==u&&function(t){o.d(e,t,(function(){return r[t]}))}(u);o("d574");var i,a=o("f0c5"),c=Object(a["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],i);e["default"]=c.exports}},[["4836","common/runtime","common/vendor"]]]);