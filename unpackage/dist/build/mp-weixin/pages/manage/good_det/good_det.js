(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/manage/good_det/good_det"],{1070:function(o,e,t){"use strict";var n=function(){var o=this,e=o.$createElement;o._self._c;o._isMounted||(o.e0=function(e){o.is_show=!1})},c=[];t.d(e,"a",function(){return n}),t.d(e,"b",function(){return c})},"1a90":function(o,e,t){"use strict";var n=t("61a3"),c=t.n(n);c.a},3057:function(o,e,t){"use strict";t.r(e);var n=t("7e1c"),c=t.n(n);for(var r in n)"default"!==r&&function(o){t.d(e,o,function(){return n[o]})}(r);e["default"]=c.a},"61a3":function(o,e,t){},7935:function(o,e,t){"use strict";(function(o){t("a961"),t("921b");n(t("66fd"));var e=n(t("a15f"));function n(o){return o&&o.__esModule?o:{default:o}}o(e.default)}).call(this,t("543d")["createPage"])},"7e1c":function(o,e,t){"use strict";(function(o){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(t("c74b")),c=r(t("b410"));function r(o){return o&&o.__esModule?o:{default:o}}var s,u,a=function(){return t.e("components/kilvn-fa-icon/fa-icon").then(t.bind(null,"0914"))},d=function(){return Promise.all([t.e("common/vendor"),t.e("components/tki-qrcode/tki-qrcode")]).then(t.bind(null,"8afd"))},i=function(){return Promise.all([t.e("common/vendor"),t.e("components/tki-barcode/tki-barcode")]).then(t.bind(null,"2fe1"))},l=function(){return t.e("components/uni-fab/uni-fab").then(t.bind(null,"1261"))},f={components:{faIcon:a,tkiQrcode:d,tkiBarcode:i,uniFab:l},data:function(){return{select_qrcode:"",get_reserve_checked:!0,product:{},is_show:!1,bar_code_show:!1}},onLoad:function(e){var t=this;s=this;var c=[];if(u=o.getStorageSync("uid"),console.log(e),e.id){var r=n.default.Query("Goods");"false"==e.type?r.equalTo("objectId","==",e.id):r.equalTo("productCode","==",e.id),r.equalTo("userId","==",u),r.find().then(function(o){console.log(o);var e=o[0],n=0;r.equalTo("userId","==",u),r.equalTo("status","!=",-1),r.include("stocks"),r.equalTo("goodsName","==",e.goodsName),r.find().then(function(o){var r=!0,s=!1,u=void 0;try{for(var a,d=o[Symbol.iterator]();!(r=(a=d.next()).done);r=!0){var i=a.value,l={};l.stock_name=i.stocks.stock_name,l.reserve=i.reserve,l.warning_num=i.warning_num,l.bad_num=i.bad_num,l.good_id=i.objectId,l.accessory=i.accessory?i.accessory:"",l.productCode=i.productCode?i.productCode:i.objectId,i.stocks=l,n+=i.reserve,c.push(i.stocks)}}catch(f){s=!0,u=f}finally{try{r||null==d.return||d.return()}finally{if(s)throw u}}t.product=e,t.product.all_reserve=n,t.product.stocks=c,console.log(t.product)})})}else{var a=o.getStorageSync("now_product"),d=0,i=n.default.Query("Goods");i.equalTo("userId","==",u),i.equalTo("status","!=",-1),i.include("stocks"),i.equalTo("goodsName","==",a.goodsName),i.find().then(function(e){var n=!0,r=!1,s=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done);n=!0){var i=u.value,l={};l.stock_name=i.stocks.stock_name,l.reserve=i.reserve,l.warning_num=i.warning_num,l.bad_num=i.bad_num,l.good_id=i.objectId,l.accessory=i.accessory?i.accessory:"",l.productCode=i.productCode?i.productCode:i.objectId,i.stocks=l,d+=i.reserve,c.push(i.stocks)}}catch(f){r=!0,s=f}finally{try{n||null==a.return||a.return()}finally{if(r)throw s}}t.product=o.getStorageSync("now_product"),t.product.all_reserve=d,t.product.stocks=c,console.log(t.product)})}},methods:{show_qrcode:function(o){s.is_show=!0,s.select_qrcode=o.productCode},change_state:function(o){s.get_reserve_checked=o.detail.value},print_info:function(o){c.default.print_goodDet(o)},modify:function(e){var t=o.getStorageSync("now_product");t.objectId=e.good_id,t.stocks=e,o.setStorageSync("now_product",t),o.navigateTo({url:"../good_add/good_add"})},trigger:function(e){this.content[e.index].active=!e.item.active,0==e.index?(o.setStorageSync("now_product",this.product),o.navigateTo({url:"../good_add/good_add"})):s.delete()},showcode_option:function(){o.showActionSheet({itemList:["二维码","条形码"],success:function(o){console.log("选中了第"+(o.tapIndex+1)+"个按钮"),0==o.tapIndex?s.is_show=!0:s.bar_code_show=!0},fail:function(o){console.log(o.errMsg)}})},qrR:function(o){this.src=o},bcR:function(o){this.src=o},saveBccode:function(){this.$refs.barcode._saveCode()},saveQrcode:function(){this.$refs.qrcode._saveCode()},delete_good:function(e,t,c){o.showModal({title:"提示",content:"是否删除该商品",success:function(r){if(r.confirm){var u=n.default.Query("Goods");u.set("id",e),u.set("status",-1),u.save().then(function(e){if(t)o.navigateTo({url:"../goods/goods"}),setTimeout(function(){o.showToast({title:"删除成功"})},1e3);else if(s.product.stocks.length>1){var r=s.product.stocks[c+1].good_id,u=n.default.Query("Goods");u.get(r).then(function(e){console.log(e),e.set("accessory",!1),e.save(),o.navigateTo({url:"../goods/goods"}),setTimeout(function(){o.showToast({title:"删除成功"})},1e3)}).catch(function(o){console.log(o)})}else o.navigateTo({url:"../goods/goods"}),setTimeout(function(){o.showToast({title:"删除成功"})},1e3)}).catch(function(o){console.log(o)})}}})}}};e.default=f}).call(this,t("543d")["default"])},a15f:function(o,e,t){"use strict";t.r(e);var n=t("1070"),c=t("3057");for(var r in c)"default"!==r&&function(o){t.d(e,o,function(){return c[o]})}(r);t("1a90");var s=t("2877"),u=Object(s["a"])(c["default"],n["a"],n["b"],!1,null,null,null);e["default"]=u.exports}},[["7935","common/runtime","common/vendor"]]]);