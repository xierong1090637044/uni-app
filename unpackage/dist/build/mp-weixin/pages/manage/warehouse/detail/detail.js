(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/manage/warehouse/detail/detail"],{"1ec6":function(e,t,o){"use strict";o.r(t);var n=o("f37f"),c=o.n(n);for(var r in n)"default"!==r&&function(e){o.d(t,e,function(){return n[e]})}(r);t["default"]=c.a},6612:function(e,t,o){"use strict";o.r(t);var n=o("9935"),c=o("1ec6");for(var r in c)"default"!==r&&function(e){o.d(t,e,function(){return c[e]})}(r);o("c35b");var u,a=o("f0c5"),i=Object(a["a"])(c["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],u);t["default"]=i.exports},"6e55":function(e,t,o){"use strict";(function(e){o("9787"),o("921b");n(o("66fd"));var t=n(o("6612"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},9935:function(e,t,o){"use strict";var n,c=function(){var e=this,t=e.$createElement;e._self._c},r=[];o.d(t,"b",function(){return c}),o.d(t,"c",function(){return r}),o.d(t,"a",function(){return n})},bfac:function(e,t,o){},c35b:function(e,t,o){"use strict";var n=o("bfac"),c=o.n(n);c.a},f37f:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=c(o("93d5"));function c(e){return e&&e.__esModule?e:{default:e}}var r,u,a=function(){return o.e("components/kilvn-fa-icon/fa-icon").then(o.bind(null,"d7ee"))},i=function(){return o.e("components/Loading/index").then(o.bind(null,"359f"))},l=function(){return Promise.all([o.e("common/vendor"),o.e("components/tki-qrcode/tki-qrcode")]).then(o.bind(null,"8ae0"))},s={components:{faIcon:a,tkiQrcode:l,loading:i},data:function(){return{loading:!0,stock:"",NGoods:null,reserve_num:0,reserve_money:0,codeVal:""}},onLoad:function(t){if(r=this,u=e.getStorageSync("uid"),t.id){var o=n.default.Query("stocks");o.get(t.id).then(function(e){r.stock=e,r.codeVal=e.objectId+"-stock",r.get_detail()}).catch(function(e){console.log(e)})}else r.stock=e.getStorageSync("stock"),r.codeVal=r.stock.objectId+"-stock",r.get_detail()},methods:{show_options:function(){e.showActionSheet({itemList:["编辑","删除"],success:function(e){0==e.tapIndex?r.edit(r.stock):1==e.tapIndex&&r.delete_this(r.stock.objectId)},fail:function(e){console.log(e.errMsg)}})},edit:function(t){e.setStorageSync("warehouse",t),e.setStorageSync("charge",t.charge),e.setStorageSync("shop",t.shop),e.navigateTo({url:"../add/add"})},delete_this:function(t){e.showModal({title:"提示",content:"请谨慎删除，一旦删除，数据不能恢复，是否删除此仓库",success:function(e){e.confirm&&(console.log(t),r.delete_data(t))}})},delete_data:function(t){var o=this;console.log(t);var c=n.default.Query("stocks");c.destroy(t).then(function(n){o.muchDelete(t).then(function(t){t&&(e.showToast({title:"删除成功",icon:"none"}),e.navigateBack({delta:1}))})}).catch(function(e){console.log(e)})},muchDelete:function(e){var t=this;return new Promise(function(o,c){var r=n.default.Query("NGoods");r.equalTo("userId","==",u),r.equalTo("stocks","==",e),r.limit(50),r.find().then(function(c){c.destroyAll().then(function(c){var r=n.default.Query("NGoods");r.equalTo("userId","==",u),r.equalTo("stocks","==",e),r.count().then(function(n){console.log(n),0==n?o(!0):t.muchDelete(e)}),console.log(c)}).catch(function(e){console.log(e)})})})},goto_detail:function(t){var o=n.default.Query("NGoods");o.get(t.objectId).then(function(t){console.log(t),o.get(t.header.objectId).then(function(t){e.setStorageSync("now_product",t),e.navigateTo({url:"/pages/manage/good_det/good_det"})})}).catch(function(e){console.log(e)})},get_detail:function(){var t=n.default.Query("NGoods");t.equalTo("userId","==",u),t.equalTo("order","==",1),t.equalTo("stocks","==",e.getStorageSync("stock").objectId),t.order("-reserve"),t.include("header"),t.find().then(function(e){console.log(e),r.NGoods=e;var t=0,o=0,n=!0,c=!1,u=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var l=a.value;o+=Number(l.header.costPrice)*Number(l.reserve),t+=Number(l.reserve)}}catch(s){c=!0,u=s}finally{try{n||null==i.return||i.return()}finally{if(c)throw u}}r.reserve_money=o,r.reserve_num=t,r.loading=!1})},qrR:function(e){this.src=e},saveQrcode:function(){this.$refs.qrcode._saveCode()}}};t.default=s}).call(this,o("543d")["default"])}},[["6e55","common/runtime","common/vendor"]]]);