(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/manage/custom/add/add"],{1775:function(e,t,n){"use strict";n.r(t);var s=n("4bba"),o=n.n(s);for(var a in s)"default"!==a&&function(e){n.d(t,e,(function(){return s[e]}))}(a);t["default"]=o.a},"30efc":function(e,t,n){"use strict";(function(e){n("d510"),n("921b");s(n("66fd"));var t=s(n("e731"));function s(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"3edd":function(e,t,n){"use strict";var s={"uni-nav-bar":function(){return n.e("components/uni-nav-bar/uni-nav-bar").then(n.bind(null,"96bd"))}},o=function(){var e=this,t=e.$createElement;e._self._c},a=[];n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s}))},"4bba":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(n("9546")),o=a(n("9ef1"));function a(e){return e&&e.__esModule?e:{default:e}}var u,c,r,d=function(){n.e("components/uni-nav-bar/uni-nav-bar").then(function(){return resolve(n("96bd"))}.bind(null,n)).catch(n.oe)},i={components:{uniNavBar:d},data:function(){return{username:"",password:"",Images:[],name:"",address:"",phone:"",debt:0,discount:100,textDesc:"添加",customClass:{}}},onLoad:function(t){t.type,u=this,r=e.getStorageSync("uid"),e.removeStorageSync("customCategory")},onShow:function(){c=e.getStorageSync("customs"),c?(e.getStorageSync("custom_type"),e.setNavigationBarTitle({title:"修改客户"}),u.textDesc="修改",u.Images=c.Images||[],u.name=c.custom_name||"",u.address=c.custom_address||"",u.phone=c.custom_phone||"",u.debt=c.debt||0,u.discount=c.discount||100,u.username=c.username||"",u.password=c.password||""):e.setNavigationBarTitle({title:"新增客户"}),e.getStorageSync("customCategory")&&(u.customClass=e.getStorageSync("customCategory"))},onUnload:function(){e.removeStorageSync("custom_type"),e.removeStorageSync("customs"),e.removeStorageSync("customCategory")},methods:{handleData:function(){u.Images=[],u.name="",u.address="",u.phone="",u.debt=0,u.discount=100},removeImg:function(e){u.Images.splice(e,1),u.Images=u.Images},upload_image:function(){o.default.upload_image(1).then((function(e){u.Images=e}))},getDiscount:function(e){var t=Number(e.detail.value);t>=100&&(u.discount=100)},add_data:function(){if(null==u.name||""==u.name)e.showToast({title:"请输入姓名",icon:"none"});else{var t=s.default.Query("customs"),n=s.default.Pointer("_User"),o=n.set(r);if(c&&t.set("id",c.objectId),t.set("custom_name",u.name),t.set("custom_phone",u.phone?u.phone:""),t.set("custom_address",u.address?u.address:""),t.set("orginDebt",Number(u.debt)),t.set("discount",Number(u.discount)),t.set("parent",o),t.set("Images",u.Images),t.set("password",u.password),1==u.customClass.type){var a=s.default.Pointer("customFristClass"),d=a.set(u.customClass.objectId);t.set("customFristClass",d),c&&t.get(c.objectId).then((function(e){e.unset("customSecondClass"),e.save()}))}else if(2==u.customClass.type){var i=s.default.Pointer("customFristClass"),l=i.set(u.customClass.parent.objectId),m=s.default.Pointer("customSecondClass"),f=m.set(u.customClass.objectId);t.set("customFristClass",l),t.set("customSecondClass",f)}t.save().then((function(t){console.log(t),c?e.showToast({title:"修改成功"}):(e.showToast({title:"添加成功"}),u.handleData())})).catch((function(e){console.log(e)}))}}}};t.default=i}).call(this,n("543d")["default"])},"5b41":function(e,t,n){},e731:function(e,t,n){"use strict";n.r(t);var s=n("3edd"),o=n("1775");for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("edd4");var u,c=n("f0c5"),r=Object(c["a"])(o["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],u);t["default"]=r.exports},edd4:function(e,t,n){"use strict";var s=n("5b41"),o=n.n(s);o.a}},[["30efc","common/runtime","common/vendor"]]]);