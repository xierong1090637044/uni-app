(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/manage/custom/add/add"],{"0bcc":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(n("c74b")),o=a(n("e601"));function a(t){return t&&t.__esModule?t:{default:t}}var c,u,r,i=function(){n.e("components/uni-nav-bar/uni-nav-bar").then(function(){return resolve(n("b92d"))}.bind(null,n)).catch(n.oe)},d={components:{uniNavBar:i},data:function(){return{Images:[],name:"",address:"",phone:"",debt:0,discount:100,textDesc:"添加",customClass:{}}},onLoad:function(e){e.type,c=this,r=t.getStorageSync("uid"),t.removeStorageSync("customCategory")},onShow:function(){u=t.getStorageSync("customs"),u?(t.getStorageSync("custom_type"),t.setNavigationBarTitle({title:"修改客户"}),c.textDesc="修改",c.Images=u.Images||[],c.name=u.custom_name||"",c.address=u.custom_address||"",c.phone=u.custom_phone||"",c.debt=u.debt||0,c.discount=u.discount||100):t.setNavigationBarTitle({title:"新增客户"}),t.getStorageSync("customCategory")&&(c.customClass=t.getStorageSync("customCategory"))},onUnload:function(){t.removeStorageSync("custom_type"),t.removeStorageSync("customs"),t.removeStorageSync("customCategory")},methods:{handleData:function(){c.Images=[],c.name="",c.address="",c.phone="",c.debt=0,c.discount=100},removeImg:function(t){c.Images.splice(t,1),c.Images=c.Images},upload_image:function(){o.default.upload_image(1).then((function(t){c.Images=t}))},getDiscount:function(t){var e=Number(t.detail.value);e>=100&&(c.discount=100)},add_data:function(){if(null==c.name||""==c.name)t.showToast({title:"请输入姓名",icon:"none"});else{var e=s.default.Query("customs"),n=s.default.Pointer("_User"),o=n.set(r);if(u&&e.set("id",u.objectId),e.set("custom_name",c.name),e.set("custom_phone",c.phone?c.phone:""),e.set("custom_address",c.address?c.address:""),e.set("debt",Number(c.debt)),e.set("discount",Number(c.discount)),e.set("parent",o),e.set("Images",c.Images),1==c.customClass.type){var a=s.default.Pointer("customFristClass"),i=a.set(c.customClass.objectId);e.set("customFristClass",i),u&&e.get(u.objectId).then((function(t){t.unset("customSecondClass"),t.save()}))}else if(2==c.customClass.type){var d=s.default.Pointer("customFristClass"),l=d.set(c.customClass.parent.objectId),m=s.default.Pointer("customSecondClass"),f=m.set(c.customClass.objectId);e.set("customFristClass",l),e.set("customSecondClass",f)}e.save().then((function(e){console.log(e),u?t.showToast({title:"修改成功"}):(t.showToast({title:"添加成功"}),c.handleData())})).catch((function(t){console.log(t)}))}}}};e.default=d}).call(this,n("543d")["default"])},"126e":function(t,e,n){"use strict";n.r(e);var s=n("0bcc"),o=n.n(s);for(var a in s)"default"!==a&&function(t){n.d(e,t,(function(){return s[t]}))}(a);e["default"]=o.a},"1c4e":function(t,e,n){"use strict";(function(t){n("a961"),n("921b");s(n("66fd"));var e=s(n("6f4c"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"6f4c":function(t,e,n){"use strict";n.r(e);var s=n("a3fc"),o=n("126e");for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("73e5");var c,u=n("f0c5"),r=Object(u["a"])(o["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],c);e["default"]=r.exports},"73e5":function(t,e,n){"use strict";var s=n("7ad1"),o=n.n(s);o.a},"7ad1":function(t,e,n){},a3fc:function(t,e,n){"use strict";var s={"uni-nav-bar":()=>n.e("components/uni-nav-bar/uni-nav-bar").then(n.bind(null,"b92d"))},o=function(){var t=this,e=t.$createElement;t._self._c},a=[];n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return s}))}},[["1c4e","common/runtime","common/vendor"]]]);