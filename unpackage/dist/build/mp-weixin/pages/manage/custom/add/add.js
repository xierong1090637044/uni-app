(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/manage/custom/add/add"],{"281e":function(t,e,n){"use strict";var s={"uni-nav-bar":function(){return n.e("components/uni-nav-bar/uni-nav-bar").then(n.bind(null,"8157"))}},o=function(){var t=this,e=t.$createElement;t._self._c},a=[];n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return s}))},"4fe4":function(t,e,n){"use strict";n.r(e);var s=n("c6cd"),o=n.n(s);for(var a in s)"default"!==a&&function(t){n.d(e,t,(function(){return s[t]}))}(a);e["default"]=o.a},"81bb":function(t,e,n){"use strict";var s=n("91fc9"),o=n.n(s);o.a},"91fc9":function(t,e,n){},b74d:function(t,e,n){"use strict";(function(t){n("d34b"),n("921b");s(n("66fd"));var e=s(n("c2e4"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},c2e4:function(t,e,n){"use strict";n.r(e);var s=n("281e"),o=n("4fe4");for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("81bb");var u,c=n("f0c5"),r=Object(c["a"])(o["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],u);e["default"]=r.exports},c6cd:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(n("4515")),o=a(n("978e"));function a(t){return t&&t.__esModule?t:{default:t}}var u,c,r,i=function(){n.e("components/uni-nav-bar/uni-nav-bar").then(function(){return resolve(n("8157"))}.bind(null,n)).catch(n.oe)},d={components:{uniNavBar:i},data:function(){return{Images:[],name:"",address:"",phone:"",debt:0,discount:100,textDesc:"添加",customClass:{}}},onLoad:function(e){e.type,u=this,r=t.getStorageSync("uid"),t.removeStorageSync("customCategory")},onShow:function(){c=t.getStorageSync("customs"),c?(t.getStorageSync("custom_type"),t.setNavigationBarTitle({title:"修改客户"}),u.textDesc="修改",u.Images=c.Images||[],u.name=c.custom_name||"",u.address=c.custom_address||"",u.phone=c.custom_phone||"",u.debt=c.debt||0,u.discount=c.discount||100):t.setNavigationBarTitle({title:"新增客户"}),t.getStorageSync("customCategory")&&(u.customClass=t.getStorageSync("customCategory"))},onUnload:function(){t.removeStorageSync("custom_type"),t.removeStorageSync("customs"),t.removeStorageSync("customCategory")},methods:{handleData:function(){u.Images=[],u.name="",u.address="",u.phone="",u.debt=0,u.discount=100},removeImg:function(t){u.Images.splice(t,1),u.Images=u.Images},upload_image:function(){o.default.upload_image(1).then((function(t){u.Images=t}))},getDiscount:function(t){var e=Number(t.detail.value);e>=100&&(u.discount=100)},add_data:function(){if(null==u.name||""==u.name)t.showToast({title:"请输入姓名",icon:"none"});else{var e=s.default.Query("customs"),n=s.default.Pointer("_User"),o=n.set(r);if(c&&e.set("id",c.objectId),e.set("custom_name",u.name),e.set("custom_phone",u.phone?u.phone:""),e.set("custom_address",u.address?u.address:""),e.set("debt",Number(u.debt)),e.set("discount",Number(u.discount)),e.set("parent",o),e.set("Images",u.Images),1==u.customClass.type){var a=s.default.Pointer("customFristClass"),i=a.set(u.customClass.objectId);e.set("customFristClass",i),c&&e.get(c.objectId).then((function(t){t.unset("customSecondClass"),t.save()}))}else if(2==u.customClass.type){var d=s.default.Pointer("customFristClass"),l=d.set(u.customClass.parent.objectId),m=s.default.Pointer("customSecondClass"),f=m.set(u.customClass.objectId);e.set("customFristClass",l),e.set("customSecondClass",f)}e.save().then((function(e){console.log(e),c?t.showToast({title:"修改成功"}):(t.showToast({title:"添加成功"}),u.handleData())})).catch((function(t){console.log(t)}))}}}};e.default=d}).call(this,n("543d")["default"])}},[["b74d","common/runtime","common/vendor"]]]);