(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/common/goods-select/goods-select"],{"10b1":function(t,o,e){"use strict";e.r(o);var n=e("c30c"),r=e("bfcd");for(var c in r)"default"!==c&&function(t){e.d(o,t,function(){return r[t]})}(c);e("d431");var i=e("2877"),a=Object(i["a"])(r["default"],n["a"],n["b"],!1,null,null,null);o["default"]=a.exports},"29f2":function(t,o,e){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n=r(e("c74b"));function r(t){return t&&t.__esModule?t:{default:t}}var c,i,a=function(){return e.e("components/kilvn-fa-icon/fa-icon").then(e.bind(null,"0914"))},u=function(){return e.e("components/Loading/index").then(e.bind(null,"524a"))},s=function(){return e.e("components/uni-nav-bar/uni-nav-bar").then(e.bind(null,"b92d"))},l=function(){return e.e("components/uni-icon/uni-icon").then(e.bind(null,"5753"))},d=function(){return e.e("components/uni-pagination/uni-pagination").then(e.bind(null,"2bfc"))},g=[],f=[],h=[],p="",y=30,_=1,v={components:{loading:u,uniNavBar:s,faIcon:a,uniIcon:l,uniPagination:d},data:function(){return{page_num:1,search_text:"",url:null,showOptions:!1,loading:!0,productList:null,checked_option:"createdAt",category:"",stock:"",type:""}},onLoad:function(o){i=this,this.handle_data(),"entering"==o.type?this.url="../good_confrim/good_confrim":"delivery"==o.type?this.url="../goods_out/goods_out":"returing"==o.type?this.url="../good_return/good_return":"counting"==o.type?this.url="../good_count/good_count":"allocation"==o.type&&(this.url="../good_allocation/good_allocation"),this.type=o.type,c=t.getStorageSync("uid"),i.get_productList()},onShow:function(){t.removeStorageSync("products"),t.getStorageSync("category")&&(i.showOptions=!0,i.category=t.getStorageSync("category")),t.getStorageSync("warehouse")&&(i.showOptions=!0,i.stock=t.getStorageSync("warehouse")[t.getStorageSync("warehouse").length-1].stock),t.getStorageSync("is_option")&&(this.productList=[],i.get_productList())},onHide:function(){p="",y=30,g=[],h=[],f=[],t.removeStorageSync("is_option")},methods:{change_page:function(t){_=t.current,i.get_productList()},shaixuan:function(){i.showOptions=!0},confirm:function(t){p=t.detail.value,i.search_text=t.detail.value,i.page_num=1,_=1,i.get_productList()},confrim_this:function(){this.go_goodsconfrim()},option_reset:function(){this.productList=[],t.removeStorageSync("category"),t.removeStorageSync("warehouse"),i.category="",i.stock="",i.showOptions=!1,i.get_productList()},option_confrim:function(){this.productList=[],t.getStorageSync("category")&&(i.category=t.getStorageSync("category")),t.getStorageSync("warehouse")&&(i.stock=t.getStorageSync("warehouse")[t.getStorageSync("warehouse").length-1].stock),i.showOptions=!1,i.get_productList()},selectd:function(t){y=30,i.checked_option=t,i.get_productList()},radioChange:function(t){p?f[_-1]=t.detail.value:g[_-1]=t.detail.value,h=f.concat(g),h=h.reduce(function(t,o){return t.concat(o)}),console.log(h)},go_goodsconfrim:function(){console.log(h),0==h.length?t.showToast({title:"请选择产品",icon:"none"}):"allocation"==this.type?this.stock?this.confrim_next():t.showToast({title:"请在筛选中选择调拨的仓库",icon:"none"}):this.confrim_next()},confrim_next:function(){var o=0,e=!0,n=!1,r=void 0;try{for(var c,i=h[Symbol.iterator]();!(e=(c=i.next()).done);e=!0){var a=c.value;h[o]=JSON.parse(a),h[o].num=1,h[o].total_money=1*h[o].retailPrice,h[o].modify_retailPrice=h[o].retailPrice,o+=1}}catch(u){n=!0,r=u}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}t.setStorageSync("products",h),t.navigateTo({url:this.url})},get_productList:function(){var t=this;i.productList=[];var o=n.default.Query("Goods");o.select("goodsName","reserve","goodsIcon","packageContent","packingUnit","retailPrice","costPrice","stocks"),o.include("stocks"),o.equalTo("userId","==",c),o.equalTo("stocks","==",i.stock.objectId),o.equalTo("status","!=",-1),o.equalTo("second_class","==",i.category.objectId);var e=o.equalTo("goodsName","==",{$regex:p+".*"}),r=o.equalTo("packageContent","==",{$regex:p+".*"});o.or(e,r),o.limit(y),o.skip(y*(_-1)),o.order("-"+i.checked_option),o.find().then(function(o){if(console.log(h),h.length>=1){var e=!0,n=!1,r=void 0;try{for(var c,i=h[Symbol.iterator]();!(e=(c=i.next()).done);e=!0){var a=c.value,u=!0,s=!1,l=void 0;try{for(var d,g=o[Symbol.iterator]();!(u=(d=g.next()).done);u=!0){var f=d.value;f.objectId==JSON.parse(a).objectId&&(f.checked=!0)}}catch(p){s=!0,l=p}finally{try{u||null==g.return||g.return()}finally{if(s)throw l}}}}catch(p){n=!0,r=p}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}}t.productList=o,t.loading=!1})},handle_data:function(){t.removeStorageSync("category"),t.removeStorageSync("warehouse"),t.removeStorageSync("out_warehouse"),t.removeStorageSync("shop"),p="",y=30}}};o.default=v}).call(this,e("543d")["default"])},"82b8":function(t,o,e){},b5e1:function(t,o,e){"use strict";(function(t){e("a961"),e("921b");n(e("66fd"));var o=n(e("10b1"));function n(t){return t&&t.__esModule?t:{default:t}}t(o.default)}).call(this,e("543d")["createPage"])},bfcd:function(t,o,e){"use strict";e.r(o);var n=e("29f2"),r=e.n(n);for(var c in n)"default"!==c&&function(t){e.d(o,t,function(){return n[t]})}(c);o["default"]=r.a},c30c:function(t,o,e){"use strict";var n=function(){var t=this,o=t.$createElement,e=(t._self._c,t.__map(t.productList,function(o,e){var n=JSON.stringify(o);return{$orig:t.__get_orig(o),g0:n}}));t.$mp.data=Object.assign({},{$root:{l0:e}})},r=[];e.d(o,"a",function(){return n}),e.d(o,"b",function(){return r})},d431:function(t,o,e){"use strict";var n=e("82b8"),r=e.n(n);r.a}},[["b5e1","common/runtime","common/vendor"]]]);