(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-production-matterEnter-matterEnter"],{"020f":function(e,t,n){"use strict";var r=n("45a5"),i=n.n(r);i.a},"3a94":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"uni-numbox"},[n("v-uni-view",{staticClass:"uni-numbox__minus",class:{"uni-numbox--disabled":e.inputValue<=e.min||e.disabled},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._calcValue("minus")}}},[e._v("-")]),n("v-uni-input",{staticClass:"uni-numbox__value",attrs:{disabled:e.disabled,type:"digit"},on:{blur:function(t){arguments[0]=t=e.$handleEvent(t),e._onBlur.apply(void 0,arguments)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}),n("v-uni-view",{staticClass:"uni-numbox__plus",class:{"uni-numbox--disabled":e.inputValue>=e.max||e.disabled},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._calcValue("plus")}}},[e._v("+")])],1)},i=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i})},"3d5d":function(e,t,n){"use strict";(function(e){var r=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("c5f6"),n("28a5");var i=r(n("5d73"));n("7514");var o,a,u=r(n("9546")),l=(r(n("7fd5")),r(n("8975"))),s=r(n("55f9")),d=r(n("4d52")),c=r(n("96bd")),f=r(n("3628")),v={components:{unicard:l.default,faIcon:d.default,uninumberbox:s.default,uniNavBar:c.default,uniIcon:f.default},data:function(){return{products:[],user:uni.getStorageSync("user"),type:"",id:""}},onLoad:function(t){var n=this;if(this.products=[],a=this,uni.removeStorageSync("is_option"),o=uni.getStorageSync("uid"),a.type=t.type,a.id=t.id,t.id&&"production"!=t.type&&"productionEdit"!=t.type){uni.showLoading({title:"加载中..."});var r=u.default.Query("Goods");"false"==t.type?r.equalTo("objectId","==",t.id):r.equalTo("productCode","==",t.id),r.equalTo("userId","==",o),r.equalTo("status","!=",-1),r.find().then(function(t){e.log(t);var r=!0,o=!1,a=void 0;try{for(var u,l=(0,i.default)(t);!(r=(u=l.next()).done);r=!0){var s=u.value;if(s.num=1,s.total_money=1*s.costPrice,s.really_total_money=1*s.costPrice,s.modify_retailPrice=s.costPrice,s.models){var d=0,c=!0,f=!1,v=void 0;try{for(var m,h=(0,i.default)(s.models);!(c=(m=h.next()).done);c=!0){var b=m.value;b.num=0,d+=1}}catch(g){f=!0,v=g}finally{try{c||null==h.return||h.return()}finally{if(f)throw v}}s.num=d,s.selectd_model=s.models,s.selected_model=s.models}}}catch(g){o=!0,a=g}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}n.products=t,uni.hideLoading()})}else{this.products=uni.getStorageSync("products");var l=!0,s=!1,d=void 0;try{for(var c,f=(0,i.default)(this.products);!(l=(c=f.next()).done);l=!0){var v=c.value;if(v.models){var m=0,h=!0,b=!1,g=void 0;try{for(var p,y=(0,i.default)(v.models);!(h=(p=y.next()).done);h=!0){var _=p.value;_.num=0,m+=1}}catch(w){b=!0,g=w}finally{try{h||null==y.return||y.return()}finally{if(b)throw g}}v.num=m,v.selectd_model=v.models,v.selected_model=v.models}}}catch(w){s=!0,d=w}finally{try{l||null==f.return||f.return()}finally{if(s)throw d}}this.products=this.products}},methods:{scanGoods:function(){uni.scanCode({success:function(t){uni.showLoading({title:"加载中..."});var n=t.result,r=n.split("-"),l=u.default.Query("Goods");"false"==r[1]?l.equalTo("objectId","==",r[0]):l.equalTo("productCode","==",r[0]),l.equalTo("userId","==",o),l.find().then(function(t){e.log(t);var n=!0,r=!1,o=void 0;try{for(var u,l=(0,i.default)(t);!(n=(u=l.next()).done);n=!0){var s=u.value;if(s.num=1,s.total_money=1*s.costPrice,s.really_total_money=1*s.costPrice,s.modify_retailPrice=s.costPrice,s.models){var d=0,c=!0,f=!1,v=void 0;try{for(var m,h=(0,i.default)(s.models);!(c=(m=h.next()).done);c=!0){var b=m.value;b.num=0,d+=1}}catch(g){f=!0,v=g}finally{try{c||null==h.return||h.return()}finally{if(f)throw v}}s.num=d,s.selectd_model=s.models,s.selected_model=s.models}}}catch(g){r=!0,o=g}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}a.products=a.products.concat(t),uni.hideLoading()})},fail:function(e){uni.showToast({title:"未识别到条形码",icon:"none"})}})},confrim_this:function(){var t=this;if("production"==a.type)a.confrimMatter();else if("productionEdit"==a.type){var n=u.default.Query("order_opreations");n.get(a.id).then(function(n){e.log(n),n.set("mattersId",t.products),n.save(),uni.showToast({title:"物料修改成功",icon:"success",duration:1e3,complete:function(){a.button_disabled=!1,uni.setStorageSync("is_option",!0),uni.removeStorageSync("_warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("category"),uni.removeStorageSync("warehouse"),setTimeout(function(){uni.navigateBack({delta:2})},500)}})})}else uni.navigateTo({url:"/pages/production/matterEnter/enterDetail/enterDetail"})},confrimMatter:function(){var t=this,n=u.default.Query("order_opreations");n.get(a.id).then(function(n){e.log(n),n.add("mattersId",t.products),n.save(),uni.showToast({title:"物料添加成功",icon:"success",duration:1e3,complete:function(){a.button_disabled=!1,uni.setStorageSync("is_option",!0),uni.removeStorageSync("_warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("category"),uni.removeStorageSync("warehouse"),setTimeout(function(){uni.navigateBack({delta:2})},500)}})})},handleNumChange:function(e,t){this.products[t].num=Number(e),this.products[t].total_money=Number(e)*Number(this.products[t].modify_retailPrice),this.products[t].really_total_money=Number(e)*Number(this.products[t].costPrice),uni.setStorageSync("products",this.products)},handleModelNumChange:function(e,t,n,r){r.num=Number(e),this.products[t].selected_model[n]=r;var o=0,a=!0,u=!1,l=void 0;try{for(var s,d=(0,i.default)(this.products[t].selected_model);!(a=(s=d.next()).done);a=!0){var c=s.value;o+=c.num}}catch(f){u=!0,l=f}finally{try{a||null==d.return||d.return()}finally{if(u)throw l}}this.products[t].num=o,this.products[t].total_money=o*Number(this.products[t].modify_retailPrice),this.products[t].really_total_money=o*Number(this.products[t].costPrice),uni.setStorageSync("products",this.products)},handleDel:function(t){e.log(t),1==this.products.length?uni.showToast({title:"最少选择一个产品",icon:"none"}):(this.products.splice(t,1),uni.setStorageSync("products",this.products))},getrealprice:function(e,t){this.products[t].modify_retailPrice=e.target.value,this.products[t].total_money=this.products[t].num*Number(e.target.value),uni.setStorageSync("products",this.products)}}};t.default=v}).call(this,n("5a52")["default"])},"41cc":function(e,t,n){"use strict";n.r(t);var r=n("3d5d"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,function(){return r[e]})}(o);t["default"]=i.a},"45a5":function(e,t,n){var r=n("5afd");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("936dcf82",r,!0,{sourceMap:!1,shadowMode:!1})},"4aab":function(e,t,n){"use strict";n.r(t);var r=n("baa2"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,function(){return r[e]})}(o);t["default"]=i.a},"4d00":function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,'.uni-card[data-v-ea954bea]{margin-left:%?24?%;margin-right:%?24?%;background:#fff;box-shadow:none;position:relative;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.uni-card[data-v-ea954bea]:after{content:"";position:absolute;-webkit-transform-origin:center;transform-origin:center;box-sizing:border-box;pointer-events:none;top:-50%;left:-50%;right:-50%;bottom:-50%;border:1px solid #c8c7cc;border-radius:%?12?%;-webkit-transform:scale(.5);transform:scale(.5)}.uni-card__footer[data-v-ea954bea],.uni-card__header[data-v-ea954bea]{position:relative;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;padding:%?16?%;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.uni-card__header[data-v-ea954bea]:after{position:absolute;bottom:0;right:0;left:0;height:1px;content:"";-webkit-transform:scaleY(.5);transform:scaleY(.5);background-color:#c8c7cc}.uni-card__header-title[data-v-ea954bea]{-webkit-box-flex:1;-webkit-flex:1;flex:1;margin-right:%?16?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.uni-card__header-title-text[data-v-ea954bea]{font-size:%?32?%}.uni-card__header-extra-img-view[data-v-ea954bea]{display:-webkit-box;display:-webkit-flex;display:flex}.uni-card__header-extra-img[data-v-ea954bea]{height:%?40?%;width:%?40?%;margin-right:%?16?%}.uni-card__header-extra-text[data-v-ea954bea]{-webkit-box-flex:0;-webkit-flex:0 0 auto;flex:0 0 auto;width:30%;margin-left:%?16?%;font-size:%?28?%;text-align:right;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.uni-card__content--pd[data-v-ea954bea]{padding:%?16?%}.uni-card__footer[data-v-ea954bea]{-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;color:#999;font-size:%?24?%;padding-top:0}.uni-card--full[data-v-ea954bea]{margin:0}',""])},"55f9":function(e,t,n){"use strict";n.r(t);var r=n("3a94"),i=n("7800");for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);n("020f");var a=n("f0c5"),u=Object(a["a"])(i["default"],r["a"],r["b"],!1,null,"7e0e10b6",null);t["default"]=u.exports},"5afd":function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,'.uni-numbox[data-v-7e0e10b6]{display:-webkit-inline-box;display:-webkit-inline-flex;display:inline-flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;height:%?50?%;position:relative}.uni-numbox[data-v-7e0e10b6]:after{content:"";position:absolute;-webkit-transform-origin:center;transform-origin:center;box-sizing:border-box;pointer-events:none;top:-50%;left:-50%;right:-50%;bottom:-50%;border:1px solid #c8c7cc;border-radius:%?12?%;-webkit-transform:scale(.5);transform:scale(.5)}.uni-numbox__minus[data-v-7e0e10b6],.uni-numbox__plus[data-v-7e0e10b6]{margin:0;background-color:#f8f8f8;width:%?70?%;font-size:%?40?%;height:100%;line-height:%?50?%;text-align:center;display:-webkit-inline-box;display:-webkit-inline-flex;display:inline-flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;color:#333;position:relative}.uni-numbox__value[data-v-7e0e10b6]{position:relative;background-color:#fff;width:%?200?%;height:100%;text-align:center;padding:0}.uni-numbox__value[data-v-7e0e10b6]:after{content:"";position:absolute;-webkit-transform-origin:center;transform-origin:center;box-sizing:border-box;pointer-events:none;top:-50%;left:-50%;right:-50%;bottom:-50%;border-style:solid;border-color:#c8c7cc;border-left-width:1px;border-right-width:1px;border-top-width:0;border-bottom-width:0;-webkit-transform:scale(.5);transform:scale(.5)}.uni-numbox--disabled[data-v-7e0e10b6]{color:silver}',""])},"73ad":function(e,t,n){"use strict";var r=n("b9e4"),i=n.n(r);i.a},7800:function(e,t,n){"use strict";n.r(t);var r=n("87ff"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,function(){return r[e]})}(o);t["default"]=i.a},7871:function(e,t,n){var r=n("4d00");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("10a23c48",r,!0,{sourceMap:!1,shadowMode:!1})},"7fd5":function(e,t,n){"use strict";(function(t){var r=n("288e");n("6b54"),n("7514");var i=r(n("5d73"));n("c5f6");var o=r(n("795b")),a=r(n("9546"));e.exports={enterAddGoodNum:function(e){var n=this;return new o.default(function(r,o){for(var u=function(o){var u=0,l=a.default.Query("Goods");l.get(e[o].objectId).then(function(s){var d=s;if(e[o].selectd_model){var c=!0,f=!1,v=void 0;try{for(var m,h=(0,i.default)(e[o].selected_model);!(c=(m=h.next()).done);c=!0){var b=m.value,g=!0,p=!1,y=void 0;try{for(var _,w=(0,i.default)(d.models);!(g=(_=w.next()).done);g=!0){var x=_.value;x.id==b.id&&(x.reserve=Number(x.reserve)+Number(b.num)),delete x.num}}catch(k){p=!0,y=k}finally{try{g||null==w.return||w.return()}finally{if(p)throw y}}}}catch(k){f=!0,v=k}finally{try{c||null==h.return||h.return()}finally{if(f)throw v}}u=Number(d.reserve)+Number(e[o].num),l.set("models",d.models)}else u=Number(d.reserve)+Number(e[o].num);l.set("reserve",u),l.set("id",e[o].objectId),l.save().then(function(i){if(e[o].header){var u=a.default.Query("Goods");u.equalTo("header","==",e[o].header.objectId),u.equalTo("order","==",1),u.statTo("sum","reserve"),u.find().then(function(i){t.log("dasds",i);var u=i[0]._sumReserve,l=a.default.Query("Goods");l.set("reserve",u),l.set("id",e[o].header.objectId),l.save().then(function(t){n.modifyStockType(e[o].header.objectId),o==e.length-1&&r(!0)})})}else n.modifyStockType(e[o].objectId),o==e.length-1&&r(!0)}).catch(function(e){t.log(e)})})},l=0;l<e.length;l++)u(l)})},outRedGoodNum:function(e){var n=this;return new o.default(function(r,o){for(var u=function(o){var u=0,l=a.default.Query("Goods");l.get(e[o].objectId).then(function(s){var d=s;if(e[o].selectd_model){var c=!0,f=!1,v=void 0;try{for(var m,h=(0,i.default)(e[o].selected_model);!(c=(m=h.next()).done);c=!0){var b=m.value,g=!0,p=!1,y=void 0;try{for(var _,w=(0,i.default)(d.models);!(g=(_=w.next()).done);g=!0){var x=_.value;u+=Number(x.reserve),x.id==b.id&&(x.reserve=Number(x.reserve)-Number(b.num)),delete x.num}}catch(k){p=!0,y=k}finally{try{g||null==w.return||w.return()}finally{if(p)throw y}}}}catch(k){f=!0,v=k}finally{try{c||null==h.return||h.return()}finally{if(f)throw v}}u=Number(d.reserve)-Number(e[o].num),l.set("models",d.models)}else u=Number(d.reserve)-Number(e[o].num);l.set("reserve",u),l.set("id",e[o].objectId),l.save().then(function(t){if(e[o].header){var i=a.default.Query("Goods");i.equalTo("header","==",e[o].header.objectId),i.equalTo("order","==",1),i.statTo("sum","reserve"),i.find().then(function(t){var i=t[0]._sumReserve,u=a.default.Query("Goods");u.set("reserve",i),u.set("id",e[o].header.objectId),u.save().then(function(t){n.modifyStockType(e[o].header.objectId),o==e.length-1&&r(!0)})})}else n.modifyStockType(e[o].objectId),o==e.length-1&&r(!0)}).catch(function(e){t.log(e)})})},l=0;l<e.length;l++)u(l)})},enterAddGoodNumNew:function(e){var n=this;return new o.default(function(r,o){for(var u=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",l=uni.getStorageSync("uid"),s=function(o){var s=0,d=a.default.Query("Goods");d.get(e[o].objectId).then(function(d){if(e[o].selectd_model){var c=!0,f=!1,v=void 0;try{for(var m,h=(0,i.default)(e[o].selected_model);!(c=(m=h.next()).done);c=!0){var b=m.value,g=!0,p=!1,y=void 0;try{for(var _,w=(0,i.default)(e[o].models);!(g=(_=w.next()).done);g=!0){var x=_.value;x.id==b.id&&(x.reserve=Number(x.reserve)+Number(b.num)),delete x.num}}catch(S){p=!0,y=S}finally{try{g||null==w.return||w.return()}finally{if(p)throw y}}}}catch(S){f=!0,v=S}finally{try{c||null==h.return||h.return()}finally{if(f)throw v}}s=Number(e[o].reserve)+Number(e[o].num),d.set("models",e[o].models)}else s=Number(e[o].reserve)+Number(e[o].num);d.set("reserve",s),d.save();var k=a.default.Query("Goods");k.equalTo("userId","==",l),k.equalTo("header","==",e[o].objectId),k.equalTo("stocks","==",u.objectId),k.find().then(function(i){if(0==i.length)n.upload_good_withNoCan(e[o],u,Number(e[o].num)).then(function(n){t.log(n),o==e.length-1&&r(!0)});else{var l=a.default.Query("Goods");l.set("id",i[0].objectId),l.set("reserve",i[0].reserve+Number(e[o].num)),l.save().then(function(n){t.log(n),o==e.length-1&&r(!0)}).catch(function(e){t.log(e)})}})}).catch(function(e){t.log(e)})},d=0;d<e.length;d++)s(d)})},outRedGoodNumNew:function(e){var n=this;return new o.default(function(r,o){for(var u=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",l=uni.getStorageSync("uid"),s=function(o){var s=0,d=a.default.Query("Goods");d.get(e[o].objectId).then(function(d){if(e[o].selectd_model){var c=!0,f=!1,v=void 0;try{for(var m,h=(0,i.default)(e[o].selected_model);!(c=(m=h.next()).done);c=!0){var b=m.value,g=!0,p=!1,y=void 0;try{for(var _,w=(0,i.default)(e[o].models);!(g=(_=w.next()).done);g=!0){var x=_.value;x.id==b.id&&(x.reserve=Number(x.reserve)-Number(b.num)),delete x.num}}catch(S){p=!0,y=S}finally{try{g||null==w.return||w.return()}finally{if(p)throw y}}}}catch(S){f=!0,v=S}finally{try{c||null==h.return||h.return()}finally{if(f)throw v}}s=Number(e[o].reserve)-Number(e[o].num),d.set("models",e[o].models)}else s=Number(e[o].reserve)-Number(e[o].num);d.set("reserve",s),d.save();var k=a.default.Query("Goods");k.equalTo("userId","==",l),k.equalTo("header","==",e[o].objectId),k.equalTo("stocks","==",u.objectId),k.find().then(function(i){if(0==i.length)n.upload_good_withNoCan(e[o],u,Number(e[o].num),"out").then(function(n){t.log(n),o==e.length-1&&r(!0)});else{var l=a.default.Query("Goods");l.set("id",i[0].objectId),l.set("reserve",i[0].reserve-Number(e[o].num)),l.save().then(function(n){t.log(n),o==e.length-1&&r(!0)}).catch(function(e){t.log(e)})}})}).catch(function(e){t.log(e)})},d=0;d<e.length;d++)s(d)})},upload_good_withNoCan:function(e,n,r,u){return new o.default(function(o,l){var s=uni.getStorageSync("uid"),d=a.default.Pointer("_User"),c=d.set(s),f=a.default.Pointer("stocks"),v=f.set(n.objectId),m=a.default.Pointer("Goods"),h="";h=e.header?m.set(e.header.objectId):m.set(e.objectId);var b=a.default.Query("Goods");if(b.set("goodsName",e.goodsName),b.set("goodsIcon",e.goodsIcon),"out"==u){if(b.set("reserve",0-Number(r)),e.goodsId&&e.goodsId.models){var g=!0,p=!1,y=void 0;try{for(var _,w=(0,i.default)(e.goodsId.models);!(g=(_=w.next()).done);g=!0){var x=_.value;x.reserve=0-Number(x.num)}}catch(q){p=!0,y=q}finally{try{g||null==w.return||w.return()}finally{if(p)throw y}}b.set("models",e.goodsId.models)}}else if("allocation"==u){if(b.set("reserve",Number(r)),e.selected_model&&e.selected_model.length>0){var k=!0,S=!1,N=void 0;try{for(var I,j=(0,i.default)(e.selected_model);!(k=(I=j.next()).done);k=!0){var C=I.value;C.reserve=Number(C.num),delete C.num}}catch(q){S=!0,N=q}finally{try{k||null==j.return||j.return()}finally{if(S)throw N}}b.set("models",e.selected_model)}}else if(b.set("reserve",Number(r)),e.goodsId&&e.goodsId.models){var T=!0,P=!1,G=void 0;try{for(var Q,E=(0,i.default)(e.goodsId.models);!(T=(Q=E.next()).done);T=!0){var M=Q.value;M.reserve=Number(M.num)}}catch(q){P=!0,G=q}finally{try{T||null==E.return||E.return()}finally{if(P)throw G}}b.set("models",e.goodsId.models)}b.set("stocks",v),b.set("userId",c),b.set("header",h),b.set("costPrice",""+e.costPrice),b.set("retailPrice",""+e.retailPrice),b.set("order",1),b.save().then(function(e){t.log(e),o([!0,e])}).catch(function(e){t.log(e)})})},handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(e,n,r){var i=a.default.Pointer("_User"),o=i.set(uni.getStorageSync("uid"));if(-2==n){var u=a.default.Pointer("Goods"),l=u.set(r),s=a.default.Query("logs");s.equalTo("goodId","==",r),s.find().then(function(r){if(0==r.length){var i=a.default.Query("logs");i.set("parent",o),i.set("goodId",l),i.set("log",e),i.set("type",n),i.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}})}else{var d=a.default.Query("logs");d.set("parent",o),d.set("log",e),d.set("detail_id",r),d.set("type",n),d.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}},modifyStockType:function(e){var n=this,r=a.default.Query("Goods");r.get(e).then(function(e){var t=e;""==t.warning_num&&""==t.max_num?e.set("stocktype",1):void 0==t.warning_num&&void 0==t.max_num?e.set("stocktype",1):null==t.warning_num&&null==t.max_num?e.set("stocktype",1):(""!=t.warning_num&&(t.warning_num>=t.reserve?(e.set("stocktype",0),n.log(t.goodsName+"已经超过设置的最小库存值"+t.warning_num,-2,t.objectId)):t.warning_num<t.reserve&&t.reserve<t.max_num&&e.set("stocktype",1)),""!=t.max_num&&(t.max_num<=t.reserve?(e.set("stocktype",2),n.log(t.goodsName+"已经超过设置的最大库存值"+t.max_num,-2,t.objectId)):t.warning_num<t.reserve&&t.reserve<t.max_num&&e.set("stocktype",1))),e.save()}).catch(function(e){t.log(e)})},record_shopOut:function(e,n){t.log(e,n);var r=a.default.Query("shops");r.set("id",e),r.set("have_out",n),r.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})},record_staffOut:function(e){if(t.log(e,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var n=a.default.Query("_User");n.set("id",uni.getStorageSync("user").objectId),n.set("have_out",Number(e)+uni.getStorageSync("user").have_out),n.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}},get_allCost:function(){var e=uni.getStorageSync("uid");t.log(e);var n=a.default.Query("Goods");n.equalTo("userId","==",e),n.find().then(function(e){t.log(e);var n=!0,r=!1,o=void 0;try{for(var a,u=(0,i.default)(e);!(n=(a=u.next()).done);n=!0){var l=a.value;t.log(l),Number(l.costPrice)*l.reserve,l.reserve}}catch(s){r=!0,o=s}finally{try{n||null==u.return||u.return()}finally{if(r)throw o}}})},getDay:function(e,t){var n=this,r=new Date,i=r.getTime()+864e5*e;r.setTime(i);var o=r.getFullYear(),a=r.getMonth(),u=r.getDate();return a=n.handleMonth(a+1),u=n.handleMonth(u),t?o+"-"+a+"-"+u+" 00:00:00":o+"-"+a+"-"+u},js_date_time:function(e,t){var n=new Date(e),r=n.getFullYear(),i=n.getMonth()+1;i=i<10?"0"+i:i;var o=n.getDate();o=o<10?"0"+o:o;var a=n.getHours();a=a<10?"0"+a:a;var u=n.getMinutes(),l=n.getSeconds();return u=u<10?"0"+u:u,l=l<10?"0"+l:l,t?r+"-"+i+"-"+o+" "+a+":"+u:r+"-"+i+"-"+o},handleMonth:function(e){var t=e;return 1==e.toString().length&&(t="0"+e),t}}}).call(this,n("5a52")["default"])},"87ff":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("28a5"),n("c5f6");var r={name:"UniNumberBox",props:{value:{type:[Number,String],default:1},min:{type:Number,default:0},max:{type:Number,default:99999999999},step:{type:Number,default:1},disabled:{type:Boolean,default:!1}},data:function(){return{inputValue:0}},watch:{value:function(e){this.inputValue=+e},inputValue:function(e,t){+e!==+t&&this.$emit("change",e)}},created:function(){this.inputValue=+this.value},methods:{_calcValue:function(e){if(!this.disabled){var t=this._getDecimalScale(),n=this.inputValue*t,r=this.step*t;"minus"===e?n-=r:"plus"===e&&(n+=r),n<this.min||n>this.max||(this.inputValue=n/t)}},_getDecimalScale:function(){var e=1;return~~this.step!==this.step&&(e=Math.pow(10,(this.step+"").split(".")[1].length)),e},_onBlur:function(e){var t=e.detail.value;t?(t=+t,t>this.max?t=this.max:t<this.min&&(t=this.min),this.inputValue=t):this.inputValue=0}}};t.default=r},8975:function(e,t,n){"use strict";n.r(t);var r=n("efc8"),i=n("4aab");for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);n("ef84");var a=n("f0c5"),u=Object(a["a"])(i["default"],r["a"],r["b"],!1,null,"ea954bea",null);t["default"]=u.exports},9603:function(e,t,n){"use strict";n.r(t);var r=n("c0b1"),i=n("41cc");for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);n("73ad");var a=n("f0c5"),u=Object(a["a"])(i["default"],r["a"],r["b"],!1,null,"1601e425",null);t["default"]=u.exports},a5c5:function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,".page[data-v-1601e425]{font-size:%?28?%;height:calc(100vh - %?88?%);overflow:scroll}.margin-b-10[data-v-1601e425]{margin-top:%?20?%}.input_withlabel[data-v-1601e425]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;margin:%?10?% 0}.bottom_del[data-v-1601e425]{text-align:right}.del[data-v-1601e425]{display:-webkit-inline-box;display:-webkit-inline-flex;display:inline-flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;background:#aa2116;color:#fff;-webkit-box-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;padding:%?4?% %?12?%;border-radius:%?8?%}.input_label[data-v-1601e425]{border:%?1?% solid#ddd;border-radius:%?8?%;padding:0 %?6?%;width:%?140?%;color:#aa2116}",""])},b9e4:function(e,t,n){var r=n("a5c5");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("5bba050c",r,!0,{sourceMap:!1,shadowMode:!1})},baa2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={name:"UniCard",props:{title:{type:String,default:""},extra:{type:String,default:""},note:{type:String,default:""},thumbnail:{type:String,default:""},isFull:{type:Boolean,default:!1}},methods:{onClick:function(){this.$emit("click")}}};t.default=r},c0b1:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[n("uni-nav-bar",{attrs:{fixed:!1,color:"#333333","background-color":"#FFFFFF","right-text":"确定",leftIcon:"scan","left-text":"扫码"},on:{"click-right":function(t){arguments[0]=t=e.$handleEvent(t),e.confrim_this.apply(void 0,arguments)},"click-left":function(t){arguments[0]=t=e.$handleEvent(t),e.scanGoods.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"page"},e._l(e.products,function(t,r){return n("v-uni-view",{key:r,staticClass:"margin-b-10"},[n("unicard",{attrs:{title:"物料名："+t.goodsName}},[n("v-uni-view",[n("v-uni-view",{staticStyle:{"margin-bottom":"10rpx"}},[e._v("库存："+e._s(t.reserve))]),e.user.rights&&"0"!=e.user.rights.othercurrent[0]?n("v-uni-view"):n("v-uni-view",[e._v("期初进货价："+e._s(t.costPrice)+"(元)")]),e.user.rights&&"0"!=e.user.rights.othercurrent[0]?n("v-uni-view",{staticClass:"input_withlabel"},[n("v-uni-view",[e._v("实际进货价(可修改)：")]),n("v-uni-view",[n("v-uni-input",{staticClass:"input_label",attrs:{placeholder:"0",type:"digit"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.getrealprice(t,r)}}})],1)],1):n("v-uni-view",{staticClass:"input_withlabel"},[n("v-uni-view",[e._v("实际进货价(可修改)：")]),n("v-uni-view",[n("v-uni-input",{staticClass:"input_label",attrs:{placeholder:t.costPrice,type:"digit"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.getrealprice(t,r)}}})],1)],1),t.selectd_model?n("v-uni-view",e._l(t.selectd_model,function(t,i){return n("v-uni-view",{key:i,staticClass:"margin-t-5",staticStyle:{"margin-bottom":"10rpx"}},[n("v-uni-text",{staticStyle:{color:"#f30"}},[e._v(e._s(t.custom1.value+t.custom2.value+t.custom3.value+t.custom4.value))]),"production"==e.type?n("v-uni-view",[e._v("数量："),n("uninumberbox",{attrs:{min:0,value:"1"},on:{change:function(n){arguments[0]=n=e.$handleEvent(n),e.handleModelNumChange(n,r,i,t)}}})],1):n("v-uni-view",[e._v("采购量："),n("uninumberbox",{attrs:{min:0,value:"1"},on:{change:function(n){arguments[0]=n=e.$handleEvent(n),e.handleModelNumChange(n,r,i,t)}}})],1)],1)}),1):n("v-uni-view",{staticClass:"margin-t-5"},["production"==e.type?n("v-uni-view",[e._v("数量："),n("uninumberbox",{attrs:{min:1,max:Number(t.reserve)},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleNumChange(t,r)}}})],1):"productionEdit"==e.type?n("v-uni-view",[e._v("数量："),n("uninumberbox",{attrs:{min:1,max:Number(t.reserve),value:Number(t.num)},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleNumChange(t,r)}}})],1):n("v-uni-view",[e._v("采购量："),n("uninumberbox",{attrs:{min:1},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleNumChange(t,r)}}})],1)],1),n("v-uni-view",{staticClass:"bottom_del"},[n("v-uni-view",{staticClass:"del",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleDel(r)}}},[n("fa-icon",{attrs:{type:"close",size:"15",color:"#fff"}}),e._v("删除")],1)],1)],1)],1)],1)}),1)],1)},i=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i})},ef84:function(e,t,n){"use strict";var r=n("7871"),i=n.n(r);i.a},efc8:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"uni-card",class:e.isFull?"uni-card--full":"",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onClick.apply(void 0,arguments)}}},[e.title?n("v-uni-view",{staticClass:"uni-card__header"},[e.thumbnail?n("v-uni-view",{staticClass:"uni-card__header-extra-img-view"},[n("v-uni-image",{staticClass:"uni-card__header-extra-img",attrs:{src:e.thumbnail}})],1):e._e(),n("v-uni-view",{staticClass:"uni-card__header-title-text"},[e._v(e._s(e.title))]),e.extra?n("v-uni-view",{staticClass:"uni-card__header-extra-text"},[e._v(e._s(e.extra))]):e._e()],1):e._e(),n("v-uni-view",{staticClass:"uni-card__content uni-card__content--pd"},[e._t("default")],2),e.note?n("v-uni-view",{staticClass:"uni-card__footer"},[e._v(e._s(e.note))]):e._e()],1)},i=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i})}}]);