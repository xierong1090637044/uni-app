(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-goods_add-goods_add"],{"0f21":function(e,t,i){"use strict";i.r(t);var n=i("dffb"),a=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,function(){return n[e]})}(o);t["default"]=a.a},"0f7e":function(e,t,i){t=e.exports=i("2350")(!1),t.push([e.i,'.uni-collapse[data-v-7cac7d33]{background-color:#fff;position:relative;width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.uni-collapse[data-v-7cac7d33]:after{position:absolute;z-index:10;right:0;bottom:0;left:0;height:1px;content:"";-webkit-transform:scaleY(.5);transform:scaleY(.5);background-color:#c8c7cc}.uni-collapse[data-v-7cac7d33]:before{position:absolute;z-index:10;right:0;top:0;left:0;height:1px;content:"";-webkit-transform:scaleY(.5);transform:scaleY(.5);background-color:#c8c7cc}',""])},"35fc":function(e,t,i){"use strict";i.r(t);var n=i("d5e2"),a=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,function(){return n[e]})}(o);t["default"]=a.a},3867:function(e,t,i){t=e.exports=i("2350")(!1),t.push([e.i,"[data-v-bc278ca4]::-webkit-scrollbar{width:2px;height:6px;background-color:initial}.uni-input-placeholder[data-v-bc278ca4]{font-size:12px}uni-input[data-v-bc278ca4]{font-size:12px}\n\n/*定义滑块 内阴影+圆角*/[data-v-bc278ca4]::-webkit-scrollbar-thumb{border-radius:10px;background-color:#999}.page[data-v-bc278ca4]{font-size:%?28?%;background:#fafafa;height:100vh;overflow:scroll}.frist[data-v-bc278ca4]{padding:0 %?20?%;background:#fff;margin-top:%?30?%}.frist1[data-v-bc278ca4]{padding:0 %?20?%;background:#fff}.input_item[data-v-bc278ca4]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;line-height:%?80?%;height:%?80?%;border-bottom:%?1?% solid#f6f5ec}.input_item2[data-v-bc278ca4]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;line-height:%?80?%;height:%?80?%;border-bottom:%?1?% solid#f6f5ec}.left_item[data-v-bc278ca4]{color:#333;width:%?150?%}.right_input1[data-v-bc278ca4]{font-size:12px}.submit_button[data-v-bc278ca4]{width:50%;background:#426ab3;border-radius:%?40?%;margin:%?30?%;height:%?88?%;line-height:%?88?%;color:#fff;font-size:%?30?%}.upload_image[data-v-bc278ca4]{width:%?180?%;height:%?180?%;line-height:%?220?%;text-align:center;border:%?1?% solid#999;border-radius:%?8?%}.notice_text[data-v-bc278ca4]{padding-top:%?20?%;font-size:%?32?%;color:#3d3d3d;font-weight:700}.reset_button[data-v-bc278ca4]{font-size:%?30?%;width:50%;background:#999;border-radius:%?40?%;margin:%?30?%;height:%?88?%;line-height:%?88?%;color:#fff}",""])},"5b26":function(e,t,i){var n=i("de3d");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("228339ca",n,!0,{sourceMap:!1,shadowMode:!1})},"72dd":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"uni-collapse"},[e._t("default")],2)},a=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a})},"7c20":function(e,t,i){"use strict";i.r(t);var n=i("ce70"),a=i("f9c7");for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);i("f12f");var r=i("f0c5"),s=Object(r["a"])(a["default"],n["a"],n["b"],!1,null,"07b66df4",null);t["default"]=s.exports},"7fd5":function(e,t,i){"use strict";(function(t){var n=i("288e");i("6b54"),i("7514");var a=n(i("5d73"));i("c5f6");var o=n(i("795b")),r=n(i("9546"));e.exports={enterAddGoodNum:function(e){var i=this;return new o.default(function(n,o){for(var s=function(o){var s=0,l=r.default.Query("Goods");l.get(e[o].objectId).then(function(c){var u=c;if(e[o].selectd_model){var d=!0,f=!1,v=void 0;try{for(var g,p=(0,a.default)(e[o].selected_model);!(d=(g=p.next()).done);d=!0){var h=g.value,m=!0,b=!1,w=void 0;try{for(var _,y=(0,a.default)(u.models);!(m=(_=y.next()).done);m=!0){var k=_.value;k.id==h.id&&(k.reserve=Number(k.reserve)+Number(h.num)),delete k.num}}catch(x){b=!0,w=x}finally{try{m||null==y.return||y.return()}finally{if(b)throw w}}}}catch(x){f=!0,v=x}finally{try{d||null==p.return||p.return()}finally{if(f)throw v}}s=Number(u.reserve)+Number(e[o].num),l.set("models",u.models)}else s=Number(u.reserve)+Number(e[o].num);l.set("reserve",s),l.set("id",e[o].objectId),l.save().then(function(a){if(e[o].header){var s=r.default.Query("Goods");s.equalTo("header","==",e[o].header.objectId),s.equalTo("order","==",1),s.statTo("sum","reserve"),s.find().then(function(a){t.log("dasds",a);var s=a[0]._sumReserve,l=r.default.Query("Goods");l.set("reserve",s),l.set("id",e[o].header.objectId),l.save().then(function(t){i.modifyStockType(e[o].header.objectId),o==e.length-1&&n(!0)})})}else i.modifyStockType(e[o].objectId),o==e.length-1&&n(!0)}).catch(function(e){t.log(e)})})},l=0;l<e.length;l++)s(l)})},outRedGoodNum:function(e){var i=this;return new o.default(function(n,o){for(var s=function(o){var s=0,l=r.default.Query("Goods");l.get(e[o].objectId).then(function(c){var u=c;if(e[o].selectd_model){var d=!0,f=!1,v=void 0;try{for(var g,p=(0,a.default)(e[o].selected_model);!(d=(g=p.next()).done);d=!0){var h=g.value,m=!0,b=!1,w=void 0;try{for(var _,y=(0,a.default)(u.models);!(m=(_=y.next()).done);m=!0){var k=_.value;s+=Number(k.reserve),k.id==h.id&&(k.reserve=Number(k.reserve)-Number(h.num)),delete k.num}}catch(x){b=!0,w=x}finally{try{m||null==y.return||y.return()}finally{if(b)throw w}}}}catch(x){f=!0,v=x}finally{try{d||null==p.return||p.return()}finally{if(f)throw v}}s=Number(u.reserve)-Number(e[o].num),l.set("models",u.models)}else s=Number(u.reserve)-Number(e[o].num);l.set("reserve",s),l.set("id",e[o].objectId),l.save().then(function(t){if(e[o].header){var a=r.default.Query("Goods");a.equalTo("header","==",e[o].header.objectId),a.equalTo("order","==",1),a.statTo("sum","reserve"),a.find().then(function(t){var a=t[0]._sumReserve,s=r.default.Query("Goods");s.set("reserve",a),s.set("id",e[o].header.objectId),s.save().then(function(t){i.modifyStockType(e[o].header.objectId),o==e.length-1&&n(!0)})})}else i.modifyStockType(e[o].objectId),o==e.length-1&&n(!0)}).catch(function(e){t.log(e)})})},l=0;l<e.length;l++)s(l)})},enterAddGoodNumNew:function(e){var i=this;return new o.default(function(n,o){for(var s=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",l=uni.getStorageSync("uid"),c=function(o){var c=0,u=r.default.Query("Goods");u.get(e[o].objectId).then(function(u){if(e[o].selectd_model){var d=!0,f=!1,v=void 0;try{for(var g,p=(0,a.default)(e[o].selected_model);!(d=(g=p.next()).done);d=!0){var h=g.value,m=!0,b=!1,w=void 0;try{for(var _,y=(0,a.default)(e[o].models);!(m=(_=y.next()).done);m=!0){var k=_.value;k.id==h.id&&(k.reserve=Number(k.reserve)+Number(h.num)),delete k.num}}catch(S){b=!0,w=S}finally{try{m||null==y.return||y.return()}finally{if(b)throw w}}}}catch(S){f=!0,v=S}finally{try{d||null==p.return||p.return()}finally{if(f)throw v}}c=Number(e[o].reserve)+Number(e[o].num),u.set("models",e[o].models)}else c=Number(e[o].reserve)+Number(e[o].num);u.set("reserve",c),u.save();var x=r.default.Query("Goods");x.equalTo("userId","==",l),x.equalTo("header","==",e[o].objectId),x.equalTo("stocks","==",s.objectId),x.find().then(function(a){if(0==a.length)i.upload_good_withNoCan(e[o],s,Number(e[o].num)).then(function(i){t.log(i),o==e.length-1&&n(!0)});else{var l=r.default.Query("Goods");l.set("id",a[0].objectId),l.set("reserve",a[0].reserve+Number(e[o].num)),l.save().then(function(i){t.log(i),o==e.length-1&&n(!0)}).catch(function(e){t.log(e)})}})}).catch(function(e){t.log(e)})},u=0;u<e.length;u++)c(u)})},outRedGoodNumNew:function(e){var i=this;return new o.default(function(n,o){for(var s=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",l=uni.getStorageSync("uid"),c=function(o){var c=0,u=r.default.Query("Goods");u.get(e[o].objectId).then(function(u){if(e[o].selectd_model){var d=!0,f=!1,v=void 0;try{for(var g,p=(0,a.default)(e[o].selected_model);!(d=(g=p.next()).done);d=!0){var h=g.value,m=!0,b=!1,w=void 0;try{for(var _,y=(0,a.default)(e[o].models);!(m=(_=y.next()).done);m=!0){var k=_.value;k.id==h.id&&(k.reserve=Number(k.reserve)-Number(h.num)),delete k.num}}catch(S){b=!0,w=S}finally{try{m||null==y.return||y.return()}finally{if(b)throw w}}}}catch(S){f=!0,v=S}finally{try{d||null==p.return||p.return()}finally{if(f)throw v}}c=Number(e[o].reserve)-Number(e[o].num),u.set("models",e[o].models)}else c=Number(e[o].reserve)-Number(e[o].num);u.set("reserve",c),u.save();var x=r.default.Query("Goods");x.equalTo("userId","==",l),x.equalTo("header","==",e[o].objectId),x.equalTo("stocks","==",s.objectId),x.find().then(function(a){if(0==a.length)i.upload_good_withNoCan(e[o],s,Number(e[o].num),"out").then(function(i){t.log(i),o==e.length-1&&n(!0)});else{var l=r.default.Query("Goods");l.set("id",a[0].objectId),l.set("reserve",a[0].reserve-Number(e[o].num)),l.save().then(function(i){t.log(i),o==e.length-1&&n(!0)}).catch(function(e){t.log(e)})}})}).catch(function(e){t.log(e)})},u=0;u<e.length;u++)c(u)})},upload_good_withNoCan:function(e,i,n,s){return new o.default(function(o,l){var c=uni.getStorageSync("uid"),u=r.default.Pointer("_User"),d=u.set(c),f=r.default.Pointer("stocks"),v=f.set(i.objectId),g=r.default.Pointer("Goods"),p="";p=e.header?g.set(e.header.objectId):g.set(e.objectId);var h=r.default.Query("Goods");if(h.set("goodsName",e.goodsName),h.set("goodsIcon",e.goodsIcon),"out"==s){if(h.set("reserve",0-Number(n)),e.goodsId&&e.goodsId.models){var m=!0,b=!1,w=void 0;try{for(var _,y=(0,a.default)(e.goodsId.models);!(m=(_=y.next()).done);m=!0){var k=_.value;k.reserve=0-Number(k.num)}}catch(M){b=!0,w=M}finally{try{m||null==y.return||y.return()}finally{if(b)throw w}}h.set("models",e.goodsId.models)}}else if("allocation"==s){if(h.set("reserve",Number(n)),e.selected_model&&e.selected_model.length>0){var x=!0,S=!1,C=void 0;try{for(var N,I=(0,a.default)(e.selected_model);!(x=(N=I.next()).done);x=!0){var j=N.value;j.reserve=Number(j.num),delete j.num}}catch(M){S=!0,C=M}finally{try{x||null==I.return||I.return()}finally{if(S)throw C}}h.set("models",e.selected_model)}}else if(h.set("reserve",Number(n)),e.goodsId&&e.goodsId.models){var P=!0,T=!1,z=void 0;try{for(var G,Q=(0,a.default)(e.goodsId.models);!(P=(G=Q.next()).done);P=!0){var O=G.value;O.reserve=Number(O.num)}}catch(M){T=!0,z=M}finally{try{P||null==Q.return||Q.return()}finally{if(T)throw z}}h.set("models",e.goodsId.models)}h.set("stocks",v),h.set("userId",d),h.set("header",p),h.set("costPrice",""+e.costPrice),h.set("retailPrice",""+e.retailPrice),h.set("order",1),h.save().then(function(e){t.log(e),o([!0,e])}).catch(function(e){t.log(e)})})},handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(e,i,n){var a=r.default.Pointer("_User"),o=a.set(uni.getStorageSync("uid"));if(-2==i){var s=r.default.Pointer("Goods"),l=s.set(n),c=r.default.Query("logs");c.equalTo("goodId","==",n),c.find().then(function(n){if(0==n.length){var a=r.default.Query("logs");a.set("parent",o),a.set("goodId",l),a.set("log",e),a.set("type",i),a.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}})}else{var u=r.default.Query("logs");u.set("parent",o),u.set("log",e),u.set("detail_id",n),u.set("type",i),u.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}},modifyStockType:function(e){var i=this,n=r.default.Query("Goods");n.get(e).then(function(e){var t=e;""==t.warning_num&&""==t.max_num?e.set("stocktype",1):void 0==t.warning_num&&void 0==t.max_num?e.set("stocktype",1):null==t.warning_num&&null==t.max_num?e.set("stocktype",1):(""!=t.warning_num&&(t.warning_num>=t.reserve?(e.set("stocktype",0),i.log(t.goodsName+"已经超过设置的最小库存值"+t.warning_num,-2,t.objectId)):t.warning_num<t.reserve&&t.reserve<t.max_num&&e.set("stocktype",1)),""!=t.max_num&&(t.max_num<=t.reserve?(e.set("stocktype",2),i.log(t.goodsName+"已经超过设置的最大库存值"+t.max_num,-2,t.objectId)):t.warning_num<t.reserve&&t.reserve<t.max_num&&e.set("stocktype",1))),e.save()}).catch(function(e){t.log(e)})},record_shopOut:function(e,i){t.log(e,i);var n=r.default.Query("shops");n.set("id",e),n.set("have_out",i),n.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})},record_staffOut:function(e){if(t.log(e,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var i=r.default.Query("_User");i.set("id",uni.getStorageSync("user").objectId),i.set("have_out",Number(e)+uni.getStorageSync("user").have_out),i.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}},get_allCost:function(){var e=uni.getStorageSync("uid");t.log(e);var i=r.default.Query("Goods");i.equalTo("userId","==",e),i.find().then(function(e){t.log(e);var i=!0,n=!1,o=void 0;try{for(var r,s=(0,a.default)(e);!(i=(r=s.next()).done);i=!0){var l=r.value;t.log(l),Number(l.costPrice)*l.reserve,l.reserve}}catch(c){n=!0,o=c}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}})},getDay:function(e,t){var i=this,n=new Date,a=n.getTime()+864e5*e;n.setTime(a);var o=n.getFullYear(),r=n.getMonth(),s=n.getDate();return r=i.handleMonth(r+1),s=i.handleMonth(s),t?o+"-"+r+"-"+s+" 00:00:00":o+"-"+r+"-"+s},js_date_time:function(e,t){var i=new Date(e),n=i.getFullYear(),a=i.getMonth()+1;a=a<10?"0"+a:a;var o=i.getDate();o=o<10?"0"+o:o;var r=i.getHours();r=r<10?"0"+r:r;var s=i.getMinutes(),l=i.getSeconds();return s=s<10?"0"+s:s,l=l<10?"0"+l:l,t?n+"-"+a+"-"+o+" "+r+":"+s:n+"-"+a+"-"+o},handleMonth:function(e){var t=e;return 1==e.toString().length&&(t="0"+e),t}}}).call(this,i("5a52")["default"])},"8e22":function(e,t,i){"use strict";var n=i("bbd4"),a=i.n(n);a.a},a2b2:function(e,t,i){"use strict";i.r(t);var n=i("ad41"),a=i("0f21");for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);i("8e22");var r=i("f0c5"),s=Object(r["a"])(a["default"],n["a"],n["b"],!1,null,"bc278ca4",null);t["default"]=s.exports},a4db:function(e,t,i){var n=i("0f7e");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("74167560",n,!0,{sourceMap:!1,shadowMode:!1})},ad41:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"page"},[i("v-uni-form",{on:{submit:function(t){arguments[0]=t=e.$handleEvent(t),e.formSubmit.apply(void 0,arguments)}}},[i("v-uni-scroll-view",{staticStyle:{height:"calc(100vh - 148rpx)"},attrs:{"scroll-y":!0}},[i("v-uni-view",{staticClass:"frist"},[i("v-uni-view",{staticClass:"notice_text"},[e._v("产品图")]),i("v-uni-view",{staticStyle:{width:"100%",padding:"20rpx 0"}},[i("v-uni-view",{staticClass:"upload_image",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.upload_image.apply(void 0,arguments)}}},[e.goodsIcon?i("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx"},attrs:{src:e.goodsIcon}}):i("fa-icon",{staticStyle:{height:"180rpx","line-height":"180rpx"},attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1),i("v-uni-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{name:"goodsIcon",value:e.goodsIcon}})],1)],1),i("v-uni-view",{staticClass:"frist",staticStyle:{"margin-bottom":"20rpx"}},[i("v-uni-view",{staticClass:"notice_text"},[e._v("基本信息")]),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[e._v("名称"),i("v-uni-text",{staticStyle:{color:"#aa2116","margin-left":"4rpx"}},[e._v("*")])],1),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{placeholder:"产品名称",name:"goodsName",value:e.goodsName}})],1)],1),i("v-uni-navigator",{staticClass:"input_item2",attrs:{"hover-class":"none",url:"/pages/manage/category/category?type=choose"}},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",{staticClass:"left_item"},[e._v("类别")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{placeholder:"产品类别",name:"goodsClass",value:e.category.class_text,disabled:"true"}})],1)],1),i("v-uni-view",[i("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[e._v("进价")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{placeholder:"产品进价",name:"costPrice",type:"digit",value:e.costPrice}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[e._v("售价")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{placeholder:"产品售价",name:"retailPrice",type:"digit",value:e.retailPrice}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[e._v("包装含量")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{placeholder:"包装含量",name:"packageContent",value:e.packageContent}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[e._v("包装单位")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{placeholder:"包装单位",name:"packingUnit",value:e.packingUnit}})],1)],1)],1),e._l(e.stocks,function(t,n){return e.stocks.length>0?i("v-uni-view",{key:n,staticClass:"frist1"},[i("v-uni-view",{staticStyle:{"line-height":"70rpx"}},[i("v-uni-view",{staticClass:"display_flex_bet"},[i("v-uni-view",{staticClass:"input_item",staticStyle:{width:"100%"}},[i("v-uni-view",{staticClass:"left_item"},[e._v("初始库存")]),i("v-uni-input",{attrs:{placeholder:"初始库存",type:"digit",name:"reserve",value:t.reserve},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.change_reserve(t,n)}}})],1)],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[e._v("预警库存")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{placeholder:"预警库存",name:"warning_num",type:"digit",value:t.warning_num},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.change_warningnum(t,n)}}})],1)],1),i("v-uni-view",{staticClass:"input_item2"},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",{staticClass:"left_item"},[e._v("仓库")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{placeholder:"选择仓库",value:t.stock.stock_name,disabled:"true"}})],1)],1),i("v-uni-view",{staticStyle:{color:"#2ca879","font-weight":"bold"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.remove_stock(n)}}},[e._v("移除")])],1)],1):e._e()}),i("v-uni-navigator",{staticClass:"input_item2 frist1",staticStyle:{"margin-bottom":"30rpx","justify-content":"center"},attrs:{"hover-class":"none",url:"/pages/manage/warehouse/warehouse?type=choose_more"}},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",{staticClass:"left_item",staticStyle:{color:"#2ca879"}},[e._v("选择仓库")]),i("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#2ca879"}})],1)],1),i("uni-collapse",{attrs:{accordion:!0}},[i("uni-collapse-item",{staticStyle:{color:"#FE104C","font-size":"32rpx","font-weight":"bold"},attrs:{title:"更多信息"}},[i("v-uni-view",{staticClass:"frist",staticStyle:{"margin-top":"0"}},[i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[e._v("有效期")]),i("v-uni-picker",{attrs:{mode:"date"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.bindDateChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"有效期",name:"nousetime",disabled:"true"},model:{value:e.nousetime,callback:function(t){e.nousetime=t},expression:"nousetime"}})],1)],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[e._v("生产厂家")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{placeholder:"生产厂家",name:"producer",value:e.producer}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[e._v("货号")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{placeholder:"货号",name:"regNumber",value:e.regNumber}})],1)],1),i("v-uni-view",{staticClass:"input_item2"},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",{staticClass:"left_item"},[e._v("条码")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{value:e.productCode,placeholder:"条码",name:"productCode"}})],1)],1),i("v-uni-view",[i("fa-icon",{attrs:{type:"clone",size:"16",color:"#426ab3"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.scan_code.apply(void 0,arguments)}}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[e._v("货架位置")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{placeholder:"货架位置",name:"position",value:e.position}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[e._v("产品简介")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-input",{attrs:{placeholder:"产品简介",name:"product_info",value:e.product_info}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[e._v("是否半成品")]),i("v-uni-view",{staticClass:"right_input1"},[i("v-uni-switch",{attrs:{checked:e.product_state,name:"product_state"}})],1)],1)],1)],1)],1)],2),i("v-uni-view",{staticClass:"display_flex_bet"},[i("v-uni-button",{staticClass:"submit_button",attrs:{formType:"submit"}},[e._v("保存")]),i("v-uni-button",{staticClass:"reset_button",attrs:{formType:"reset"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.stocks=""}}},[e._v("重置")])],1)],1)],1)},a=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a})},b4ab:function(e,t,i){"use strict";i.r(t);var n=i("72dd"),a=i("35fc");for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);i("d6b8");var r=i("f0c5"),s=Object(r["a"])(a["default"],n["a"],n["b"],!1,null,"7cac7d33",null);t["default"]=s.exports},bbd4:function(e,t,i){var n=i("3867");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("1a4996fd",n,!0,{sourceMap:!1,shadowMode:!1})},ce70:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{class:["uni-collapse-cell",{"uni-collapse-cell--disabled":e.disabled,"uni-collapse-cell--open":e.isOpen}],attrs:{"hover-class":e.disabled?"":"uni-collapse-cell--hover"}},[i("v-uni-view",{staticClass:"uni-collapse-cell__title",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onClick.apply(void 0,arguments)}}},[e.thumb?i("v-uni-view",{staticClass:"uni-collapse-cell__title-extra"},[i("v-uni-image",{staticClass:"uni-collapse-cell__title-img",attrs:{src:e.thumb}})],1):e._e(),i("v-uni-view",{staticClass:"uni-collapse-cell__title-inner"},[i("v-uni-view",{staticClass:"uni-collapse-cell__title-text"},[e._v(e._s(e.title))])],1),i("v-uni-view",{staticClass:"uni-collapse-cell__title-arrow",class:{"uni-active":e.isOpen,"uni-collapse-cell--animation":!0===e.showAnimation}},[i("uni-icon",{attrs:{color:"#bbb",size:"20",type:"arrowdown"}})],1)],1),i("v-uni-view",{staticClass:"uni-collapse-cell__content",class:{"uni-collapse-cell--animation":!0===e.showAnimation},style:{height:e.isOpen?"auto":"0px"}},[i("v-uni-view",{attrs:{id:e.elId}},[e._t("default")],2)],1)],1)},a=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a})},d5e2:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("ac6a");var n={name:"UniCollapse",props:{accordion:{type:Boolean,default:!1}},data:function(){return{}},provide:function(){return{collapse:this}},created:function(){this.childrens=[]},methods:{onChange:function(){var e=[];this.childrens.forEach(function(t,i){t.isOpen&&e.push(t.nameSync)}),this.$emit("change",e)}}};t.default=n},d6b8:function(e,t,i){"use strict";var n=i("a4db"),a=i.n(n);a.a},de3d:function(e,t,i){t=e.exports=i("2350")(!1),t.push([e.i,'.uni-collapse-cell[data-v-07b66df4]{position:relative}.uni-collapse-cell--hover[data-v-07b66df4]{background-color:#f1f1f1}.uni-collapse-cell--open[data-v-07b66df4]{background-color:#f1f1f1}.uni-collapse-cell--disabled[data-v-07b66df4]{opacity:.3}.uni-collapse-cell--animation[data-v-07b66df4]{-webkit-transition:all .3s;transition:all .3s}.uni-collapse-cell[data-v-07b66df4]:after{position:absolute;z-index:3;right:0;bottom:0;left:0;height:1px;content:"";-webkit-transform:scaleY(.5);transform:scaleY(.5);background-color:#c8c7cc}.uni-collapse-cell__title[data-v-07b66df4]{padding:%?12?% %?30?%;width:100%;box-sizing:border-box;-webkit-box-flex:1;-webkit-flex:1;flex:1;position:relative;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.uni-collapse-cell__title-extra[data-v-07b66df4]{margin-right:%?18?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.uni-collapse-cell__title-img[data-v-07b66df4]{height:%?52?%;width:%?52?%}.uni-collapse-cell__title-arrow[data-v-07b66df4]{width:20px;height:20px;-webkit-transform:rotate(0);transform:rotate(0);-webkit-transform-origin:center center;transform-origin:center center}.uni-collapse-cell__title-arrow.uni-active[data-v-07b66df4]{-webkit-transform:rotate(-180deg);transform:rotate(-180deg)}.uni-collapse-cell__title-inner[data-v-07b66df4]{-webkit-box-flex:1;-webkit-flex:1;flex:1;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.uni-collapse-cell__title-text[data-v-07b66df4]{font-size:%?24?%;text-overflow:ellipsis;white-space:nowrap;color:inherit;line-height:1.5;overflow:hidden}.uni-collapse-cell__content[data-v-07b66df4]{position:relative;width:100%;overflow:hidden;background:#fff}.uni-collapse-cell__content uni-view[data-v-07b66df4]{font-size:%?28?%}',""])},dffb:function(e,t,i){"use strict";(function(e){var n=i("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("c5f6"),i("3b2b"),i("a481"),i("7514");var a,o,r=n(i("5d73")),s=n(i("4d52")),l=n(i("b4ab")),c=n(i("7c20")),u=n(i("7fd5")),d=n(i("9546")),f="",v="",g={components:{uniCollapse:l.default,uniCollapseItem:c.default,faIcon:s.default},data:function(){return{goodsName:"",costPrice:"",retailPrice:"",packageContent:"",packingUnit:"",warning_num:"",producer:"",regNumber:"",position:"",product_info:"",productCode:"",category:"",goodsIcon:"",stocks:[],producttime:"",nousetime:"",product_state:!1}},onLoad:function(e){a=this,o=uni.getStorageSync("uid"),uni.removeStorageSync("category"),uni.removeStorageSync("warehouse"),uni.removeStorageSync("is_add")},onShow:function(){if(uni.getStorageSync("warehouse")&&(a.stocks=uni.getStorageSync("warehouse")),uni.getStorageSync("category"))if(a.category=uni.getStorageSync("category"),2==a.category.type){var t=d.default.Pointer("class_user");f=t.set(a.category.parent.objectId);var i=d.default.Pointer("second_class");v=i.set(a.category.objectId),e.log(a.category.parent.objectId,a.category.objectId)}else{var n=d.default.Pointer("class_user");f=n.set(a.category.objectId)}},onUnload:function(){"",f="",v="",u.default.handleData()},methods:{upload_image:function(){uni.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){e.log(t);var i,n=Date.parse(new Date),o=t.tempFilePaths,s=!0,l=!1,c=void 0;try{for(var u,f=(0,r.default)(o);!(s=(u=f.next()).done);s=!0){var v=u.value;i=d.default.File(n+".jpg",v)}}catch(g){l=!0,c=g}finally{try{s||null==f.return||f.return()}finally{if(l)throw c}}i.save().then(function(e){a.goodsIcon=e[0].url})}})},change_reserve:function(e,t){a.stocks[t].reserve=e.detail.value,uni.setStorageSync("warehouse",a.stocks)},change_warningnum:function(e,t){a.stocks[t].warning_num=e.detail.value,uni.setStorageSync("warehouse",a.stocks)},remove_stock:function(e){a.stocks.splice(e,1),uni.setStorageSync("warehouse",a.stocks)},bindDateChange:function(e){a.nousetime=e.target.value},formSubmit:function(t){e.log(t.detail.value);var i=t.detail.value;""==i.goodsName?uni.showToast({title:"请输入产品名称",icon:"none"}):a.upload_good(i)},upload_good:function(e){uni.showLoading({title:"上传中..."});var t=d.default.Query("Goods");t.equalTo("userId","==",o),t.equalTo("status","!=",-1),t.equalTo("goodsName","==",e.goodsName),t.find().then(function(t){t.length>=1?uni.showToast({title:"你的库存中已存在此产品",icon:"none"}):a.add_good(e,"add")})},add_good:function(t,i){var n=d.default.Pointer("_User"),r=n.set(o),s=function(i){var n=a.stocks[i].stock.objectId,o=d.default.Pointer("stocks"),s=o.set(n),l=d.default.Query("Goods");if(l.set("goodsIcon",a.goodsIcon),l.set("goodsName",t.goodsName),l.set("costPrice",t.costPrice?t.costPrice:"0"),l.set("retailPrice",t.retailPrice?t.retailPrice:"0"),a.nousetime){var c=a.nousetime.replace(new RegExp("-","g"),"/");c=new Date(c).getTime(),l.set("nousetime",c)}l.set("regNumber",t.regNumber),l.set("reserve",Number(a.stocks[i].reserve)),l.set("productCode",t.productCode),l.set("stocks",s),l.set("product_info",t.product_info),l.set("producer",t.producer),l.set("packingUnit",t.packingUnit),l.set("packageContent",t.packageContent),l.set("position",t.position),l.set("warning_num",Number(a.stocks[i].warning_num)),l.set("stocktype",Number(a.stocks[i].warning_num)>=Number(a.stocks[i].reserve)?0:1),l.set("order",Number(i)),i>0&&l.set("accessory",!0),l.set("product_state",t.product_state),uni.getStorageSync("category")&&(1==a.category.type?l.set("goodsClass",f):l.set("second_class",v)),l.set("userId",r),l.set("id",uni.getStorageSync("now_product")?uni.getStorageSync("now_product").objectId:""),l.save().then(function(e){uni.hideLoading(),i==a.stocks.length-1&&u.default.log(uni.getStorageSync("user").nickName+"增加了产品'"+t.goodsName+"'",6,e.objectId),uni.setStorageSync("is_add",!0),uni.showToast({title:"上传成功"})}).catch(function(t){e.log(t)})};for(var l in a.stocks)s(l)},handledata:function(){a.goodsName="",a.costPrice="",a.retailPrice="",a.packageContent="",a.packingUnit="",a.warning_num="",a.producer="",a.regNumber="",a.position="",a.product_info="",a.productCode="",a.category="",a.reserve=0,a.goodsIcon="",a.stocks="",a.stock_name="",a.producttime="",a.nousetime=""}}};t.default=g}).call(this,i("5a52")["default"])},efe7:function(e,t,i){"use strict";var n=i("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("ac6a"),i("6b54"),i("c5f6");var a=n(i("3628")),o={name:"UniCollapseItem",components:{uniIcon:a.default},props:{title:{type:String,default:""},name:{type:[Number,String],default:0},disabled:{type:Boolean,default:!1},showAnimation:{type:Boolean,default:!1},open:{type:Boolean,default:!1},thumb:{type:String,default:""}},data:function(){var e=this.__call_hook?"uni_collapse_item":"Uni_".concat(Math.ceil(1e6*Math.random()).toString(36));return{isOpen:!1,height:"auto",elId:e}},watch:{open:function(e){this.isOpen=e}},inject:["collapse"],created:function(){if(this.isOpen=this.open,this.nameSync=this.name?this.name:this.collapse.childrens.length,this.collapse.childrens.push(this),this.collapse.accordion&&this.isOpen){var e=this.collapse.childrens[this.collapse.childrens.length-2];e&&(this.collapse.childrens[this.collapse.childrens.length-2].isOpen=!1)}},mounted:function(){this.getSize()},methods:{getSize:function(){var e=this;this.showAnimation&&uni.createSelectorQuery().in(this).select("#".concat(this.elId)).boundingClientRect().exec(function(t){e.height=t[0].height+"px"})},onClick:function(){var e=this;this.disabled||(this.collapse.accordion&&this.collapse.childrens.forEach(function(t){t!==e&&(t.isOpen=!1)}),this.isOpen=!this.isOpen,this.collapse.onChange&&this.collapse.onChange())}}};t.default=o},f12f:function(e,t,i){"use strict";var n=i("5b26"),a=i.n(n);a.a},f9c7:function(e,t,i){"use strict";i.r(t);var n=i("efe7"),a=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,function(){return n[e]})}(o);t["default"]=a.a}}]);