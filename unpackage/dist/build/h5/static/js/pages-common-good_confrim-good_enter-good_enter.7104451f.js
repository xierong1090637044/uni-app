(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-common-good_confrim-good_enter-good_enter"],{"39bb":function(e,t,o){"use strict";(function(e){var n=o("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(o("795b"));o("6b54"),o("87b3");var a=n(o("5d73"));o("7f7f"),o("c5f6");var i,s,u,c,l=n(o("c74b")),d=n(o("df06")),f=n(o("428b")),p=n(o("da3f")),g=n(o("b410")),v={data:function(){return{user:uni.getStorageSync("user"),identity:uni.getStorageSync("identity"),othercurrent:"",Images:[],stock:"",shop_name:"",products:null,button_disabled:!1,beizhu_text:"",real_money:0,all_money:0,really_total_money:0,producer:null,outType:"",pickerTypes:[{desc:"自提",type:1},{desc:"快递",type:2},{desc:"物流",type:3},{desc:"送货上门",type:4}],expressNum:"",total_num:0}},onLoad:function(){s=this,i=uni.getStorageSync("uid"),this.products=uni.getStorageSync("products");for(var e=0;e<this.products.length;e++)this.all_money=Number((this.products[e].total_money+this.all_money).toFixed(2)),this.really_total_money=Number((this.products[e].really_total_money+this.really_total_money).toFixed(2)),this.total_num+=Number(this.products[e].num);this.real_money=Number(this.all_money.toFixed(2)),s.user.rights&&s.user.rights.othercurrent&&(s.othercurrent=s.user.rights.othercurrent)},onShow:function(){if(s.producer=uni.getStorageSync("producer"),c=uni.getStorageSync("shop"),c){s.shop_name=c.name;var e=l.default.Pointer("shops");u=e.set(c.objectId)}s.stock=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:""},methods:{scan_code:function(){this.$wechat.scanQRCode().then(function(e){s.expressNum=e.result})},removeImg:function(e){s.Images.splice(e,1),s.Images=s.Images},upload_image:function(){s.user.is_vip?uni.chooseImage({count:3,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){var t,o=Date.parse(new Date),n=e.tempFilePaths,r=!0,i=!1,u=void 0;try{for(var c,d=(0,a.default)(n);!(r=(c=d.next()).done);r=!0){var f=c.value;t=l.default.File(o+".jpg",f)}}catch(p){i=!0,u=p}finally{try{r||null==d.return||d.return()}finally{if(i)throw u}}t.save().then(function(e){var t=!0,o=!1,n=void 0;try{for(var r,i=(0,a.default)(e);!(t=(r=i.next()).done);t=!0){var u=r.value;s.Images.push(u.url)}}catch(p){o=!0,n=p}finally{try{t||null==i.return||i.return()}finally{if(o)throw n}}})}}):uni.showToast({title:"您还不是会员，无法使用",icon:"none"})},select_outType:function(e){s.outType=s.pickerTypes[e.detail.value],2==s.outType.type&&3==s.outType.type||(s.expressNum="")},formSubmit:function(t){var o=uni.getStorageSync("identity");this.button_disabled=!0;var n=t.detail.formId,r=2;uni.showLoading({title:"上传中..."});for(var v=l.default.Pointer("stocks"),m=v.set(s.stock?s.stock.objectId:""),y=new Array,h=[],_=0;_<this.products.length;_++){var b=Number(this.products[_].reserve)+this.products[_].num,w={},S=l.default.Query("Bills"),k=l.default.Pointer("_User"),x=k.set(i),N=l.default.Pointer("Goods"),B=N.set(this.products[_].objectId),R=uni.getStorageSync("masterId"),I=l.default.Pointer("_User"),C=I.set(R);S.set("goodsName",this.products[_].goodsName),S.set("retailPrice",this.products[_].modify_retailPrice.toString()),S.set("num",Number(this.products[_].num)),S.set("total_money",this.products[_].total_money),S.set("really_total_money",this.products[_].really_total_money),S.set("goodsId",B),S.set("userId",x),S.set("opreater",C),S.set("type",1),S.set("extra_type",r),c&&S.set("shop",u),S.set("stock",m),1==o?S.set("status",!0):2==o&&S.set("status",2==r);var T={};w.goodsName=this.products[_].goodsName,w.modify_retailPrice=this.products[_].modify_retailPrice.toString(),w.retailPrice=this.products[_].retailPrice,w.total_money=this.products[_].total_money,T.costPrice=this.products[_].costPrice,T.retailPrice=this.products[_].retailPrice,T.objectId=this.products[_].objectId,T.reserve=b,this.products[_].selectd_model&&(T.selected_model=this.products[_].selected_model,T.models=this.products[_].models),w.goodsId=T,w.num=this.products[_].num,w.type=1,y.push(S),h.push(w)}l.default.Query("Bills").saveAll(y).then(function(u){for(var c=[],v=0;v<u.length;v++)c.push(u[v].success.objectId);var y=l.default.Pointer("_User"),_=y.set(i),b=uni.getStorageSync("masterId"),w=l.default.Pointer("_User"),S=w.set(b),k=l.default.Query("order_opreations");if(k.set("beizhu",t.detail.value.input_beizhu),k.set("detail",h),k.set("real_num",s.total_num),k.set("type",1),k.set("extra_type",r),k.set("bills",c),k.set("opreater",S),k.set("master",_),k.set("stock",m),k.set("goodsName",s.products[0].goodsName),k.set("real_money",Number(s.real_money)),k.set("debt",s.all_money-Number(s.real_money)),s.producer){var x=l.default.Pointer("producers"),N=x.set(s.producer.objectId);if(k.set("producer",N),s.all_money-Number(s.real_money)>0){var B=l.default.Query("producers");B.get(s.producer.objectId).then(function(e){var t=null==e.debt?0:e.debt;t+=s.all_money-Number(s.real_money);var o=l.default.Query("producers");o.get(s.producer.objectId).then(function(e){e.set("debt",t),e.save()})})}}s.outType&&(k.set("typeDesc",s.outType.desc),k.set("expressNum",s.expressNum)),k.set("all_money",s.all_money),k.set("Images",s.Images),1==o?k.set("status",!0):2==o&&k.set("status",2==r),k.save().then(function(i){var u=i.objectId;uni.hideLoading(),2==r?uni.showToast({title:"产品入库成功",icon:"success",duration:1e3,complete:function(){d.default.enterAddGoodNum(s.products).then(function(o){setTimeout(function(){d.default.log(uni.getStorageSync("user").nickName+"入库了'"+s.products[0].goodsName+"'等"+s.products.length+"商品",1,u);var e={frist:uni.getStorageSync("user").nickName+"入库了'"+s.products[0].goodsName+"'等"+s.products.length+"商品",data1:i.createdAt,data2:s.stock?s.stock.stock_name:"未填写",remark:t.detail.value.input_beizhu?t.detail.value.input_beizhu:"未填写",url:"https://www.jimuzhou.com/h5/pages/report/EnteringHistory/detail/detail?id="+u};p.default.send_in(e);var o={keyword1:{value:s.products[0].goodsName+"'等",color:"#173177"},keyword2:{value:t.detail.value.input_beizhu?t.detail.value.input_beizhu:"未填写"},keyword3:{value:i.createdAt},keyword4:{value:uni.getStorageSync("user").nickName}};o.form_Id=n,o.id=u,p.default.send_in_mini(o),uni.getStorageSync("setting").auto_print&&g.default.autoPrint(u)},500),s.can_addGoods().then(function(t){if(t){var o=uni.getStorageSync("products"),n=uni.getStorageSync("warehouse"),r=!0,i=!1,u=void 0;try{for(var c,l=(0,a.default)(o);!(r=(c=l.next()).done);r=!0){var d=c.value;d.reserve=d.num,f.default.upload_good_withNoCan(d,n[0].stock).then(function(t){e.log(t),t[0]?uni.showToast({title:"添加成功",icon:"none"}):uni.showToast({title:t[1],icon:"none"})})}}catch(p){i=!0,u=p}finally{try{r||null==l.return||l.return()}finally{if(i)throw u}}s.button_disabled=!1,uni.setStorageSync("is_option",!0),uni.removeStorageSync("warehouse"),uni.removeStorageSync("_warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("category"),setTimeout(function(){uni.navigateBack({delta:2})},1e3)}else s.button_disabled=!1,uni.setStorageSync("is_option",!0),uni.removeStorageSync("warehouse"),uni.removeStorageSync("_warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("category"),setTimeout(function(){uni.navigateBack({delta:2})},1e3)})})}}):1==r&&uni.showToast({title:"产品采购成功",icon:"success",duration:1e3,complete:function(){1==o?d.default.enterAddGoodNum(s.products).then(function(e){setTimeout(function(){d.default.log(uni.getStorageSync("user").nickName+"销售了'"+s.products[0].goodsName+"'等"+s.products.length+"商品",1,u),s.button_disabled=!1,uni.setStorageSync("is_option",!0),uni.removeStorageSync("_warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("category"),uni.removeStorageSync("warehouse"),setTimeout(function(){uni.navigateBack({delta:2})},500)},500)}):setTimeout(function(){d.default.log(uni.getStorageSync("user").nickName+"采购了'"+s.products[0].goodsName+"'等"+s.products.length+"商品",1,u);var e={frist:uni.getStorageSync("user").nickName+"采购了'"+s.products[0].goodsName+"'等"+s.products.length+"商品",data1:u,data2:uni.getStorageSync("user").nickName,data3:"未审核",data4:i.createdAt,remark:t.detail.value.input_beizhu?t.detail.value.input_beizhu:"未填写",url:"https://www.jimuzhou.com/h5/pages/report/EnteringHistory/detail/detail?id="+u};p.default.send_in_noconfrim(e),s.button_disabled=!1,uni.setStorageSync("is_option",!0),uni.removeStorageSync("_warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("category"),uni.removeStorageSync("warehouse"),setTimeout(function(){uni.navigateBack({delta:2})},500)},500)}})})},function(t){e.log("异常处理")})},can_addGoods:function(){return new r.default(function(t,o){var n=uni.getStorageSync("products"),r=uni.getStorageSync("warehouse");if(r){var i=!0,s=!1,u=void 0;try{for(var c,l=(0,a.default)(n);!(i=(c=l.next()).done);i=!0){var d=c.value;""==d.stocks.stock_name||void 0==d.stocks.stock_name||d.stocks.stock_name!=r[0].stock.stock_name?uni.showModal({title:"'"+d.goodsName+"'没有关联到调出仓库",content:"是否将它关联到此仓库",showCancel:!0,success:function(o){e.log(o),o.confirm&&t(!0)},fail:function(){},complete:function(){t(!1)}}):t(!1)}}catch(f){s=!0,u=f}finally{try{i||null==l.return||l.return()}finally{if(s)throw u}}}else t(!1)})}}};t.default=v}).call(this,o("5a52")["default"])},4079:function(e,t,o){"use strict";o.r(t);var n=o("39bb"),r=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,function(){return n[e]})}(a);t["default"]=r.a},"428b":function(e,t,o){"use strict";(function(e){var n=o("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(o("f499"));o("c5f6"),o("7514");var a=n(o("5d73")),i=n(o("795b")),s=n(o("c74b")),u={delete_goods:function(t){return new i.default(function(o,n){var r=0,i=!0,u=!1,c=void 0;try{for(var l,d=(0,a.default)(t);!(i=(l=d.next()).done);i=!0){var f=l.value,p=s.default.Query("Goods");p.destroy(f.objectId).then(function(e){r+=1,r==t.length&&o(!0)}).catch(function(t){e.log(t)})}}catch(g){u=!0,c=g}finally{try{i||null==d.return||d.return()}finally{if(u)throw c}}})},upload_good_withNoCan:function(t,o){return new i.default(function(n,r){var a=uni.getStorageSync("uid"),i=s.default.Pointer("_User"),u=i.set(a),c=t.reserve,l=s.default.Pointer("stocks"),d=l.set(o.objectId),f=s.default.Query("Goods");f.equalTo("userId","==",a),f.equalTo("goodsName","==",t.goodsName),f.equalTo("stocks","==",o.objectId),f.find().then(function(o){if(e.log(o),o.length>=1)n([!1,"该商品存在此仓库中"]);else{var r=s.default.Query("Goods");if(r.set("goodsName",t.goodsName),r.set("goodsIcon",t.goodsIcon),r.set("costPrice",t.costPrice),r.set("retailPrice",t.retailPrice),r.set("reserve",Number(t.reserve)),r.set("productCode",t.productCode?t.productCode:""),r.set("stocks",d),r.set("product_info",t.product_info?t.product_info:""),r.set("producer",t.producer?t.producer:""),r.set("packingUnit",t.packingUnit?t.packingUnit:""),r.set("packageContent",t.packageContent?t.packageContent:""),r.set("warning_num",Number(t.warning_num?t.warning_num:0)),r.set("stocktype",Number(t.warning_num?t.warning_num:0)>=Number(c)?0:1),t.second_class){var a=s.default.Pointer("class_user"),i=a.set(t.goodsClass);r.set("second_class",f);var l=s.default.Pointer("second_class"),f=l.set(t.second_class);r.set("goodsClass",i)}r.set("userId",u),r.save().then(function(t){e.log(t),n([!0,t])}).catch(function(t){e.log(t)})}})})},upload_good:function(t){return new i.default(function(o,n){var r=JSON.parse(localStorage.getItem("bmob")).objectId,a=s.default.Pointer("_User"),i=a.set(r),u=s.default.Pointer("class_user"),c=u.set(t.goodsClass),l=s.default.Pointer("second_class"),d=l.set(t.second_class),f=s.default.Query("Goods");f.equalTo("userId","==",r),f.equalTo("goodsName","==",t.goodsName),f.equalTo("position","==",t.position),f.equalTo("stocks","==",t.stocks),f.find().then(function(n){if(e.log(n),n.length>=1)o([!1,n]);else{var r=t.reserve,a=s.default.Pointer("stocks"),u=a.set(t.stocks),l=s.default.Query("Goods");l.set("goodsName",t.goodsName),l.set("goodsIcon",t.goodsIcon),l.set("costPrice",t.costPrice),l.set("retailPrice",t.retailPrice),l.set("producttime",t.producttime),l.set("nousetime",t.nousetime),l.set("regNumber",t.regNumber),l.set("reserve",Number(t.reserve)),l.set("productCode",t.productCode),l.set("stocks",u),l.set("product_info",t.product_info),l.set("producer",t.producer),l.set("packingUnit",t.packingUnit),l.set("packageContent",t.packageContent),l.set("warning_num",Number(t.warning_num)),l.set("stocktype",Number(t.warning_num)>=Number(r)?0:1),l.set("second_class",d),l.set("goodsClass",c),l.set("userId",i),l.save().then(function(t){e.log(t),o([!0,t])}).catch(function(t){e.log(t)})}})})},get_fristclass:function(){var e=JSON.parse(localStorage.getItem("bmob")).objectId;return new i.default(function(t,o){var n=s.default.Query("class_user");n.equalTo("parent","==",e),n.find().then(function(e){localStorage.setItem("frist_class",(0,r.default)(e)),t(e)})})},get_secondclass:function(e){return new i.default(function(t,o){var n=s.default.Query("class_user");n.field("second",e),n.relation("second_class").then(function(e){t(e.results)})})},getstock_list:function(e){var t=JSON.parse(localStorage.getItem("bmob")).objectId;return new i.default(function(o,n){var a=s.default.Query("stocks");a.order("-num"),a.include("charge","shop"),a.equalTo("parent","==",t),e&&a.equalTo("stock_name","==",{$regex:e+".*"}),a.find().then(function(e){localStorage.setItem("stocks",(0,r.default)(e)),o(e)})})}};t.default=u}).call(this,o("5a52")["default"])},b142:function(e,t,o){"use strict";o.r(t);var n=o("f475"),r=o("4079");for(var a in r)"default"!==a&&function(e){o.d(t,e,function(){return r[e]})}(a);o("bc31");var i=o("2877"),s=Object(i["a"])(r["default"],n["a"],n["b"],!1,null,"48bcd945",null);t["default"]=s.exports},b410:function(e,t,o){"use strict";(function(e){var n=o("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(o("5d73")),a=n(o("c74b")),i={autoPrint:function(t){var o=this;e.log("sssss",t);var n=a.default.Query("order_opreations");n.include("opreater","custom","producer","stock"),n.get(t).then(function(t){e.log(t),o.print_operations(t,t.detail)})},print_goodDet:function(e){var t,o=uni.getStorageSync("now_product");o.objectId=e.good_id,o.stocks=e,o.productCode=e.productCode,t="<CB>商品信息</CB><BR>",t+="--------------------------------<BR>",t+="产品名称：　　 "+o.goodsName+"<BR>",o.stocks&&(t+="存放仓库：　　 "+o.stocks.stock_name+"<BR>"),o.position&&(t+="货架位置：　　 "+o.position+"<BR>"),o.producttime&&(t+="生产日期：　　 "+o.producttime+"<BR>"),o.nousetime&&(t+="失效日期：　　 "+o.nousetime+"<BR>"),t+="当前库存：　　 "+o.reserve+"<BR>",t+="产品规格:　　　"+o.packageContent+"*"+o.packingUnit+"<BR>",t+="进货价格:      "+o.costPrice+"<BR>",t+="零售价格:      "+o.retailPrice+"<BR>",o.bad_num&&(t+="货损数量:      "+o.bad_num+"<BR>"),t+="--------------------------------<BR>",t+="产品二维码：<BR>",t+="<QR>"+o.productCode+"</QR>",this.print_by_code(t)},print_operations:function(t,o){if(e.log(t),3==t.type){p="<CB>盘点单</CB><BR>",p+="--------------------------------<BR>";for(var n=0;n<o.length;n++)p+="产品名称："+o[n].goodsName+"<BR>",p+="盘点前库存："+o[n].reserve+"<BR>",p+="盘点后库存："+o[n].now_reserve+"<BR>",p+="--------------------------------<BR>"}else if(-2==t.type){p="<CB>调拨单</CB><BR>",p+="--------------------------------<BR>";for(var a=0;a<o.length;a++){p+="产品名称："+o[a].goodsName+"<BR>",p+="调拨数量："+o[a].num+"<BR>",p+="--------------------------------<BR>";var i=!0,s=!1,u=void 0;try{for(var c,l=(0,r.default)(t.detail);!(i=(c=l.next()).done);i=!0){var d=c.value;p+="调出仓库："+d.stock+"<BR>",p+="<RIGHT>当前库存："+(d.reserve-d.num)+"</RIGHT><BR>",p+="调入仓库："+d.out_stock+"<BR>",p+="<RIGHT>当前库存："+(d.out_reserve+d.num)+"</RIGHT><BR>"}}catch(v){s=!0,u=v}finally{try{i||null==l.return||l.return()}finally{if(s)throw u}}}p+="--------------------------------<BR>"}else if(2==t.type){p="<CB>退货单</CB><BR>",p+="--------------------------------<BR>";for(var f=0;f<o.length;f++)p+="产品名称："+o[f].goodsName+"<BR>",p+="零售价："+o[f].retailPrice+"<BR>",p+="数量    ：X"+o[f].num+"<BR>",p+="<RIGHT>总计："+o[f].total_money+"</RIGHT>",p+="--------------------------------<BR>",p+="退货明细：<BR>",null!=t.custom?p+="客户姓名："+t.custom.custom_name+"<BR>":p+="未记录客户 <BR>";p+="<BOLD><RIGHT>全部总计："+t.all_money+"</RIGHT></BOLD>",p+="--------------------------------<BR>"}else{var p;p=1==t.type?"<CB>入库单</CB><BR>":"<CB>出库单</CB><BR>",p+="--------------------------------<BR>";for(var g=0;g<o.length;g++)p+="产品名称："+o[g].goodsName+"<BR>",p+="实际单价："+o[g].retailPrice+"<BR>",p+="数量    ：X"+o[g].num+"<BR>",p+="<RIGHT>总计："+o[g].total_money+"</RIGHT>",p+="--------------------------------<BR>";p+="<BOLD><RIGHT>全部总计："+t.all_money+"</RIGHT></BOLD>",p+="--------------------------------<BR>",1==t.type&&(p+="开单明细：<BR>",p+="<BR>",null!=t.producer&&(p+="供货商姓名："+t.producer.producer_name+"<BR>"),null==t.real_money?p+="实际收款：未填写 <BR>":p+="实际收款："+t.real_money+"<BR>",t.debt>0&&(p+="本次欠款："+t.debt+"<BR>"),p+="--------------------------------<BR>"),-1==t.type&&(p+="开单明细：<BR>",p+="<BR>",t.custom&&(p+="客户姓名："+t.custom.custom_name+"<BR>"),t.real_money?p+="实际收款：未填写 <BR>":p+="实际收款："+t.real_money+"<BR>",t.debt>0&&(p+="本次欠款  ："+t.debt+"<BR>"),p+="--------------------------------<BR>")}p+="操作者："+t.opreater.nickName+"<BR>",p+="备注："+t.beizhu+"<BR>",p+="操作时间："+t.createdAt+"<BR>",this.print_by_code(p)},print_by_code:function(t){var o=uni.getStorageSync("setting").USER,n=uni.getStorageSync("setting").UKEY,r=uni.getStorageSync("setting").number,a="api.feieyun.cn",i="/Api/Open/",s=(new Date).getTime(),u=l(o+n+s);h(r,t,1);var c=0;function l(e){return y(d(m(e)))}function d(e){for(var t=e,o=Array(80),n=1732584193,r=-271733879,a=-1732584194,i=271733878,s=-1009589776,u=0;u<t.length;u+=16){for(var c=n,l=r,d=a,m=i,y=s,h=0;h<80;h++){o[h]=h<16?t[u+h]:v(o[h-3]^o[h-8]^o[h-14]^o[h-16],1);var _=g(g(v(n,5),f(h,r,a,i)),g(g(s,o[h]),p(h)));s=i,i=a,a=v(r,30),r=n,n=_}n=g(n,c),r=g(r,l),a=g(a,d),i=g(i,m),s=g(s,y)}return new Array(n,r,a,i,s)}function f(e,t,o,n){return e<20?t&o|~t&n:e<40?t^o^n:e<60?t&o|t&n|o&n:t^o^n}function p(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function g(e,t){var o=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(o>>16);return n<<16|65535&o}function v(e,t){return e<<t|e>>>32-t}function m(e){for(var t=1+(e.length+8>>6),o=new Array(16*t),n=0;n<16*t;n++)o[n]=0;for(n=0;n<e.length;n++)o[n>>2]|=e.charCodeAt(n)<<24-8*(3&n);return o[n>>2]|=128<<24-8*(3&n),o[16*t-1]=8*e.length,o}function y(e){for(var t=c?"0123456789ABCDEF":"0123456789abcdef",o="",n=0;n<4*e.length;n++)o+=t.charAt(e[n>>2]>>8*(3-n%4)+4&15)+t.charAt(e[n>>2]>>8*(3-n%4)&15);return o}function h(t,n,r){uni.request({url:"https://"+a+i,data:{user:o,stime:s,sig:u,apiname:"Open_printMsg",sn:t,content:n,times:r},method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t.data),0!=t.data.ret?uni.showToast({icon:"none",title:t.data.msg}):uni.showToast({icon:"none",title:"打印成功"})}})}}};t.default=i}).call(this,o("5a52")["default"])},bc31:function(e,t,o){"use strict";var n=o("ce1e"),r=o.n(n);r.a},ccc1:function(e,t,o){t=e.exports=o("2350")(!1),t.push([e.i,".page[data-v-48bcd945]{color:#4d4d4d;font-size:%?28?%;height:calc(100vh - %?90?%);overflow:scroll}.bottomEle[data-v-48bcd945]{position:fixed;bottom:0;left:0;width:calc(100% - %?30?%);background:#fafafa;padding:%?20?% %?0?% %?20?% %?30?%}.pro_list[data-v-48bcd945]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between}.pro_listitem[data-v-48bcd945]{background-color:#fff;padding:%?10?% %?20?%;border-bottom:%?1?% solid#ddd}.pro_allmoney[data-v-48bcd945]{background-color:#fff;padding:%?10?% %?20?%;text-align:right;font-size:%?32?%;color:#f30}.beizhu_style[data-v-48bcd945]{width:calc(100% - %?40?%);background-color:#fff;padding:%?20?%;font-size:%?32?%;max-height:%?100?%}.confrim_button[data-v-48bcd945]{background:#1651aa;color:#fff;font-weight:700;font-size:%?32?%;border-radius:unset;padding:0 %?50?%}",""])},ce1e:function(e,t,o){var n=o("ccc1");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var r=o("4f06").default;r("187ef6f5",n,!0,{sourceMap:!1,shadowMode:!1})},da3f:function(e,t,o){"use strict";(function(e){var n=o("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(o("c74b")),a={send_in:function(t){var o=uni.getStorageSync("setting").wx_openid;uni.request({url:"https://www.jimuzhou.com/api/send_temp.php",method:"POST",data:{openid:o,frist:t.frist,data1:t.data1,data2:t.data2,remark:t.remark,url:t.url,type:"in"},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t)}})},send_in_noconfrim:function(t){var o=uni.getStorageSync("setting").wx_openid;uni.request({url:"https://www.jimuzhou.com/api/send_temp.php",method:"POST",data:{openid:o,frist:t.frist,data1:t.data1,data2:t.data2,data3:t.data3,data4:t.data4,remark:t.remark,url:t.url,type:"in_noconfrim"},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t)}})},send_in_mini:function(t){var o={touser:uni.getStorageSync("openid"),template_id:"nqZl9FWDofCo9cxU4de45grLKh2GU-PJcAvWSbJMy9k",page:"/pages/report/EnteringHistory/detail/detail?id="+t.id,form_id:t.form_Id,data:t,emphasis_keyword:""};r.default.sendWeAppMessage(o).then(function(t){e.log(t)}).catch(function(t){e.log(t)})},send_out_mini:function(t){var o={touser:uni.getStorageSync("openid"),template_id:"z0Km0FFiuvnNiUcXtZD046j43ue5_AxR05cDHFLLXPY",page:"/pages/report/EnteringHistory/detail/detail?id="+t.id,form_id:t.form_Id,data:t,emphasis_keyword:""};r.default.sendWeAppMessage(o).then(function(t){e.log(t)}).catch(function(t){e.log(t)})},send_temp:function(t){var o=uni.getStorageSync("setting").wx_openid;uni.request({url:"https://www.jimuzhou.com/api/send_temp.php",method:"POST",data:{openid:o,data1:t.data1,data2:t.data2,data3:t.data3,data4:t.data4,remark:"备注:"+t.remark,url:t.url,type:"out"},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t)}})}};t.default=a}).call(this,o("5a52")["default"])},df06:function(e,t,o){"use strict";(function(t){var n=o("288e");o("6b54"),o("87b3"),o("7514");var r=n(o("5d73"));o("c5f6");var a=n(o("795b")),i=n(o("c74b"));e.exports={enterAddGoodNum:function(e){return new a.default(function(o,n){for(var a=function(n){var a=0,s=i.default.Query("Goods");s.get(e[n].objectId).then(function(i){if(t.log(e[n]),e[n].selectd_model){var s=!0,u=!1,c=void 0;try{for(var l,d=(0,r.default)(e[n].selected_model);!(s=(l=d.next()).done);s=!0){var f=l.value,p=!0,g=!1,v=void 0;try{for(var m,y=(0,r.default)(e[n].models);!(p=(m=y.next()).done);p=!0){var h=m.value;h.id==f.id&&(h.reserve=Number(h.reserve)+Number(f.num)),delete h.num}}catch(_){g=!0,v=_}finally{try{p||null==y.return||y.return()}finally{if(g)throw v}}}}catch(_){u=!0,c=_}finally{try{s||null==d.return||d.return()}finally{if(u)throw c}}a=Number(e[n].reserve)+Number(e[n].num),i.set("models",e[n].models)}else a=Number(e[n].reserve)+Number(e[n].num);i.set("reserve",a),i.set("stocktype",a>e[n].warning_num?1:0),i.save(),n==e.length-1&&o(!0)}).catch(function(e){t.log(e)})},s=0;s<e.length;s++)a(s)})},outRedGoodNum:function(e){var o=this;return new a.default(function(n,a){for(var s=function(a){var s=0,u=i.default.Query("Goods");u.get(e[a].objectId).then(function(t){if(e[a].selectd_model){var i=!0,u=!1,c=void 0;try{for(var l,d=(0,r.default)(e[a].selected_model);!(i=(l=d.next()).done);i=!0){var f=l.value,p=!0,g=!1,v=void 0;try{for(var m,y=(0,r.default)(e[a].models);!(p=(m=y.next()).done);p=!0){var h=m.value;s+=Number(h.reserve),h.id==f.id&&(h.reserve=Number(h.reserve)-Number(f.num)),delete h.num}}catch(_){g=!0,v=_}finally{try{p||null==y.return||y.return()}finally{if(g)throw v}}}}catch(_){u=!0,c=_}finally{try{i||null==d.return||d.return()}finally{if(u)throw c}}s=Number(e[a].reserve)-Number(e[a].num),t.set("models",e[a].models)}else s=Number(e[a].reserve)-Number(e[a].num);t.set("reserve",s),t.set("stocktype",s>=e[a].warning_num?1:0),t.save(),e[a].warning_num>=s&&o.log(e[a].goodsName+"出库了"+e[a].num+"件，已经低于预警数量"+e[a].warning_num,-2,e[a].objectId),o.record_staffOut(Number(e[a].num)),a==e.length-1&&n(!0)}).catch(function(e){t.log(e)})},u=0;u<e.length;u++)s(u)})},handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(e,o,n){var r=i.default.Pointer("_User"),a=r.set(uni.getStorageSync("uid")),s=i.default.Query("logs");s.set("parent",a),s.set("log",e),s.set("detail_id",n),s.set("type",o),s.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})},record_shopOut:function(e,o){t.log(e,o);var n=i.default.Query("shops");n.set("id",e),n.set("have_out",o),n.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})},record_staffOut:function(e){if(t.log(e,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var o=i.default.Query("staffs");o.set("id",uni.getStorageSync("user").objectId),o.set("have_out",Number(e)+uni.getStorageSync("user").have_out),o.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}},get_allCost:function(){var e=uni.getStorageSync("uid");t.log(e);var o=i.default.Query("Goods");o.equalTo("userId","==",e),o.find().then(function(e){t.log(e);var o=!0,n=!1,a=void 0;try{for(var i,s=(0,r.default)(e);!(o=(i=s.next()).done);o=!0){var u=i.value;t.log(u),Number(u.costPrice)*u.reserve,u.reserve}}catch(c){n=!0,a=c}finally{try{o||null==s.return||s.return()}finally{if(n)throw a}}})},getDay:function(e,t){var o=this,n=new Date,r=n.getTime()+864e5*e;n.setTime(r);var a=n.getFullYear(),i=n.getMonth(),s=n.getDate();return i=o.handleMonth(i+1),s=o.handleMonth(s),t?a+"-"+i+"-"+s+" 00:00:00":a+"-"+i+"-"+s},js_date_time:function(e,t){var o=new Date(e),n=o.getFullYear(),r=o.getMonth()+1;r=r<10?"0"+r:r;var a=o.getDate();a=a<10?"0"+a:a;var i=o.getHours();i=i<10?"0"+i:i;var s=o.getMinutes(),u=o.getSeconds();return s=s<10?"0"+s:s,u=u<10?"0"+u:u,t?n+"-"+r+"-"+a+" "+i+":"+s:n+"-"+r+"-"+a},handleMonth:function(e){var t=e;return 1==e.toString().length&&(t="0"+e),t}}}).call(this,o("5a52")["default"])},f475:function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-uni-view",[o("v-uni-view",{staticClass:"page"},[o("v-uni-view",{staticStyle:{"line-height":"70rpx",padding:"20rpx 20rpx 0"}},[e._v("已选产品")]),o("v-uni-view",e._l(e.products,function(t,n){return o("v-uni-view",{key:n,staticClass:"pro_listitem"},[o("v-uni-view",{staticClass:"pro_list",staticStyle:{color:"#3D3D3D"}},[o("v-uni-view",{staticStyle:{width:"calc(100% - 260rpx)"}},[e._v("产品："+e._s(t.goodsName))]),e.user.rights&&-1==e.othercurrent.indexOf("1")?o("v-uni-view",[e._v("期初进货价：￥0")]):o("v-uni-view",[e._v("期初进货价：￥"+e._s(t.costPrice))])],1),t.selected_model?o("v-uni-view",e._l(t.selected_model,function(t,n){return o("v-uni-view",{key:n,staticClass:"display_flex_bet"},[t?o("v-uni-view",{staticStyle:{"font-size":"24rpx",color:"#999"}},[e._v(e._s(t.custom1.value+t.custom2.value+t.custom3.value+t.custom4.value))]):e._e(),t?o("v-uni-view",{staticStyle:{"font-size":"24rpx",color:"#f30"}},[e._v(e._s(t.num))]):e._e()],1)}),1):e._e(),e.user.rights&&"0"!=e.user.rights.othercurrent[0]?o("v-uni-view",{staticClass:"pro_list"},[o("v-uni-view",[e._v("实际进货价：￥0（X"+e._s(t.num)+"）")]),o("v-uni-view",[e._v("合计：￥0")])],1):o("v-uni-view",{staticClass:"pro_list"},[o("v-uni-view",[e._v("实际进货价：￥"+e._s(t.modify_retailPrice)+"（X"+e._s(t.num)+"）")]),o("v-uni-view",[e._v("合计：￥"+e._s(t.modify_retailPrice*t.num))])],1)],1)}),1),o("v-uni-form",{attrs:{"report-submit":"true"},on:{submit:function(t){t=e.$handleEvent(t),e.formSubmit(t)}}},[o("v-uni-view",{staticStyle:{margin:"30rpx 0"}},[o("v-uni-view",{staticStyle:{margin:"0 0 10rpx 10rpx"}},[e._v("开单明细（用于记录是否有无欠款）")]),o("v-uni-view",{staticClass:"kaidan_detail",staticStyle:{"line-height":"70rpx"}},[o("v-uni-navigator",{staticClass:"display_flex",attrs:{"hover-class":"none",url:"/pages/manage/warehouse/warehouse?type=choose"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("选择仓库")]),o("v-uni-view",{staticClass:"kaidan_rightinput"},[o("v-uni-input",{attrs:{placeholder:"选择仓库",disabled:"true",value:e.stock.stock_name}})],1)],1),o("v-uni-navigator",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0"},attrs:{"hover-class":"none",url:"/pages/manage/shops/shops?type=choose"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("选择门店")]),o("v-uni-view",{staticClass:"kaidan_rightinput"},[o("v-uni-input",{attrs:{placeholder:"选择门店",disabled:"true",value:e.shop_name}})],1)],1),o("v-uni-navigator",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0"},attrs:{"hover-class":"none",url:"/pages/manage/custom/custom?type=producer"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("供应商姓名")]),o("v-uni-view",{staticClass:"kaidan_rightinput"},[o("v-uni-input",{attrs:{placeholder:"选择供货商",disabled:"true",value:e.producer.producer_name}})],1)],1),o("v-uni-view",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("发货方式")]),o("v-uni-picker",{staticClass:"kaidan_rightinput",attrs:{range:e.pickerTypes,"range-key":"desc"},on:{change:function(t){t=e.$handleEvent(t),e.select_outType(t)}}},[o("v-uni-input",{attrs:{placeholder:"请选择发货方式",disabled:"true"},model:{value:e.outType.desc,callback:function(t){e.$set(e.outType,"desc",t)},expression:"outType.desc"}})],1)],1),2==e.outType.type||3==e.outType.type?o("v-uni-view",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("快递单号")]),o("v-uni-view",{staticClass:"kaidan_rightinput",attrs:{range:e.pickerTypes,"range-key":"desc"},on:{change:function(t){t=e.$handleEvent(t),e.select_outType(t)}}},[o("v-uni-input",{attrs:{placeholder:"请输入快递单号"},model:{value:e.expressNum,callback:function(t){e.expressNum=t},expression:"expressNum"}}),o("fa-icon",{attrs:{type:"clone",size:"16",color:"#426ab3"},on:{click:function(t){t=e.$handleEvent(t),e.scan_code(t)}}})],1)],1):e._e(),e.user.rights&&"0"!=e.user.rights.othercurrent[0]?o("v-uni-view"):o("v-uni-view",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0"}},[o("v-uni-view",[e._v("实际付款"),o("v-uni-text",{staticStyle:{"font-size":"20rpx",color:"#CCCCCC"}},[e._v("（可修改）")])],1),o("v-uni-view",{staticClass:"kaidan_rightinput"},[o("v-uni-input",{staticStyle:{color:"#d71345"},attrs:{placeholder:"输入实际付款金额",type:"digit"},model:{value:e.real_money,callback:function(t){e.real_money=t},expression:"real_money"}})],1)],1)],1)],1),o("v-uni-view",{staticStyle:{"margin-top":"20px"}},[o("v-uni-input",{staticClass:"beizhu_style",attrs:{placeholder:"请输入备注",name:"input_beizhu"}})],1),o("v-uni-view",{staticStyle:{"margin-top":"20px",background:"#fff",padding:"10rpx"}},[o("v-uni-view",{staticClass:"notice_text"},[e._v("上传凭证图(会员可用)")]),o("v-uni-view",{staticStyle:{width:"100%",padding:"20rpx 0"}},[o("v-uni-view",{staticClass:"upload_image display_flex"},[e._l(e.Images,function(t,n){return e.Images&&e.Images.length>0?o("v-uni-view",{key:n,staticStyle:{position:"relative"}},[o("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx","margin-right":"10rpx"},attrs:{src:t}}),o("fa-icon",{staticStyle:{position:"absolute",top:"-10rpx",right:"-10rpx"},attrs:{type:"times-circle-o",size:"20",color:"#426ab3"},on:{click:function(t){t=e.$handleEvent(t),e.removeImg(n)}}})],1):e._e()}),e.Images.length<3?o("v-uni-view",{staticStyle:{width:"180rpx",height:"180rpx","line-height":"220rpx","text-align":"center",border:"1rpx solid#ccc","border-radius":"16rpx"},on:{click:function(t){t=e.$handleEvent(t),e.upload_image(t)}}},[o("fa-icon",{attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1):e._e()],2)],1)],1),o("v-uni-view",{staticClass:"bottomEle display_flex_bet",staticStyle:{padding:"0 30rpx","margin-top":"60rpx"}},[e.user.rights&&"0"!=e.user.rights.othercurrent[0]?o("v-uni-view",[o("v-uni-text",[e._v("合计：￥0")])],1):o("v-uni-view",[o("v-uni-text",[e._v("合计：￥"+e._s(e.real_money))])],1),o("v-uni-view",{staticClass:"display_flex"},[o("v-uni-button",{staticClass:"confrim_button",attrs:{disabled:e.button_disabled,"form-type":"submit","data-type":"2",value:"2"}},[e._v("入库")])],1)],1)],1)],1)],1)},r=[];o.d(t,"a",function(){return n}),o.d(t,"b",function(){return r})}}]);