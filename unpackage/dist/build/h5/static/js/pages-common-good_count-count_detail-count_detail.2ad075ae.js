(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-common-good_count-count_detail-count_detail"],{"18cf":function(t,e,o){e=t.exports=o("2350")(!1),e.push([t.i,".page[data-v-f0266304]{color:#4d4d4d;background:#f6f5ec;font-size:%?28?%;height:100vh;overflow:scroll}.pro_list[data-v-f0266304]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between}.pro_listitem[data-v-f0266304]{background-color:#fff;padding:%?10?% %?20?%;border-bottom:%?1?% solid#ddd}.pro_allmoney[data-v-f0266304]{background-color:#fff;padding:%?10?% %?20?%;text-align:right;font-size:%?32?%;color:#f30}.beizhu_style[data-v-f0266304]{width:-webkit-calc(100% - %?40?%);width:calc(100% - %?40?%);background-color:#fff;padding:%?20?%;font-size:%?32?%;max-height:%?100?%}.confrim_button[data-v-f0266304]{background:#aa2116\t;color:#fff;font-weight:700;font-size:%?32?%}",""])},"3e05":function(t,e,o){"use strict";var n=i(o("e21e"));function i(t){return t&&t.__esModule?t:{default:t}}t.exports={log:function(t){var e=n.default.Pointer("_User"),o=e.set(uni.getStorageSync("uid")),i=n.default.Query("logs");i.set("parent",o),i.set("log",t),i.save().then(function(t){console.log(t)}).catch(function(t){console.log(t)})}}},6488:function(t,e,o){"use strict";var n=o("e75a"),i=o.n(n);i.a},"8b8b":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i,s=u(o("e21e")),a=u(o("3e05"));function u(t){return t&&t.__esModule?t:{default:t}}var r={data:function(){return{products:null,button_disabled:!1,beizhu_text:"",real_money:0,all_money:0,producer:null}},onLoad:function(){i=this,n=uni.getStorageSync("uid"),this.products=uni.getStorageSync("products")},methods:{formSubmit:function(t){var e=this;console.log(t),this.button_disabled=!0,uni.showLoading({title:"上传中..."});for(var o=[],u=new Array,r=function(t){var o=s.default.Query("Goods");o.get(e.products[t].objectId).then(function(o){o.set("reserve",e.products[t].num),o.set("stocktype",e.products[t].num>e.products[t].warning_num?1:0),o.save()}).catch(function(t){console.log(t)});var i=s.default.Query("Bills"),a=s.default.Pointer("_User"),r=a.set(n),c=s.default.Pointer("Goods"),l=c.set(e.products[t].objectId);i.set("goodsName",e.products[t].goodsName),i.set("retailPrice",e.products[t].modify_retailPrice.toString()),i.set("num",e.products[t].num),i.set("reserve",e.products[t].reserve),i.set("now_reserve",e.products[t].num.toString()),i.set("total_money",e.products[t].total_money),i.set("goodsId",l),i.set("userId",r),i.set("type",3),u.push(i)},c=0;c<this.products.length;c++)r(c);s.default.Query("Bills").saveAll(u).then(function(e){for(var u=0;u<e.length;u++)if(o.push(e[u].success.objectId),u==e.length-1){var r=s.default.Relation("Bills"),c=r.add(o),l=s.default.Pointer("_User"),d=l.set(n);if(1==uni.getStorageSync("identity")){var f=uni.getStorageSync("masterId"),v=s.default.Pointer("_User");v.set(f)}var p=s.default.Query("order_opreations");p.set("relations",c),p.set("beizhu",t.detail.value.input_beizhu),p.set("type",3),p.set("opreater",d),p.set("master",d),p.set("goodsName",i.products[0].goodsName),p.save().then(function(t){console.log("添加操作历史记录成功",t),uni.hideLoading(),uni.showToast({title:"产品盘点成功",icon:"success",success:function(){i.button_disabled=!1,uni.setStorageSync("is_option",!0),setTimeout(function(){a.default.log(uni.getStorageSync("user").nickName+"盘点了'"+i.products[0].goodsName+"'等"+i.products.length+"商品"),uni.navigateBack({delta:2})},500)}})})}},function(t){console.log("异常处理")})}}};e.default=r},"8d01":function(t,e,o){"use strict";o.r(e);var n=o("94b57"),i=o("c703");for(var s in i)"default"!==s&&function(t){o.d(e,t,function(){return i[t]})}(s);o("6488");var a=o("2877"),u=Object(a["a"])(i["default"],n["a"],n["b"],!1,null,"f0266304",null);e["default"]=u.exports},"94b57":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",[o("v-uni-view",{staticClass:"page"},[o("v-uni-view",{staticStyle:{"line-height":"70rpx",padding:"20rpx 20rpx 0"}},[t._v("已选产品")]),o("v-uni-view",{staticStyle:{"max-height":"25vh","overflow-x":"scroll"}},t._l(t.products,function(e,n){return o("v-uni-view",{key:n,staticClass:"pro_listitem"},[o("v-uni-view",{staticClass:"pro_list",staticStyle:{color:"#3D3D3D"}},[o("v-uni-view",[t._v("产品："+t._s(e.goodsName))])],1),o("v-uni-view",{staticClass:"pro_list"},[o("v-uni-view",[t._v("盘点前库存："+t._s(e.reserve))]),o("v-uni-view",[t._v("盘点后库存："+t._s(e.num))])],1)],1)}),1),o("v-uni-form",{on:{submit:function(e){e=t.$handleEvent(e),t.formSubmit(e)}}},[o("v-uni-view",{staticStyle:{"margin-top":"20px"}},[o("v-uni-textarea",{staticClass:"beizhu_style",attrs:{placeholder:"请输入备注",name:"input_beizhu"}})],1),o("v-uni-view",{staticStyle:{padding:"0 30rpx","margin-top":"60rpx"}},[o("v-uni-button",{staticClass:"confrim_button",attrs:{disabled:t.button_disabled,"form-type":"submit"}},[t._v("确认盘点")])],1)],1)],1)],1)},i=[];o.d(e,"a",function(){return n}),o.d(e,"b",function(){return i})},c703:function(t,e,o){"use strict";o.r(e);var n=o("8b8b"),i=o.n(n);for(var s in n)"default"!==s&&function(t){o.d(e,t,function(){return n[t]})}(s);e["default"]=i.a},e75a:function(t,e,o){var n=o("18cf");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=o("4f06").default;i("d6e1629c",n,!0,{sourceMap:!1,shadowMode:!1})}}]);