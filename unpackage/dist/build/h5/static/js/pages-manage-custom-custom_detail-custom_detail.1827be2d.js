(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-custom-custom_detail-custom_detail"],{"112b":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"Loading_view"},[n("v-uni-image",{staticClass:"loading_image",attrs:{src:"/static/timg.gif"}}),n("v-uni-view",{staticStyle:{color:"#999","margin-top":"3%"}},[t._v("加载中...")])],1)},i=[];n.d(e,"a",function(){return o}),n.d(e,"b",function(){return i})},"24f7":function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,".Loading_view[data-v-b97421aa]{height:100vh;width:100%;text-align:center;background:#fff}.loading_image[data-v-b97421aa]{width:%?200?%;height:%?200?%;margin-top:50%}",""])},"2bef":function(t,e,n){"use strict";var o=n("288e");n("6b54"),n("87b3"),n("c5f6");var i=o(n("5d73"));n("7514"),t.exports={handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("now_product"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(t,e,n){var o=Bmob.Pointer("_User"),i=o.set(uni.getStorageSync("uid")),a=Bmob.Query("logs");a.set("parent",i),a.set("log",t),a.set("detail_id",n),a.set("type",e),a.save().then(function(t){console.log(t)}).catch(function(t){console.log(t)})},record_shopOut:function(t,e){console.log(t,e);var n=Bmob.Query("shops");n.set("id",t),n.set("have_out",e),n.save().then(function(t){console.log(t)}).catch(function(t){console.log(t)})},record_staffOut:function(t){if(console.log(t,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var e=Bmob.Query("staffs");e.set("id",uni.getStorageSync("user").objectId),e.set("have_out",t+uni.getStorageSync("user").have_out),e.save().then(function(t){console.log(t)}).catch(function(t){console.log(t)})}},get_allCost:function(){var t=uni.getStorageSync("uid");console.log(t);var e=Bmob.Query("Goods");e.equalTo("userId","==",t),e.find().then(function(t){console.log(t);var e=!0,n=!1,o=void 0;try{for(var a,s=(0,i.default)(t);!(e=(a=s.next()).done);e=!0){var r=a.value;console.log(r),Number(r.costPrice)*r.reserve,r.reserve}}catch(c){n=!0,o=c}finally{try{e||null==s.return||s.return()}finally{if(n)throw o}}})},getDay:function(t,e){var n=this,o=new Date,i=o.getTime()+864e5*t;o.setTime(i);var a=o.getFullYear(),s=o.getMonth(),r=o.getDate();return s=n.handleMonth(s+1),r=n.handleMonth(r),e?a+"-"+s+"-"+r+" 00:00:00":a+"-"+s+"-"+r},handleMonth:function(t){var e=t;return 1==t.toString().length&&(e="0"+t),e}}},"2cb6":function(t,e,n){},"34c5":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"uni-pagination"},[n("v-uni-view",{staticClass:"uni-pagination__btns"},[n("v-uni-view",{class:["uni-pagination__btn",{"uni-pagination--disabled":1===t.currentIndex}],attrs:{"hover-class":1===t.currentIndex?"":"uni-pagination--hover","hover-start-time":20,"hover-stay-time":70},on:{click:function(e){e=t.$handleEvent(e),t.clickLeft(e)}}},[t.showIcon?[n("uni-icon",{attrs:{color:"#000",size:"20",type:"arrowleft"}})]:[t._v(t._s(t.prevText))]],2),n("v-uni-view",{class:["uni-pagination__btn",{"uni-pagination--disabled":t.currentIndex===t.maxPage}],attrs:{"hover-class":t.currentIndex===t.maxPage?"":"uni-pagination--hover","hover-start-time":20,"hover-stay-time":70},on:{click:function(e){e=t.$handleEvent(e),t.clickRight(e)}}},[t.showIcon?[n("uni-icon",{attrs:{color:"#000",size:"20",type:"arrowright"}})]:[t._v(t._s(t.nextText))]],2)],1),n("v-uni-view",{staticClass:"uni-pagination__num"},[n("v-uni-text",{staticClass:"uni-pagination__num-current"},[t._v(t._s(t.currentIndex))])],1)],1)},i=[];n.d(e,"a",function(){return o}),n.d(e,"b",function(){return i})},"53c5":function(t,e,n){"use strict";n.r(e);var o=n("e2fb"),i=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,function(){return o[t]})}(a);e["default"]=i.a},"54b4":function(t,e,n){"use strict";n.r(e);var o=n("2cb6"),i=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,function(){return o[t]})}(a);e["default"]=i.a},"5b7f":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[t.loading?n("loading"):n("v-uni-view",[n("v-uni-view",{staticClass:"display_flex_bet list_item border_bottom"},[n("v-uni-view",{staticClass:"left_desc"},[t._v("客户昵称")]),n("v-uni-view",[t._v(t._s(t.custom.custom_name))])],1),n("v-uni-view",{staticClass:"display_flex_bet list_item border_bottom"},[n("v-uni-view",{staticClass:"left_desc"},[t._v("联系电话")]),t.custom.custom_phone?n("v-uni-view",[t._v(t._s(t.custom.custom_phone))]):n("v-uni-view",[t._v("未填写")])],1),n("v-uni-navigator",{staticClass:"display_flex_bet list_item border_bottom",attrs:{"hover-class":"none",url:"debt_history/debt_history?id="+t.custom.objectId+"&name="+t.custom.custom_name}},[n("v-uni-view",{staticClass:"left_desc"},[t._v("客户欠款")]),n("v-uni-view",{staticClass:"display_flex"},[n("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[t._v("￥"+t._s(t.custom.debt?t.custom.debt:0))]),n("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),n("v-uni-view",{staticClass:"display_flex_bet list_item border_bottom"},[n("v-uni-view",{staticClass:"left_desc"},[t._v("建立时间")]),n("v-uni-view",[t._v(t._s(t.custom.createdAt))])],1),n("v-uni-navigator",{staticClass:"list_item display_flex_bet",staticStyle:{margin:"20rpx 0"},attrs:{"hover-class":"none",url:"history/history?id="+t.custom.objectId}},[n("v-uni-text",{staticClass:"left_desc"},[t._v("交易历史")]),n("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1),n("uni-popup",{attrs:{show:t.modal_show,position:"middle",mode:"fixed"},on:{hidePopup:function(e){e=t.$handleEvent(e),t.modal_show=!1}}},[n("v-uni-view",{staticStyle:{width:"500rpx"}},[n("v-uni-view",{staticClass:"display_flex"},[n("v-uni-view",{staticStyle:{width:"160rpx",color:"#999"}},[t._v("本次收款：")]),n("v-uni-input",{staticClass:"uni-input",attrs:{placeholder:"请输入本次收款金额",type:"digit"},model:{value:t.modal_sk.sk_number,callback:function(e){t.$set(t.modal_sk,"sk_number",e)},expression:"modal_sk.sk_number"}})],1),n("v-uni-view",{staticClass:"display_flex"},[n("v-uni-view",{staticStyle:{width:"160rpx",color:"#999"}},[t._v("备注：")]),n("v-uni-input",{staticClass:"uni-input",attrs:{placeholder:"请输入备注信息"},model:{value:t.modal_sk.beizhu,callback:function(e){t.$set(t.modal_sk,"beizhu",e)},expression:"modal_sk.beizhu"}})],1),n("v-uni-view",{staticClass:"modal_confrimbutton",on:{click:function(e){e=t.$handleEvent(e),t.confrim_sk(e)}}},[t._v("确定")])],1)],1),n("v-uni-view",{staticClass:"getmoney_button",on:{click:function(e){e=t.$handleEvent(e),t.modal_show=!0}}},[t._v("收款")])],1)],1)},i=[];n.d(e,"a",function(){return o}),n.d(e,"b",function(){return i})},"698b":function(t,e,n){"use strict";n.r(e);var o=n("ceee"),i=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,function(){return o[t]})}(a);e["default"]=i.a},"8a8c":function(t,e,n){var o=n("baeb");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=n("4f06").default;i("661b028c",o,!0,{sourceMap:!1,shadowMode:!1})},"8b1e":function(t,e,n){"use strict";n.r(e);var o=n("5b7f"),i=n("53c5");for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);n("af3e");var s=n("2877"),r=Object(s["a"])(i["default"],o["a"],o["b"],!1,null,"85e61b7c",null);e["default"]=r.exports},"915b":function(t,e,n){"use strict";n.r(e);var o=n("34c5"),i=n("698b");for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);n("a6cf");var s=n("2877"),r=Object(s["a"])(i["default"],o["a"],o["b"],!1,null,"28a9110a",null);e["default"]=r.exports},"91f7":function(t,e,n){var o=n("9a17");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=n("4f06").default;i("97a63294",o,!0,{sourceMap:!1,shadowMode:!1})},"9a17":function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,"uni-page-body[data-v-85e61b7c]{color:#3d3d3d}.modal_confrimbutton[data-v-85e61b7c]{background:#426ab3;color:#fff;width:60%;padding:%?20?% 0;text-align:center;margin-left:20%;border-radius:%?8?%;margin-top:%?30?%}.list_item[data-v-85e61b7c]{padding:%?20?% %?30?%;background:#fff}.left_desc[data-v-85e61b7c]{color:#999}.border_bottom[data-v-85e61b7c]{border-bottom:%?1?% solid#DDDDDD}.getmoney_button[data-v-85e61b7c]{width:100%;background:#426ab3;color:#fff;padding:%?20?% 0;text-align:center;position:fixed;bottom:0;left:0}",""])},a6cf:function(t,e,n){"use strict";var o=n("8a8c"),i=n.n(o);i.a},af3e:function(t,e,n){"use strict";var o=n("91f7"),i=n.n(o);i.a},b841:function(t,e,n){"use strict";n.r(e);var o=n("112b"),i=n("54b4");for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);n("c1c9");var s=n("2877"),r=Object(s["a"])(i["default"],o["a"],o["b"],!1,null,"b97421aa",null);e["default"]=r.exports},baeb:function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,'.uni-pagination[data-v-28a9110a]{width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 %?40?%;position:relative;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row}.uni-pagination__btns[data-v-28a9110a]{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row}.uni-pagination__btn[data-v-28a9110a]{width:%?120?%;height:%?60?%;padding:0 %?16?%;line-height:%?60?%;font-size:%?28?%;-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;background-color:#f8f8f8;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.uni-pagination__btn[data-v-28a9110a]:after{content:"";width:200%;height:200%;position:absolute;top:0;left:0;border:1px solid #c8c7cc;-webkit-transform:scale(.5);-ms-transform:scale(.5);transform:scale(.5);-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:%?12?%}.uni-pagination__num[data-v-28a9110a]{height:%?60?%;line-height:%?60?%;font-size:%?28?%;color:#333;position:absolute;left:50%;top:0;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%)}.uni-pagination__num-current[data-v-28a9110a]{color:#007aff}.uni-pagination--disabled[data-v-28a9110a]{opacity:.3}.uni-pagination--hover[data-v-28a9110a]{color:rgba(0,0,0,.6);background-color:#f1f1f1}',""])},bba2:function(t,e,n){"use strict";var o=n("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("c5f6");var i=o(n("5d73"));n("7514");var a=o(n("795b")),s={get_customList:function(t,e){return new a.default(function(n,o){var i=uni.getStorageSync("uid"),a=Bmob.Query("customs");a.order("num"),a.equalTo("parent","==",i),a.equalTo("disabled","==",t),e&&a.equalTo("name","==",{$regex:e+".*"}),a.find().then(function(t){n(t)})})},get_customCount:function(){return new a.default(function(t,e){var n=uni.getStorageSync("uid"),o=Bmob.Query("customs");o.equalTo("parent","==",n),o.find().then(function(e){var n=e,o=!0,a=!1,s=void 0;try{for(var r,c=function(){var t=r.value,e=Bmob.Query("Bills");e.equalTo("type","==",-1),e.equalTo("custom","==",t.objectId),e.find().then(function(e){t.relations=e})},u=(0,i.default)(n);!(o=(r=u.next()).done);o=!0)c()}catch(l){a=!0,s=l}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}t(n)})})},add_custom:function(t){console.log(t);var e=JSON.parse(localStorage.getItem("bmob")).objectId;return new a.default(function(n,o){var i=Bmob.Pointer("_User"),a=i.set(e);if(t.objectId){var s=Bmob.Query("customs");s.set("custom_name",t.custom_name),s.set("debt",Number(t.debt)),s.set("custom_address",t.custom_address),s.set("custom_phone",t.custom_phone),s.set("parent",a),s.set("disabled",!t.disabled),s.set("id",t.objectId),s.save().then(function(t){n(t)}).catch(function(t){console.log(t)})}else{var r=Bmob.Query("customs");r.equalTo("parent","==",e),r.equalTo("name","==",t.custom_name),r.find().then(function(e){if(console.log(e),0==e.length){var o=Bmob.Query("customs");o.set("custom_name",t.custom_name),o.set("debt",Number(t.debt)),o.set("custom_address",t.custom_address),o.set("custom_phone",t.custom_phone),o.set("have_out",0),o.set("disabled",!t.disabled),o.set("parent",a),o.save().then(function(t){n(t)}).catch(function(t){console.log(t)})}else n(!1)})}})},delete_custom:function(t){return new a.default(function(e,n){var o=Bmob.Query("customs");o.destroy(t).then(function(t){e(t)}).catch(function(t){console.log(t)})})},custom_detail:function(t){return new a.default(function(e,n){var o=Bmob.Query("customs");o.get(t).then(function(t){e(t)}).catch(function(t){console.log(t)})})},get_moneyList:function(t){return new a.default(function(e,n){var o=Bmob.Query("debt_history");o.equalTo("custom","==",t),o.include("operater"),o.find().then(function(t){console.log(t),e(t)})})}};e.default=s},c1c9:function(t,e,n){"use strict";var o=n("d292"),i=n.n(o);i.a},ceee:function(t,e,n){"use strict";var o=n("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("c5f6");var i=o(n("c8e0")),a={name:"UniPagination",components:{uniIcon:i.default},props:{prevText:{type:String,default:"上一页"},nextText:{type:String,default:"下一页"},current:{type:[Number,String],default:1},total:{type:[Number,String],default:0},pageSize:{type:[Number,String],default:10},showIcon:{type:Boolean,default:!1}},data:function(){return{currentIndex:1}},computed:{maxPage:function(){var t=1,e=Number(this.total),n=Number(this.pageSize);return e&&n&&(t=Math.ceil(e/n)),t}},watch:{current:function(t){this.currentIndex=+t}},created:function(){this.currentIndex=+this.current},methods:{clickLeft:function(){1!==Number(this.currentIndex)&&(this.currentIndex-=1,this.change("prev"))},clickRight:function(){Number(this.currentIndex)!==this.maxPage&&(this.currentIndex+=1,this.change("next"))},change:function(t){this.$emit("change",{type:t,current:this.currentIndex})}}};e.default=a},d292:function(t,e,n){var o=n("24f7");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=n("4f06").default;i("2876b71b",o,!0,{sourceMap:!1,shadowMode:!1})},e2fb:function(t,e,n){"use strict";var o=n("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("c5f6");var i,a=o(n("bba2")),s=o(n("2bef")),r=o(n("00eb")),c=o(n("915b")),u=o(n("b841")),l={components:{faIcon:r.default,loading:u.default,uniPopup:c.default},data:function(){return{loading:!0,modal_show:!1,custom:{},modal_sk:{sk_number:"",beizhu:""}}},onLoad:function(t){i=this,a.default.custom_detail(t.id).then(function(t){console.log(t),i.custom=t,i.loading=!1})},methods:{confrim_sk:function(){console.log(i.modal_sk);var t=i.modal_sk.sk_number,e=i.modal_sk.beizhu,n=i.custom.objectId;if(null==t||0==t.length)uni.showToast({title:"请输入收款金额",icon:"none"});else{uni.showLoading({title:"加载中..."}),i.modal_show=!1;var o=Bmob.Query("customs");o.get(n).then(function(o){if(o.debt-Number(t)<0)uni.hideLoading(),uni.showToast({icon:"none",title:"收款金额过大"});else if(null==o.debt||0==o.debt)uni.hideLoading(),uni.showToast({icon:"none",title:"该客户没有欠款"});else{o.set("debt",o.debt-Number(t)),o.save();var r=Bmob.Pointer("customs"),c=r.set(n),u=Bmob.Pointer("_User"),l=u.set(uni.getStorageSync("uid")),d=Bmob.Pointer("_User"),f=d.set(uni.getStorageSync("masterId")),b=Bmob.Query("debt_history");b.set("custom",c),b.set("master",l),b.set("operater",f),b.set("debt_number",Number(t)),b.set("beizhu",e),b.save().then(function(e){console.log(e),s.default.log(uni.getStorageSync("user").nickName+"操作'"+i.custom.custom_name+"'客户还款￥"+t+"元",6,e.objectId),uni.hideLoading(),a.default.custom_detail(i.custom.objectId).then(function(t){console.log(t),i.custom=t,uni.showToast({title:"收款成功"})})}).catch(function(t){console.log(t)})}}).catch(function(t){console.log(t)})}}}};e.default=l}}]);