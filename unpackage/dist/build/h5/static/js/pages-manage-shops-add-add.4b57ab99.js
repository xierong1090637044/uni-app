(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-shops-add-add"],{1522:function(e,t,n){"use strict";var a={"uni-nav-bar":n("96bd").default},i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[n("uni-nav-bar",{attrs:{fixed:!1,color:"#333333","background-color":"#FFFFFF","right-text":"添加"},on:{"click-right":function(t){arguments[0]=t=e.$handleEvent(t),e.start_add.apply(void 0,arguments)}}},[n("v-uni-view")],1),n("v-uni-view",[n("v-uni-view",{staticStyle:{"margin-top":"20px",background:"#fff",padding:"0 30rpx"}},[n("v-uni-view",{staticClass:"notice_text"},[e._v("上传门店图(会员可用)")]),n("v-uni-view",{staticStyle:{width:"100%",padding:"20rpx 0"}},[n("v-uni-view",{staticClass:"upload_image display_flex"},[e._l(e.Images,(function(t,a){return e.Images.length>0?n("v-uni-view",{key:a,staticStyle:{position:"relative"}},[n("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx"},attrs:{src:t}}),n("fa-icon",{staticStyle:{position:"absolute",top:"-10rpx",right:"-10rpx"},attrs:{type:"times-circle-o",size:"20",color:"#426ab3"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.removeImg(a)}}})],1):e._e()})),0==e.Images.length?n("v-uni-view",{staticStyle:{width:"180rpx",height:"180rpx","line-height":"220rpx","text-align":"center",border:"1rpx solid#ccc","border-radius":"16rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.upload_image.apply(void 0,arguments)}}},[n("fa-icon",{attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1):e._e()],2)],1)],1),n("v-uni-view",{staticClass:"display_flex item"},[n("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v("门店名字")]),n("v-uni-text",{staticStyle:{color:"#d93a49","margin-right":"20rpx"}},[e._v("*")]),n("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入门店名字"},model:{value:e.shop_name,callback:function(t){e.shop_name=t},expression:"shop_name"}})],1),n("v-uni-view",{staticClass:"display_flex item"},[n("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("门店地址")]),n("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入门店地址"},model:{value:e.shop_address,callback:function(t){e.shop_address=t},expression:"shop_address"}})],1),n("v-uni-view",{staticClass:"display_flex item"},[n("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("门店电话")]),n("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入门店电话",type:"number",maxlength:"11"},model:{value:e.shop_phone,callback:function(t){e.shop_phone=t},expression:"shop_phone"}})],1),n("v-uni-view",{staticClass:"display_flex item"},[n("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v("排序")]),n("v-uni-text",{staticStyle:{color:"#d93a49","margin-right":"20rpx"}},[e._v("*")]),n("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入排序(数值越小,排列越靠前)",type:"number",maxlength:"11"},model:{value:e.shop_num,callback:function(t){e.shop_num=t},expression:"shop_num"}})],1),n("v-uni-view",{staticClass:"display_flex_bet item",staticStyle:{"margin-bottom":"60rpx"}},[n("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("启用")]),n("v-uni-switch",{attrs:{checked:e.disabled},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.switchChange.apply(void 0,arguments)}}})],1),n("v-uni-view",{staticClass:"display_flex item"},[n("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("备注")]),n("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入备注"},model:{value:e.shop_beizhu,callback:function(t){e.shop_beizhu=t},expression:"shop_beizhu"}})],1)],1)],1)},o=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}))},"1ea1":function(e,t,n){var a=n("d815");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("4f06").default;i("440b263a",a,!0,{sourceMap:!1,shadowMode:!1})},2883:function(e,t,n){"use strict";var a=n("1ea1"),i=n.n(a);i.a},"32e2":function(e,t,n){"use strict";(function(e){var a=n("ee27");n("7db0"),n("a434"),n("a9e3"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o,s,r=a(n("9546")),u=a(n("9ef1")),l=a(n("4d52")),c=a(n("96bd")),d={components:{faIcon:l.default,uniNavBar:c.default},data:function(){return{user:uni.getStorageSync("user"),Images:[],disabled:!0,shop_name:"",shop_address:"",shop_num:0,shop_phone:"",shop_beizhu:""}},onLoad:function(e){i=this,s=uni.getStorageSync("uid")},onShow:function(){o=uni.getStorageSync("shop"),o?(uni.setNavigationBarTitle({title:"修改门店"}),i.Images=o.Image,i.shop_name=o.name,i.shop_address=o.address,i.shop_phone=o.phone,i.shop_num=o.num,i.shop_beizhu=o.beizhu):uni.setNavigationBarTitle({title:"新增门店"})},onUnload:function(){uni.removeStorageSync("shop")},methods:{removeImg:function(e){i.Images.splice(e,1),i.Images=i.Images},upload_image:function(){u.default.upload_image(1).then((function(t){e.log(t),i.Images=t}))},switchChange:function(e){i.disabled=e.detail.value},start_add:function(){""==this.shop_name?uni.showToast({title:"请输入门店名字",icon:"none"}):i.add_data()},add_data:function(){uni.showLoading({title:"上传中..."});var t=r.default.Pointer("_User"),n=t.set(s);if(o){var a=r.default.Query("shops");a.set("Image",i.Images),a.set("name",i.shop_name),a.set("num",Number(i.shop_num)),a.set("address",i.shop_address),a.set("phone",i.shop_phone),a.set("beizhu",i.shop_beizhu),a.set("parent",n),a.set("disabled",!i.disabled),a.set("id",o.objectId),a.save().then((function(t){uni.hideLoading(),e.log(t),uni.showToast({title:"修改成功"})})).catch((function(t){e.log(t)}))}else{var u=r.default.Query("shops");u.equalTo("parent","==",s),u.equalTo("name","==",i.shop_name),u.find().then((function(t){if(e.log(t),0==t.length){var a=r.default.Query("shops");a.set("Image",i.Images),a.set("name",i.shop_name),a.set("num",Number(i.shop_num)),a.set("address",i.shop_address),a.set("phone",i.shop_phone),a.set("beizhu",i.shop_beizhu),a.set("have_out",0),a.set("disabled",!i.disabled),a.set("parent",n),a.save().then((function(t){e.log(t),uni.hideLoading(),uni.showToast({title:"添加成功"}),i.disabled=!0,i.shop_name="",i.shop_address="",i.shop_num=0,i.shop_phone="",i.shop_beizhu=""})).catch((function(t){e.log(t)}))}else uni.showToast({title:"已存在此门店",icon:"none"})}))}}}};t.default=d}).call(this,n("5a52")["default"])},"4d5d":function(e,t,n){"use strict";n.r(t);var a=n("32e2"),i=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a},"54f8":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));n("a4d3"),n("e01a"),n("d28b"),n("e260"),n("d3b7"),n("3ca3"),n("ddb0");var a=n("dde1");function i(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(a["a"])(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,s=!0,r=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return s=e.done,e},e:function(e){r=!0,o=e},f:function(){try{s||null==i["return"]||i["return"]()}finally{if(r)throw o}}}}},"9ef1":function(e,t,n){"use strict";(function(t){var a=n("ee27");n("d3b7");var i=a(n("54f8")),o=a(n("9546"));e.exports={upload_image:function(e){return new Promise((function(n,a){var s=uni.getStorageSync("user"),r=[];s.is_vip?uni.chooseImage({count:e,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){t.log(e);var a,s,u=Date.parse(new Date),l=e.tempFilePaths,c=(0,i.default)(l);try{for(c.s();!(s=c.n()).done;){var d=s.value;a=o.default.File(u+".jpg",d)}}catch(p){c.e(p)}finally{c.f()}a.save().then((function(e){var t,a=(0,i.default)(e);try{for(a.s();!(t=a.n()).done;){t.value;r.push(e[0].url)}}catch(p){a.e(p)}finally{a.f()}n(r)}))}}):uni.showToast({title:"您还不是会员，无法使用",icon:"none"})}))}}}).call(this,n("5a52")["default"])},d815:function(e,t,n){var a=n("24fb");t=a(!1),t.push([e.i,"uni-page-body[data-v-b595c886]{background:#fafafa}.item[data-v-b595c886]{padding:%?20?% %?30?%;background:#fff}.rights_item[data-v-b595c886]{margin-bottom:%?20?%}body.?%PAGE?%[data-v-b595c886]{background:#fafafa}",""]),e.exports=t},e30c:function(e,t,n){"use strict";n.r(t);var a=n("1522"),i=n("4d5d");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("2883");var s,r=n("f0c5"),u=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,"b595c886",null,!1,a["a"],s);t["default"]=u.exports}}]);