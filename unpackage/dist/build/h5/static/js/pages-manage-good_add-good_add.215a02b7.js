(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-good_add-good_add"],{"2bc1":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,"[data-v-7ea1da2d]::-webkit-scrollbar{width:2px;height:6px;background-color:rgba(0,0,0,0)}\n\n/*定义滑块 内阴影+圆角*/[data-v-7ea1da2d]::-webkit-scrollbar-thumb{-webkit-border-radius:10px;border-radius:10px;background-color:#999}.page[data-v-7ea1da2d]{font-size:%?28?%;background:#fafafa;height:100vh;overflow:scroll}.frist[data-v-7ea1da2d]{padding:0 %?20?%;background:#fff;margin-top:%?30?%}.input_item[data-v-7ea1da2d]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;line-height:%?80?%;border-bottom:%?1?% solid#f6f5ec}.input_item1[data-v-7ea1da2d]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;line-height:%?80?%;border-bottom:%?1?% solid#f6f5ec}.left_item[data-v-7ea1da2d]{width:%?150?%}.right_input[data-v-7ea1da2d]{margin-left:%?20?%}.submit_button[data-v-7ea1da2d]{background:#426ab3;-webkit-border-radius:%?40?%;border-radius:%?40?%;margin:%?30?%;height:%?88?%;line-height:%?88?%;color:#fff}.upload_image[data-v-7ea1da2d]{width:%?180?%;height:%?180?%;line-height:%?220?%;text-align:center;border:%?1?% solid#999;-webkit-border-radius:%?8?%;border-radius:%?8?%}.notice_text[data-v-7ea1da2d]{padding-top:%?20?%;font-size:%?32?%;color:#3d3d3d;font-weight:700}",""])},"3f04":function(t,e,i){"use strict";i.r(e);var a=i("5280"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);e["default"]=n.a},5280:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a,n,s,o,r=u(i("0909")),c=u(i("8577"));function u(t){return t&&t.__esModule?t:{default:t}}var l=uni.getStorageSync("uid"),d={components:{faIcon:r.default},data:function(){return{stocks:[{stock:{stock_name:"默认仓库"},reserve:0}],category:"",reserve:[0],goodsIcon:"",producttime:"",nousetime:"",productCode:""}},onLoad:function(){a=this,uni.removeStorageSync("category"),uni.removeStorageSync("warehouse")},onShow:function(){if(uni.getStorageSync("warehouse")&&(a.stocks=uni.getStorageSync("warehouse")),uni.getStorageSync("category")){a.category=uni.getStorageSync("category");var t=c.default.Pointer("class_user");s=t.set(a.category.parent.objectId);var e=c.default.Pointer("second_class");o=e.set(a.category.objectId),console.log(a.category.parent.objectId,a.category.objectId)}},onUnload:function(){n="",s="",o=""},methods:{scan_code:function(){uni.scanCode({onlyFromCamera:!0,success:function(t){console.log("条码类型："+t.scanType),console.log("条码内容："+t.result),a.productCode=t.result}})},remove_this:function(t){console.log(t),a.stocks=a.stocks.splice(t-1,1),uni.setStorageSync("warehouse",a.stocks)},change_reserve:function(t,e){console.log(t,e),a.stocks[t].reserve=Number(e.detail.value)},bindproducttimeChange:function(t){a.producttime=t.target.value},bindDateChange:function(t){a.nousetime=t.target.value},formSubmit:function(t){var e=t.detail.value;if(""==e.goodsName)uni.showToast({title:"请输入产品名称",icon:"none"});else if(n){var i,s=!0,o=!1,r=void 0;try{for(var u,l=n[Symbol.iterator]();!(s=(u=l.next()).done);s=!0){var d=u.value;i=c.default.File(e.goodsName+".png",d)}}catch(v){o=!0,r=v}finally{try{s||null==l.return||l.return()}finally{if(o)throw r}}i.save().then(function(t){a.goodsIcon=JSON.parse(t).url,a.upload_good(e)})}else a.upload_good(e)},upload_image:function(){uni.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){a.goodsIcon=t.tempFilePaths[0],n=t.tempFilePaths}})},upload_good:function(t){uni.showLoading({title:"上传中..."});var e=c.default.Pointer("_User"),i=e.set(l),n=c.default.Query("Goods");n.equalTo("userId","==",l),n.equalTo("goodsName","==",t.goodsName),n.find().then(function(e){if(console.log(e),e.length>=1)uni.showToast({title:"你的库存中已存在此产品",icon:"none"});else{var n=!0,r=!1,u=void 0;try{for(var l,d=a.stocks[Symbol.iterator]();!(n=(l=d.next()).done);n=!0){var v=l.value,p=v.reserve,f=v.stock.objectId||"",g=c.default.Pointer("stocks"),m=g.set(f),h=c.default.Query("Goods");h.set("goodsIcon",a.goodsIcon),h.set("goodsName",t.goodsName),h.set("costPrice",t.costPrice?t.costPrice:"0"),h.set("retailPrice",t.retailPrice?t.retailPrice:"0"),h.set("regNumber",t.regNumber),h.set("reserve",Number(p)),h.set("productCode",t.productCode),h.set("stocks",m),h.set("product_info",t.product_info),h.set("producer",t.producer),h.set("packingUnit",t.packingUnit),h.set("packageContent",t.packageContent),uni.getStorageSync("warehouse")&&(h.set("second_class",o),h.set("goodsClass",s)),h.set("userId",i),h.save().then(function(t){uni.hideLoading(),uni.showToast({title:"上传成功"})}).catch(function(t){console.log(t)})}}catch(w){r=!0,u=w}finally{try{n||null==d.return||d.return()}finally{if(r)throw u}}}})}}};e.default=d},"88c4":function(t,e,i){var a=i("2bc1");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("a15a7b92",a,!0,{sourceMap:!1,shadowMode:!1})},"926e":function(t,e,i){"use strict";var a=i("88c4"),n=i.n(a);n.a},"98cc":function(t,e,i){"use strict";i.r(e);var a=i("a838"),n=i("3f04");for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i("926e");var o=i("2877"),r=Object(o["a"])(n["default"],a["a"],a["b"],!1,null,"7ea1da2d",null);e["default"]=r.exports},a838:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"page"},[i("v-uni-form",{on:{submit:function(e){e=t.$handleEvent(e),t.formSubmit(e)}}},[i("v-uni-view",{staticClass:"frist"},[i("v-uni-view",{staticClass:"notice_text"},[t._v("产品图")]),i("v-uni-view",{staticStyle:{width:"100%","padding-bottom":"20rpx"}},[i("v-uni-view",{staticClass:"upload_image",on:{click:function(e){e=t.$handleEvent(e),t.upload_image(e)}}},[t.goodsIcon?i("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx"},attrs:{src:t.goodsIcon}}):i("fa-icon",{attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1),i("v-uni-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{name:"goodsIcon",value:t.goodsIcon}})],1)],1),i("v-uni-view",{staticClass:"frist"},[i("v-uni-view",{staticClass:"notice_text"},[t._v("基本信息")]),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[t._v("名称"),i("v-uni-text",{staticStyle:{color:"#aa2116","margin-left":"4rpx"}},[t._v("*")])],1),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"产品名称",name:"goodsName"}})],1)],1),i("v-uni-navigator",{staticClass:"input_item1",attrs:{"hover-class":"none",url:"/pages/manage/category/category?type=choose"}},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",{staticClass:"left_item"},[t._v("类别")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"产品类别",name:"goodsClass",value:t.category.class_text}})],1)],1),i("v-uni-view",[i("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[t._v("进价")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"产品进价",name:"costPrice",type:"digit"}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[t._v("售价")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"产品售价",name:"retailPrice",type:"digit"}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[t._v("包装含量")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"包装含量",name:"packageContent"}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[t._v("包装单位")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"包装单位",name:"packingUnit"}})],1)],1)],1),i("v-uni-view",{staticClass:"frist"},[t._l(t.stocks,function(e,a){return i("v-uni-view",{key:a,staticStyle:{"line-height":"70rpx"}},[i("v-uni-view",{staticClass:"display_flex_bet"},[i("v-uni-view",{staticClass:"display_flex_bet"},[i("v-uni-view",{staticClass:"left_item"},[t._v("初始库存")]),i("v-uni-input",{attrs:{placeholder:"初始库存",type:"digit",name:"reserve"},on:{input:function(e){e=t.$handleEvent(e),t.change_reserve(a,e)}},model:{value:e.reserve,callback:function(i){t.$set(e,"reserve",i)},expression:"item.reserve"}})],1),i("v-uni-view",{staticClass:"display_flex"},[i("v-uni-view",{staticStyle:{width:"80rpx"}},[t._v("仓库")]),i("v-uni-input",{attrs:{disabled:"true"},model:{value:e.stock.stock_name,callback:function(i){t.$set(e.stock,"stock_name",i)},expression:"item.stock.stock_name"}}),"默认仓库"!=e.stock.stock_name?i("fa-icon",{attrs:{type:"times",size:"16",color:"#426ab3"},on:{click:function(e){e=t.$handleEvent(e),t.remove_this(a)}}}):t._e()],1)],1)],1)}),i("v-uni-navigator",{staticClass:"input_item1",staticStyle:{background:"#426ab3",color:"#fff"},attrs:{"hover-class":"none",url:"/pages/manage/warehouse/warehouse?type=choose"}},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center","justify-content":"center",width:"100%"}},[i("v-uni-view",{staticStyle:{"margin-right":"20rpx"}},[t._v("选择仓库")]),i("fa-icon",{attrs:{type:"plus",size:"20",color:"#fff"}})],1)],1)],2),i("v-uni-view",{staticClass:"frist"},[i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[t._v("生产厂家")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"生产厂家",name:"producer"}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[t._v("货号")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"货号",name:"regNumber"}})],1)],1),i("v-uni-view",{staticClass:"input_item1"},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",{staticClass:"left_item"},[t._v("条码")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{value:t.productCode,placeholder:"条码",name:"productCode"}})],1)],1),i("v-uni-view",[i("fa-icon",{attrs:{type:"clone",size:"16",color:"#426ab3"},on:{click:function(e){e=t.$handleEvent(e),t.scan_code(e)}}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[t._v("货架位置")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"货架位置",name:"position"}})],1)],1),i("v-uni-view",{staticClass:"input_item"},[i("v-uni-view",{staticClass:"left_item"},[t._v("产品简介")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"产品简介",name:"product_info"}})],1)],1)],1),i("v-uni-view",[i("v-uni-button",{staticClass:"submit_button",attrs:{formType:"submit"}},[t._v("保存")])],1)],1)],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})}}]);