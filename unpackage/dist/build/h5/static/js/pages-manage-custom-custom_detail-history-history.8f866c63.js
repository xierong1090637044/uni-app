(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-custom-custom_detail-history-history"],{"0335":function(e,t,n){"use strict";n.r(t);var o=n("1964"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},"0bcc":function(e,t,n){var o=n("6f67");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=n("4f06").default;i("657f7ffc",o,!0,{sourceMap:!1,shadowMode:!1})},1961:function(e,t,n){var o=n("24fb");t=o(!1),t.push([e.i,'.uni-collapse[data-v-7cac7d33]{background-color:#fff;position:relative;width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.uni-collapse[data-v-7cac7d33]:after{position:absolute;z-index:10;right:0;bottom:0;left:0;height:1px;content:"";-webkit-transform:scaleY(.5);transform:scaleY(.5);background-color:#c8c7cc}.uni-collapse[data-v-7cac7d33]:before{position:absolute;z-index:10;right:0;top:0;left:0;height:1px;content:"";-webkit-transform:scaleY(.5);transform:scaleY(.5);background-color:#c8c7cc}',""]),e.exports=t},1964:function(e,t,n){"use strict";(function(e){var o=n("ee27");n("7db0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,a,r,l=o(n("54f8")),s=o(n("9546")),c=o(n("7fd5")),d=o(n("4d52")),u=o(n("120a")),f=o(n("b4ab")),v=o(n("7c20")),h=o(n("c952")),b=o(n("96bd")),m={components:{faIcon:d.default,uniCollapse:f.default,loading:u.default,uniCollapseItem:v.default,uniNavBar:b.default,uniSegmentedControl:h.default},data:function(){return{showOptions:!1,header:{total:0,total_money:0,get_money:0},loading:!0,items:["今天","昨天","近七天","近一个月"],list:[],current:0,now_day:c.default.getDay(0,!1),end_day:c.default.getDay(1,!1),max_day:c.default.getDay(0,!1)}},onLoad:function(t){e.log(t),i=this,r=t.id,a=uni.getStorageSync("uid"),i.get_list(r),i.get_header_data(r,0)},methods:{option_confrim:function(){i.header={total:0,total_money:0,get_money:0},i.showOptions=!1,i.get_header_data(r),i.get_list(r)},option_reset:function(){i.header={total:0,total_money:0,get_money:0},i.now_day=c.default.getDay(0,!1),i.end_day=c.default.getDay(1,!1),i.max_day=c.default.getDay(0,!1),i.showOptions=!1,i.get_header_data(r),i.get_list(r)},bindDateChange1:function(e){i.now_day=e.detail.value},bindDateChange2:function(e){i.end_day=e.detail.value},onClickItem:function(e){this.current!==e&&(this.current=e,i.header={total:0,total_money:0,get_money:0},0==e?(i.now_day=c.default.getDay(0,!1),i.end_day=c.default.getDay(1,!1)):1==e?(i.now_day=c.default.getDay(-1,!1),i.end_day=c.default.getDay(0,!1)):2==e?(i.now_day=c.default.getDay(-7,!1),i.end_day=c.default.getDay(1,!1)):3==e&&(i.now_day=c.default.getDay(-30,!1),i.end_day=c.default.getDay(1,!1)),i.get_header_data(r),i.get_list(r))},get_header_data:function(t){var n=s.default.Query("Bills");n.equalTo("userId","==",a),n.equalTo("type","==",-1),n.equalTo("custom","==",t),n.include("goodsId"),n.equalTo("createdAt",">=",i.now_day+" 00:00:00"),n.equalTo("createdAt","<=",i.end_day+" 00:00:00"),n.find().then((function(t){var n,o=(0,l.default)(t);try{for(o.s();!(n=o.n()).done;){var a=n.value;e.log(a),i.header.total+=a.num,i.header.total_money+=a.total_money,i.header.get_money+=a.total_money-a.really_total_money}}catch(r){o.e(r)}finally{o.f()}}))},get_list:function(t){var n=s.default.Query("order_opreations");n.equalTo("master","==",a),n.equalTo("type","==",-1),n.equalTo("extra_type","!=",5),n.equalTo("custom","==",t),n.include("opreater"),n.equalTo("createdAt",">=",i.now_day+" 00:00:00"),n.equalTo("createdAt","<=",i.end_day+" 00:00:00"),n.order("-createdAt"),n.find().then((function(t){e.log(t);var n,o=t,a=(0,l.default)(o);try{for(a.s();!(n=a.n()).done;){var r=n.value;r.relations=r.detail}}catch(s){a.e(s)}finally{a.f()}i.list=o,i.loading=!1}))}}};t.default=m}).call(this,n("5a52")["default"])},"26bb":function(e,t,n){"use strict";n("a9e3"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={name:"UniSegmentedControl",props:{current:{type:Number,default:0},values:{type:Array,default:function(){return[]}},activeColor:{type:String,default:"#007aff"},styleType:{type:String,default:"button"}},data:function(){return{currentIndex:0}},watch:{current:function(e){e!==this.currentIndex&&(this.currentIndex=e)}},created:function(){this.currentIndex=this.current},methods:{_onClick:function(e){this.currentIndex!==e&&(this.currentIndex=e,this.$emit("clickItem",e))}}};t.default=o},"35fc":function(e,t,n){"use strict";n.r(t);var o=n("db7f"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},"3f3a":function(e,t,n){"use strict";var o={"uni-nav-bar":n("96bd").default,"uni-segmented-control":n("c952").default,"uni-collapse":n("b4ab").default,"uni-collapse-item":n("7c20").default},i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[e.loading?n("loading"):n("v-uni-view",[n("uni-nav-bar",{attrs:{fixed:!1,color:"#333333","background-color":"#FFFFFF","right-text":"筛选"},on:{"click-right":function(t){arguments[0]=t=e.$handleEvent(t),e.showOptions=!0}}}),n("v-uni-view",[n("v-uni-view",{staticClass:"uni-common-mt",staticStyle:{background:"#FFFFFF"}},[n("uni-segmented-control",{attrs:{current:e.current,values:e.items,"style-type":"text","active-color":"#426ab3"},on:{clickItem:function(t){arguments[0]=t=e.$handleEvent(t),e.onClickItem.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"20rpx 30rpx","border-bottom":"10rpx solid#ddd","text-align":"center"}},[n("v-uni-view",[n("v-uni-view",[e._v(e._s(e.header.total))]),n("v-uni-view",{staticStyle:{color:"#999","font-size":"24rpx"}},[e._v("单品数")])],1),n("v-uni-view",[n("v-uni-view",[e._v("¥"+e._s(e.header.total_money))]),n("v-uni-view",{staticStyle:{color:"#999","font-size":"24rpx"}},[e._v("销售额")])],1),n("v-uni-view",[n("v-uni-view",[e._v("¥"+e._s(e.header.get_money))]),n("v-uni-view",{staticStyle:{color:"#999","font-size":"24rpx"}},[e._v("毛利润")])],1)],1)],1)],1),n("v-uni-scroll-view",{staticClass:"page",attrs:{"scroll-y":"true"}},[n("v-uni-view",{staticClass:"list-item"},e._l(e.list,(function(t,o){return n("v-uni-view",{key:o},[n("v-uni-view",{staticClass:"item",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.get_detail(t.objectId)}}},[n("v-uni-view",{staticStyle:{display:"flex",width:"calc(100% - 120rpx)"}},[n("v-uni-view",{staticStyle:{"line-height":"80rpx"}},[n("fa-icon",{attrs:{type:"sign-out",size:"20",color:"#f30"}})],1),n("v-uni-view",{staticStyle:{"margin-left":"20rpx"}},[n("v-uni-view",[n("v-uni-text",{staticStyle:{color:"#999"}},[e._v("操作者：")]),e._v(e._s(t.opreater.nickName))],1),t.goodsName?n("v-uni-view",[n("v-uni-text",{staticStyle:{color:"#999"}},[e._v("操作商品：")]),e._v(e._s(t.goodsName)+" 等...")],1):e._e(),t.beizhu?n("v-uni-view",{staticClass:"item_beizhu"},[n("v-uni-text",{staticStyle:{color:"#999"}},[e._v("备注：")]),e._v(e._s(t.beizhu))],1):e._e(),n("v-uni-view",[n("v-uni-text",{staticStyle:{color:"#999"}},[e._v("操作时间：")]),e._v(e._s(t.createdAt))],1)],1)],1),n("v-uni-view",{staticClass:"order_out"},[e._v("销售")])],1),n("uni-collapse",{attrs:{accordion:!0}},[n("uni-collapse-item",{attrs:{title:"明细"}},e._l(t.relations,(function(t,o){return n("v-uni-view",{key:o,staticClass:"pro_listitem"},[n("v-uni-view",{staticClass:"pro_list",staticStyle:{color:"#3D3D3D"}},[n("v-uni-view",{staticStyle:{"font-size":"20rpx !important"}},[e._v("产品："+e._s(t.goodsName)+"（成本价：￥"+e._s(t.goodsId.costPrice)+"）")]),n("v-uni-view",{staticStyle:{"font-size":"20rpx !important"}},[e._v("建议零售价：￥"+e._s(t.goodsId.retailPrice))])],1),n("v-uni-view",{staticClass:"pro_list"},[n("v-uni-view",{staticStyle:{"font-size":"20rpx !important"}},[e._v("实际卖出价：￥"+e._s(t.retailPrice)+"（X"+e._s(t.num)+"）")]),n("v-uni-view",{staticStyle:{"font-size":"20rpx !important"}},[e._v("总价：￥"+e._s(t.total_money))])],1)],1)})),1)],1)],1)})),1)],1)],1),e.showOptions?n("v-uni-view",{staticClass:"modal_background",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.showOptions=!1}}},[n("v-uni-view",{staticClass:"showOptions"},[n("v-uni-view",{staticClass:"input_item1"},[n("v-uni-view",[n("v-uni-picker",{attrs:{mode:"date",value:e.now_day,end:e.max_day},on:{change:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.bindDateChange1.apply(void 0,arguments)},click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[n("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[n("v-uni-view",{staticStyle:{"margin-right":"20rpx"}},[e._v(e._s(e.now_day))]),n("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1)],1),n("v-uni-view",[e._v("至")]),n("v-uni-view",[n("v-uni-picker",{attrs:{mode:"date",value:e.end_day,end:e.max_day},on:{change:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.bindDateChange2.apply(void 0,arguments)},click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[n("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[n("v-uni-view",{staticStyle:{"margin-right":"20rpx"}},[e._v(e._s(e.end_day))]),n("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1)],1)],1),n("v-uni-view",{staticClass:"option_bottom"},[n("v-uni-view",{staticClass:"selection",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.option_reset.apply(void 0,arguments)}}},[e._v("重置")]),n("v-uni-view",{staticClass:"selection1",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.option_confrim.apply(void 0,arguments)}}},[e._v("确定")])],1)],1)],1):e._e()],1)},a=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}))},"54f8":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));n("a4d3"),n("e01a"),n("d28b"),n("e260"),n("d3b7"),n("3ca3"),n("ddb0");var o=n("dde1");function i(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(o["a"])(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a,r=!0,l=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return r=e.done,e},e:function(e){l=!0,a=e},f:function(){try{r||null==i["return"]||i["return"]()}finally{if(l)throw a}}}}},6916:function(e,t,n){"use strict";var o=n("e3ec"),i=n.n(o);i.a},"6f67":function(e,t,n){var o=n("24fb");t=o(!1),t.push([e.i,".page[data-v-d620c380]{overflow:hidden;height:calc(100vh - %?256?%);font-size:%?28?%;color:#3d3d3d;background:#fafafa}.pro_list[data-v-d620c380]{font-size:%?20?%!important;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.pro_listitem[data-v-d620c380]{background-color:#fff;padding:%?10?% %?20?%;border-bottom:%?1?% solid#ddd}.item[data-v-d620c380]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;background-color:#fff;padding:%?20?%}.icon-order[data-v-d620c380]{font-size:%?44?%;color:#426ab3}.list-item[data-v-d620c380]{height:100%;overflow:scroll}.select_time[data-v-d620c380]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;line-height:%?80?%;color:#999;padding:0 %?30?%}.item_beizhu[data-v-d620c380]{max-width:calc(100% - %?120?%);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.order_get[data-v-d620c380]{padding:%?0?% %?30?%;color:#2ca879;border:%?0.5?% solid#2ca879;height:%?52?%;line-height:%?52?%;border-radius:%?8?%}.order_out[data-v-d620c380]{padding:0 15px;color:#f30;border:1px solid#f30;height:26px;line-height:26px;margin-top:7px;border-radius:4px}.order_counting[data-v-d620c380]{padding:0 15px;color:#000;border:1px solid#000;height:26px;line-height:26px;margin-top:7px;border-radius:4px}.order_returning[data-v-d620c380]{padding:0 15px;color:#b3b242;border:1px solid#b3b242;height:26px;line-height:26px;margin-top:7px;border-radius:4px}",""]),e.exports=t},"70ae":function(e,t,n){var o=n("d0d7");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=n("4f06").default;i("0e00e705",o,!0,{sourceMap:!1,shadowMode:!1})},"72dd":function(e,t,n){"use strict";var o,i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"uni-collapse"},[e._t("default")],2)},a=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}))},"7c0b":function(e,t,n){"use strict";n.r(t);var o=n("26bb"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},"7c20":function(e,t,n){"use strict";n.r(t);var o=n("ce70"),i=n("f9c7");for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("f12f");var r,l=n("f0c5"),s=Object(l["a"])(i["default"],o["b"],o["c"],!1,null,"07b66df4",null,!1,o["a"],r);t["default"]=s.exports},"7fd5":function(e,t,n){"use strict";(function(t){var o=n("ee27");n("7db0"),n("a9e3"),n("d3b7"),n("25f0");var i=o(n("54f8")),a=o(n("9546"));e.exports={enterAddGoodNum:function(e,n){var o=this;return new Promise((function(r,l){for(var s=function(l){var s=0,c=a.default.Query("Goods");c.get(e[l].objectId).then((function(d){var u=d;if(e[l].selectd_model){var f,v=(0,i.default)(e[l].selected_model);try{for(v.s();!(f=v.n()).done;){var h,b=f.value,m=(0,i.default)(u.models);try{for(m.s();!(h=m.n()).done;){var p=h.value;p.id==b.id&&(p.reserve=Number(p.reserve)+Number(b.num)),delete p.num}}catch(g){m.e(g)}finally{m.f()}}}catch(g){v.e(g)}finally{v.f()}s=Number(u.reserve)+Number(e[l].num),c.set("models",u.models)}else s=Number(u.reserve)+Number(e[l].num);c.set("reserve",s),c.set("id",e[l].objectId),c.save().then((function(t){if(e[l].header){var i=a.default.Query("Goods");i.equalTo("header","==",e[l].header.objectId),i.equalTo("order","==",1),i.statTo("sum","reserve"),i.find().then((function(t){var i=t[0]._sumReserve,s=a.default.Query("Goods");s.set("reserve",i),"purchase"==n&&s.set("costPrice",e[l].modify_retailPrice),s.set("id",e[l].header.objectId),s.save().then((function(t){o.modifyStockType(e[l].header.objectId),l==e.length-1&&r(!0)}))}))}else o.modifyStockType(e[l].objectId),l==e.length-1&&r(!0)})).catch((function(e){t.log(e)}))}))},c=0;c<e.length;c++)s(c)}))},outRedGoodNum:function(e){var n=this;return new Promise((function(o,r){for(var l=function(r){var l=0,s=a.default.Query("Goods");s.get(e[r].objectId).then((function(c){var d=c;if(e[r].selectd_model){var u,f=(0,i.default)(e[r].selected_model);try{for(f.s();!(u=f.n()).done;){var v,h=u.value,b=(0,i.default)(d.models);try{for(b.s();!(v=b.n()).done;){var m=v.value;l+=Number(m.reserve),m.id==h.id&&(m.reserve=Number(m.reserve)-Number(h.num)),delete m.num}}catch(p){b.e(p)}finally{b.f()}}}catch(p){f.e(p)}finally{f.f()}l=Number(d.reserve)-Number(e[r].num),s.set("models",d.models)}else l=Number(d.reserve)-Number(e[r].num);s.set("reserve",l),s.set("id",e[r].objectId),s.save().then((function(t){if(e[r].header){var i=a.default.Query("Goods");i.equalTo("header","==",e[r].header.objectId),i.equalTo("order","==",1),i.statTo("sum","reserve"),i.find().then((function(t){var i=t[0]._sumReserve,l=a.default.Query("Goods");l.set("reserve",i),l.set("id",e[r].header.objectId),l.save().then((function(t){n.modifyStockType(e[r].header.objectId),r==e.length-1&&o(!0)}))}))}else n.modifyStockType(e[r].objectId),r==e.length-1&&o(!0)})).catch((function(e){t.log(e)}))}))},s=0;s<e.length;s++)l(s)}))},enterAddGoodNumNew:function(e,n){var o=this;return new Promise((function(r,l){for(var s=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",c=uni.getStorageSync("uid"),d=function(l){var d=0,u=a.default.Query("Goods");u.equalTo("userId","==",c),u.equalTo("header","==",e[l].objectId),u.equalTo("stocks","==",s.objectId),u.find().then((function(c){if(0==c.length)o.upload_good_withNoCan(e[l],s,Number(e[l].num)).then((function(t){u.equalTo("header","==",e[l].objectId),u.equalTo("order","==",1),u.statTo("sum","reserve"),u.find().then((function(t){var o=t[0]._sumReserve;u.set("reserve",o),u.set("id",e[l].objectId),"purchase"==n&&u.set("costPrice",e[l].modify_retailPrice),u.save().then((function(t){l==e.length-1&&r(!0)}))}))}));else{var f=c[0],v=a.default.Query("Goods");if(e[l].selected_model){var h,b=(0,i.default)(e[l].selected_model);try{for(b.s();!(h=b.n()).done;){var m,p=h.value,g=(0,i.default)(f.models);try{for(g.s();!(m=g.n()).done;){var y=m.value;y.id==p.id&&(y.reserve=Number(y.reserve)+Number(p.num)),delete y.num}}catch(_){g.e(_)}finally{g.f()}}}catch(_){b.e(_)}finally{b.f()}d=Number(f.reserve)+Number(e[l].num),v.set("models",f.models)}else d=Number(f.reserve)+Number(e[l].num);v.set("reserve",d),v.set("id",f.objectId),v.save().then((function(t){v.equalTo("header","==",e[l].objectId),v.equalTo("order","==",1),v.statTo("sum","reserve"),v.find().then((function(t){var o=t[0]._sumReserve;v.set("reserve",o),"purchase"==n&&v.set("costPrice",e[l].modify_retailPrice.toString()),v.set("id",e[l].objectId),v.save().then((function(t){l==e.length-1&&r(!0)}))}))})).catch((function(e){t.log(e)}))}}))},u=0;u<e.length;u++)d(u)}))},outRedGoodNumNew:function(e){var n=this;return new Promise((function(o,r){for(var l=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",s=uni.getStorageSync("uid"),c=function(r){var c=0,d=a.default.Query("Goods");d.equalTo("userId","==",s),d.equalTo("header","==",e[r].objectId),d.equalTo("stocks","==",l.objectId),d.find().then((function(s){if(0==s.length)n.upload_good_withNoCan(e[r],l,Number(e[r].num),"out").then((function(t){d.equalTo("header","==",e[r].objectId),d.equalTo("order","==",1),d.statTo("sum","reserve"),d.find().then((function(t){var n=t[0]._sumReserve;d.set("reserve",n),d.set("id",e[r].objectId),d.save().then((function(t){a.default.functions("warn_GoodNum",{uid:uni.getStorageSync("uid"),goodId:e[r].objectId}).then((function(e){})),r==e.length-1&&o(!0)}))}))}));else{var u=s[0];if(e[r].selected_model){var f,v=(0,i.default)(e[r].selected_model);try{for(v.s();!(f=v.n()).done;){var h,b=f.value,m=(0,i.default)(u.models);try{for(m.s();!(h=m.n()).done;){var p=h.value;p.id==b.id&&(p.reserve=Number(p.reserve)-Number(b.num)),delete p.num}}catch(g){m.e(g)}finally{m.f()}}}catch(g){v.e(g)}finally{v.f()}c=Number(u.reserve)-Number(e[r].num),d.set("models",u.models)}else c=Number(u.reserve)-Number(e[r].num);d.set("reserve",c),d.set("id",u.objectId),d.save().then((function(t){d.equalTo("header","==",e[r].objectId),d.equalTo("order","==",1),d.statTo("sum","reserve"),d.find().then((function(t){var n=t[0]._sumReserve;d.set("reserve",n),d.set("id",e[r].objectId),d.save().then((function(t){a.default.functions("warn_GoodNum",{uid:uni.getStorageSync("uid"),goodId:e[r].objectId}).then((function(e){})),r==e.length-1&&o(!0)}))}))})).catch((function(e){t.log(e)}))}}))},d=0;d<e.length;d++)c(d)}))},upload_good_withNoCan:function(e,n,o,r){return new Promise((function(l,s){var c=uni.getStorageSync("uid"),d=a.default.Pointer("_User"),u=d.set(c),f=a.default.Pointer("stocks"),v=f.set(n.objectId),h=a.default.Pointer("Goods"),b="";b=e.header?h.set(e.header.objectId):h.set(e.objectId);var m=a.default.Query("Goods");if(m.set("goodsName",e.goodsName),m.set("goodsIcon",e.goodsIcon),"out"==r){if(m.set("reserve",0-Number(o)),e.goodsId&&e.goodsId.models){var p,g=(0,i.default)(e.goodsId.models);try{for(g.s();!(p=g.n()).done;){var y=p.value;y.reserve=0-Number(y.num)}}catch(q){g.e(q)}finally{g.f()}m.set("models",e.goodsId.models)}else if(e.models&&e.models.length>0){var _,w=(0,i.default)(e.models);try{for(w.s();!(_=w.n()).done;){var x=_.value;x.reserve=0-Number(x.num)}}catch(q){w.e(q)}finally{w.f()}m.set("models",e.models)}}else if("allocation"==r){if(m.set("reserve",Number(o)),e.selected_model&&e.selected_model.length>0){var k,S=(0,i.default)(e.selected_model);try{for(S.s();!(k=S.n()).done;){var I=k.value;I.reserve=Number(I.num),delete I.num}}catch(q){S.e(q)}finally{S.f()}m.set("models",e.selected_model)}}else if(m.set("reserve",Number(o)),e.goodsId&&e.goodsId.models){var j,N=(0,i.default)(e.goodsId.models);try{for(N.s();!(j=N.n()).done;){var C=j.value;C.reserve=Number(C.num)}}catch(q){N.e(q)}finally{N.f()}m.set("models",e.goodsId.models)}else if(e.models&&e.models.length>0){var T,z=(0,i.default)(e.models);try{for(z.s();!(T=z.n()).done;){var P=T.value;P.reserve=Number(P.num?P.num:0)}}catch(q){z.e(q)}finally{z.f()}m.set("models",e.models)}m.set("stocks",v),m.set("userId",u),m.set("header",b),m.set("costPrice",""+e.costPrice),m.set("retailPrice",""+e.retailPrice),m.set("order",1),m.save().then((function(e){t.log(e),l([!0,e])})).catch((function(e){t.log(e)}))}))},handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(e,n,o){var i=a.default.Pointer("_User"),r=i.set(uni.getStorageSync("uid"));if(-2==n){var l=a.default.Pointer("Goods"),s=l.set(o),c=a.default.Query("logs");c.equalTo("goodId","==",o),c.find().then((function(o){if(0==o.length){var i=a.default.Query("logs");i.set("parent",r),i.set("goodId",s),i.set("log",e),i.set("type",n),i.save().then((function(e){t.log(e)})).catch((function(e){t.log(e)}))}}))}else{var d=a.default.Query("logs");d.set("parent",r),d.set("log",e),d.set("detail_id",o),d.set("type",n),d.save().then((function(e){t.log(e)})).catch((function(e){t.log(e)}))}},modifyStockType:function(e){var n=this,o=a.default.Query("Goods");o.get(e).then((function(e){var t=e;""==t.warning_num&&""==t.max_num?e.set("stocktype",1):void 0==t.warning_num&&void 0==t.max_num?e.set("stocktype",1):null==t.warning_num&&null==t.max_num?e.set("stocktype",1):(""!=t.warning_num&&(t.warning_num>=t.reserve?(e.set("stocktype",0),n.log(t.goodsName+"已经超过设置的最小库存值"+t.warning_num,-2,t.objectId)):t.warning_num<t.reserve&&t.reserve<t.max_num&&e.set("stocktype",1)),""!=t.max_num&&(t.max_num<=t.reserve?(e.set("stocktype",2),n.log(t.goodsName+"已经超过设置的最大库存值"+t.max_num,-2,t.objectId)):t.warning_num<t.reserve&&t.reserve<t.max_num&&e.set("stocktype",1))),e.save()})).catch((function(e){t.log(e)}))},record_shopOut:function(e,n){t.log(e,n);var o=a.default.Query("shops");o.set("id",e),o.set("have_out",n),o.save().then((function(e){t.log(e)})).catch((function(e){t.log(e)}))},record_staffOut:function(e){if(t.log(e,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var n=a.default.Query("_User");n.set("id",uni.getStorageSync("user").objectId),n.set("have_out",Number(e)+uni.getStorageSync("user").have_out),n.save().then((function(e){t.log(e)})).catch((function(e){t.log(e)}))}},get_allCost:function(){var e=uni.getStorageSync("uid");t.log(e);var n=a.default.Query("Goods");n.equalTo("userId","==",e),n.find().then((function(e){t.log(e);var n,o=(0,i.default)(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;t.log(a),Number(a.costPrice)*a.reserve,a.reserve}}catch(r){o.e(r)}finally{o.f()}}))},getDay:function(e,t,n){var o=this,i=new Date,a=i.getTime()+864e5*e;i.setTime(a);var r=i.getFullYear(),l=i.getMonth(),s=i.getDate();return l=o.handleMonth(l+1),s=o.handleMonth(s),t?n?r+"-"+l+"-01 00:00:00":r+"-"+l+"-"+s+" 00:00:00":r+"-"+l+"-"+s},js_date_time:function(e,t){var n=new Date(e),o=n.getFullYear(),i=n.getMonth()+1;i=i<10?"0"+i:i;var a=n.getDate();a=a<10?"0"+a:a;var r=n.getHours();r=r<10?"0"+r:r;var l=n.getMinutes(),s=n.getSeconds();return l=l<10?"0"+l:l,s=s<10?"0"+s:s,t?o+"-"+i+"-"+a+" "+r+":"+l:o+"-"+i+"-"+a},handleMonth:function(e){var t=e;return 1==e.toString().length&&(t="0"+e),t}}}).call(this,n("5a52")["default"])},9796:function(e,t,n){"use strict";n.r(t);var o=n("3f3a"),i=n("0335");for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("ba7c");var r,l=n("f0c5"),s=Object(l["a"])(i["default"],o["b"],o["c"],!1,null,"d620c380",null,!1,o["a"],r);t["default"]=s.exports},a04f:function(e,t,n){"use strict";var o=n("ee27");n("4160"),n("a9e3"),n("d3b7"),n("ac1f"),n("25f0"),n("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("3628")),a={name:"UniCollapseItem",components:{uniIcon:i.default},props:{title:{type:String,default:""},name:{type:[Number,String],default:0},disabled:{type:Boolean,default:!1},showAnimation:{type:Boolean,default:!1},open:{type:Boolean,default:!1},thumb:{type:String,default:""}},data:function(){var e=this.__call_hook?"uni_collapse_item":"Uni_".concat(Math.ceil(1e6*Math.random()).toString(36));return{isOpen:!1,height:"auto",elId:e}},watch:{open:function(e){this.isOpen=e}},inject:["collapse"],created:function(){if(this.isOpen=this.open,this.nameSync=this.name?this.name:this.collapse.childrens.length,this.collapse.childrens.push(this),this.collapse.accordion&&this.isOpen){var e=this.collapse.childrens[this.collapse.childrens.length-2];e&&(this.collapse.childrens[this.collapse.childrens.length-2].isOpen=!1)}},mounted:function(){this.getSize()},methods:{getSize:function(){var e=this;this.showAnimation&&uni.createSelectorQuery().in(this).select("#".concat(this.elId)).boundingClientRect().exec((function(t){e.height=t[0].height+"px"}))},onClick:function(){var e=this;this.disabled||(this.collapse.accordion&&this.collapse.childrens.forEach((function(t){t!==e&&(t.isOpen=!1)})),this.isOpen=!this.isOpen,this.collapse.onChange&&this.collapse.onChange())}}};t.default=a},b4ab:function(e,t,n){"use strict";n.r(t);var o=n("72dd"),i=n("35fc");for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("d6b8");var r,l=n("f0c5"),s=Object(l["a"])(i["default"],o["b"],o["c"],!1,null,"7cac7d33",null,!1,o["a"],r);t["default"]=s.exports},ba7c:function(e,t,n){"use strict";var o=n("0bcc"),i=n.n(o);i.a},c952:function(e,t,n){"use strict";n.r(t);var o=n("ca58"),i=n("7c0b");for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("6916");var r,l=n("f0c5"),s=Object(l["a"])(i["default"],o["b"],o["c"],!1,null,"917140dc",null,!1,o["a"],r);t["default"]=s.exports},ca58:function(e,t,n){"use strict";var o,i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"segmented-control",class:{text:"text"===e.styleType},style:{borderColor:"text"===e.styleType?"":e.activeColor}},e._l(e.values,(function(t,o){return n("v-uni-view",{key:o,staticClass:"segmented-control-item",class:[{text:"text"===e.styleType},{active:o===e.currentIndex}],style:{color:o===e.currentIndex?"text"===e.styleType?e.activeColor:"#fff":"text"===e.styleType?"#000":e.activeColor,backgroundColor:o===e.currentIndex&&"button"===e.styleType?e.activeColor:""},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._onClick(o)}}},[e._v(e._s(t))])})),1)},a=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}))},ce70:function(e,t,n){"use strict";var o={"uni-icon":n("3628").default},i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{class:["uni-collapse-cell",{"uni-collapse-cell--disabled":e.disabled,"uni-collapse-cell--open":e.isOpen}],attrs:{"hover-class":e.disabled?"":"uni-collapse-cell--hover"}},[n("v-uni-view",{staticClass:"uni-collapse-cell__title",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onClick.apply(void 0,arguments)}}},[e.thumb?n("v-uni-view",{staticClass:"uni-collapse-cell__title-extra"},[n("v-uni-image",{staticClass:"uni-collapse-cell__title-img",attrs:{src:e.thumb}})],1):e._e(),n("v-uni-view",{staticClass:"uni-collapse-cell__title-inner"},[n("v-uni-view",{staticClass:"uni-collapse-cell__title-text"},[e._v(e._s(e.title))])],1),n("v-uni-view",{staticClass:"uni-collapse-cell__title-arrow",class:{"uni-active":e.isOpen,"uni-collapse-cell--animation":!0===e.showAnimation}},[n("uni-icon",{attrs:{color:"#bbb",size:"20",type:"arrowdown"}})],1)],1),n("v-uni-view",{staticClass:"uni-collapse-cell__content",class:{"uni-collapse-cell--animation":!0===e.showAnimation},style:{height:e.isOpen?"auto":"0px"}},[n("v-uni-view",{attrs:{id:e.elId}},[e._t("default")],2)],1)],1)},a=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}))},d0d7:function(e,t,n){var o=n("24fb");t=o(!1),t.push([e.i,'.uni-collapse-cell[data-v-07b66df4]{position:relative}.uni-collapse-cell--hover[data-v-07b66df4]{background-color:#f1f1f1}.uni-collapse-cell--open[data-v-07b66df4]{background-color:#f1f1f1}.uni-collapse-cell--disabled[data-v-07b66df4]{opacity:.3}.uni-collapse-cell--animation[data-v-07b66df4]{-webkit-transition:all .3s;transition:all .3s}.uni-collapse-cell[data-v-07b66df4]:after{position:absolute;z-index:3;right:0;bottom:0;left:0;height:1px;content:"";-webkit-transform:scaleY(.5);transform:scaleY(.5);background-color:#c8c7cc}.uni-collapse-cell__title[data-v-07b66df4]{padding:%?12?% %?30?%;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-flex:1;-webkit-flex:1;flex:1;position:relative;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.uni-collapse-cell__title-extra[data-v-07b66df4]{margin-right:%?18?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.uni-collapse-cell__title-img[data-v-07b66df4]{height:%?52?%;width:%?52?%}.uni-collapse-cell__title-arrow[data-v-07b66df4]{width:20px;height:20px;-webkit-transform:rotate(0);transform:rotate(0);-webkit-transform-origin:center center;transform-origin:center center}.uni-collapse-cell__title-arrow.uni-active[data-v-07b66df4]{-webkit-transform:rotate(-180deg);transform:rotate(-180deg)}.uni-collapse-cell__title-inner[data-v-07b66df4]{-webkit-box-flex:1;-webkit-flex:1;flex:1;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.uni-collapse-cell__title-text[data-v-07b66df4]{font-size:%?24?%;text-overflow:ellipsis;white-space:nowrap;color:inherit;line-height:1.5;overflow:hidden}.uni-collapse-cell__content[data-v-07b66df4]{position:relative;width:100%;overflow:hidden;background:#fff}.uni-collapse-cell__content uni-view[data-v-07b66df4]{font-size:%?28?%}',""]),e.exports=t},d6b8:function(e,t,n){"use strict";var o=n("e25f"),i=n.n(o);i.a},db7f:function(e,t,n){"use strict";n("4160"),n("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={name:"UniCollapse",props:{accordion:{type:Boolean,default:!1}},data:function(){return{}},provide:function(){return{collapse:this}},created:function(){this.childrens=[]},methods:{onChange:function(){var e=[];this.childrens.forEach((function(t,n){t.isOpen&&e.push(t.nameSync)})),this.$emit("change",e)}}};t.default=o},e25f:function(e,t,n){var o=n("1961");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=n("4f06").default;i("2a095985",o,!0,{sourceMap:!1,shadowMode:!1})},e3ec:function(e,t,n){var o=n("fa11");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=n("4f06").default;i("573bb508",o,!0,{sourceMap:!1,shadowMode:!1})},f12f:function(e,t,n){"use strict";var o=n("70ae"),i=n.n(o);i.a},f9c7:function(e,t,n){"use strict";n.r(t);var o=n("a04f"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},fa11:function(e,t,n){var o=n("24fb");t=o(!1),t.push([e.i,".segmented-control[data-v-917140dc]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:75%;font-size:%?28?%;-webkit-box-sizing:border-box;box-sizing:border-box;margin:0 auto;overflow:hidden;border:1px solid;border-radius:%?10?%}.segmented-control.text[data-v-917140dc]{border:0;border-radius:0}.segmented-control-item[data-v-917140dc]{-webkit-box-flex:1;-webkit-flex:1;flex:1;text-align:center;line-height:%?60?%;-webkit-box-sizing:border-box;box-sizing:border-box;border-left:1px solid}.segmented-control-item.active[data-v-917140dc]{color:#fff}.segmented-control-item.text[data-v-917140dc]{border-left:0;color:#000}.segmented-control-item.text.active[data-v-917140dc]{border-bottom-style:solid}.segmented-control-item[data-v-917140dc]:first-child{border-left-width:0}",""]),e.exports=t}}]);