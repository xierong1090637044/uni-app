(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-finance-otherHistory-InRecord-InRecord"],{"114b":function(e,t,o){"use strict";(function(e){var n=o("ee27");o("7db0"),o("a9e3"),o("d3b7"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(o("54f8")),r=n(o("9546")),i=uni.getStorageSync("uid"),u={get_customList:function(e,t){return new Promise((function(o,n){var a=uni.getStorageSync("uid"),i=r.default.Query("customs");i.order("num"),i.equalTo("parent","==",a),i.equalTo("disabled","==",e),t&&i.equalTo("name","==",{$regex:t+".*"}),i.find().then((function(e){o(e)}))}))},get_customCount:function(){return new Promise((function(e,t){var o=uni.getStorageSync("uid"),n=r.default.Query("customs");n.equalTo("parent","==",o),n.find().then((function(t){var o,n=t,i=(0,a.default)(n);try{var u=function(){var e=o.value,t=r.default.Query("Bills");t.equalTo("type","==",-1),t.equalTo("custom","==",e.objectId),t.find().then((function(t){e.relations=t}))};for(i.s();!(o=i.n()).done;)u()}catch(s){i.e(s)}finally{i.f()}e(n)}))}))},add_custom:function(t){e.log(t);var o=JSON.parse(localStorage.getItem("bmob")).objectId;return new Promise((function(n,a){var i=r.default.Pointer("_User"),u=i.set(o);if(t.objectId){var s=r.default.Query("customs");s.set("custom_name",t.custom_name),s.set("debt",Number(t.debt)),s.set("custom_address",t.custom_address),s.set("custom_phone",t.custom_phone),s.set("parent",u),s.set("disabled",!t.disabled),s.set("id",t.objectId),s.save().then((function(e){n(e)})).catch((function(t){e.log(t)}))}else{var c=r.default.Query("customs");c.equalTo("parent","==",o),c.equalTo("name","==",t.custom_name),c.find().then((function(o){if(e.log(o),0==o.length){var a=r.default.Query("customs");a.set("custom_name",t.custom_name),a.set("debt",Number(t.debt)),a.set("custom_address",t.custom_address),a.set("custom_phone",t.custom_phone),a.set("have_out",0),a.set("disabled",!t.disabled),a.set("parent",u),a.save().then((function(e){n(e)})).catch((function(t){e.log(t)}))}else n(!1)}))}}))},delete_custom:function(t){return new Promise((function(o,n){var a=r.default.Query("customs");a.destroy(t).then((function(e){o(e)})).catch((function(t){e.log(t)}))}))},custom_detail:function(t){return new Promise((function(o,n){var a=r.default.Query("customs");a.include("customFristClass","customSecondClass"),a.get(t).then((function(e){o(e)})).catch((function(t){e.log(t)}))}))},get_moneyList:function(t){return new Promise((function(o,n){var a=r.default.Query("order_opreations");a.equalTo("custom","==",t),a.include("opreater","account"),a.find().then((function(t){e.log(t),o(t)}))}))},getCustomSellList:function(e){return new Promise((function(t,o){var n=r.default.Query("order_opreations");n.equalTo("master","==",i),n.equalTo("type","==",-1),n.equalTo("extra_type","==",1),n.equalTo("extra_type","==",1),n.equalTo("custom","==",e.customId),n.equalTo("status","==",!0),n.equalTo("createdAt",">=",e.startDate),n.equalTo("createdAt","<=",e.endDate),n.limit(50),n.skip(50*(e.pageNum-1)),n.include("opreater","custom","stock"),n.order("-createdAt"),n.find().then((function(e){t(e)}))}))},getAllCustomSellList:function(e){var t={},o=0,n=0,u=0,s=0,c=0;return new Promise((function(l,d){var f=r.default.Query("order_opreations");f.equalTo("master","==",i),f.equalTo("type","==",e.type),f.equalTo("extra_type","==",e.extra_type),f.equalTo("custom","==",e.customId),f.equalTo("status","==",!0),f.equalTo("createdAt",">=",e.startDate+" 00:00:01"),f.equalTo("createdAt","<=",e.endDate+" 00:00:01"),f.count().then((function(r){u=r;var d=0;if(0==u)t.total=o,t.num=u,t.money=n,t.realMoney=0,t.realCost=0,l(t);else for(var v=0;v<Math.ceil(u/500);v++)f.equalTo("master","==",i),f.equalTo("type","==",e.type),f.equalTo("extra_type","==",e.extra_type),f.equalTo("custom","==",e.customId),f.equalTo("status","==",!0),f.limit(500),f.skip(500*v),f.include("opreater","custom","stock"),f.order("-createdAt"),f.equalTo("createdAt",">=",e.startDate+" 00:00:01"),f.equalTo("createdAt","<=",e.endDate+" 00:00:01"),f.find().then((function(e){var r,i=(0,a.default)(e);try{for(i.s();!(r=i.n()).done;){var f=r.value;o+=f.real_num,n+=f.all_money,s+=f.real_money,c+=f.allCostPrice,d+=1}}catch(v){i.e(v)}finally{i.f()}d==u&&(t.total=o,t.num=u,t.money=n,t.realMoney=s,t.realCost=c,l(t))}))}))}))},getAllCustomInRecord:function(e){var t={},o=0,n=0;return new Promise((function(u,s){var c=r.default.Query("order_opreations");c.equalTo("master","==",i),c.equalTo("type","==",-1),c.equalTo("extra_type","==",5),c.equalTo("custom","==",e.customId),c.equalTo("createdAt",">=",e.startDate+" 00:00:01"),c.equalTo("createdAt","<=",e.endDate+" 00:00:01"),c.count().then((function(r){n=r;var s=0;if(0==n)t.num=n,t.money=o,u(t);else for(var l=0;l<Math.ceil(n/500);l++)c.equalTo("master","==",i),c.equalTo("type","==",-1),c.equalTo("extra_type","==",5),c.equalTo("custom","==",e.customId),c.limit(500),c.skip(500*l),c.order("-createdAt"),c.equalTo("createdAt",">=",e.startDate+" 00:00:01"),c.equalTo("createdAt","<=",e.endDate+" 00:00:01"),c.find().then((function(e){var r,i=(0,a.default)(e);try{for(i.s();!(r=i.n()).done;){var c=r.value;o+=c.real_money,s+=1}}catch(l){i.e(l)}finally{i.f()}s==n&&(t.num=n,t.money=o,u(t))}))}))}))}};t.default=u}).call(this,o("5a52")["default"])},"1a64":function(e,t,o){"use strict";o.r(t);var n=o("deb0"),a=o.n(n);for(var r in n)"default"!==r&&function(e){o.d(t,e,(function(){return n[e]}))}(r);t["default"]=a.a},"1c60":function(e,t,o){"use strict";var n,a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-uni-view",[o("v-uni-view",{staticClass:"page"},[o("v-uni-form",{attrs:{"report-submit":"true"},on:{submit:function(t){arguments[0]=t=e.$handleEvent(t),e.formSubmit.apply(void 0,arguments)}}},[o("v-uni-view",{staticStyle:{margin:"30rpx 0"}},[o("v-uni-view",{staticStyle:{margin:"0 0 10rpx 10rpx","font-size":"32rpx",color:"#333","font-weight":"bold"}},[e._v("基本信息")]),o("v-uni-view",{staticClass:"kaidan_detail",staticStyle:{"line-height":"70rpx"}},[o("v-uni-view",[o("v-uni-navigator",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0","border-bottom":"1rpx solid#F7F7F7"},attrs:{"hover-class":"none",url:"/pages/finance/myData/inClass/inClass?type=choose"}},[o("v-uni-view",{staticStyle:{width:"160rpx"}},[e._v("收入类别"),o("v-uni-text",{staticStyle:{color:"#f30"}},[e._v("*")])],1),o("v-uni-view",{staticClass:"kaidan_rightinput display_flex",staticStyle:{width:"100%","justify-content":"flex-end"}},[o("v-uni-input",{staticStyle:{"text-align":"right","margin-right":"20rpx"},attrs:{placeholder:"选择收入类别",disabled:"true",value:e.category.class_text}}),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1)],1),o("v-uni-navigator",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 0","border-bottom":"1rpx solid#F7F7F7"},attrs:{"hover-class":"none",url:"/pages/finance/myData/account/account?type=choose"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("收款账户"),o("v-uni-text",{staticStyle:{color:"#f30"}},[e._v("*")])],1),o("v-uni-view",{staticClass:"kaidan_rightinput display_flex",staticStyle:{"justify-content":"flex-end"}},[o("v-uni-input",{staticStyle:{"text-align":"right","margin-right":"20rpx"},attrs:{placeholder:"选择收款账户",disabled:"true",value:e.account?e.account.name:""}}),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),o("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 0","border-bottom":"1rpx solid#F7F7F7"}},[o("v-uni-view",[e._v("本次收款"),o("v-uni-text",{staticStyle:{"font-size":"20rpx",color:"#f30"}},[e._v("*")])],1),o("v-uni-view",{staticClass:"kaidan_rightinput",staticStyle:{"text-align":"right"}},[o("v-uni-input",{staticStyle:{color:"#d71345"},attrs:{placeholder:"输入实际收款金额",type:"digit"},model:{value:e.real_money,callback:function(t){e.real_money=t},expression:"real_money"}})],1)],1),o("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 0","border-bottom":"1rpx solid#F7F7F7"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("收款日期")]),o("v-uni-picker",{attrs:{mode:"date",value:e.nowDay,end:e.nowDay},on:{change:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.bindDateChange.apply(void 0,arguments)},click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[o("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[o("v-uni-view",{staticStyle:{"margin-right":"20rpx"}},[e._v(e._s(e.nowDay.split(" ")[0]))]),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1)],1),o("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 0","border-bottom":"1rpx solid#F7F7F7"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("备注")]),o("v-uni-input",{staticClass:"beizhu_style",attrs:{placeholder:"请输入备注",name:"input_beizhu"},model:{value:e.beizhu_text,callback:function(t){e.beizhu_text=t},expression:"beizhu_text"}})],1)],1)],1),o("v-uni-view",{staticStyle:{"margin-top":"20px",background:"#fff",padding:"10rpx"}},[o("v-uni-view",{staticClass:"notice_text"},[e._v("上传凭证图(会员可用)")]),o("v-uni-view",{staticStyle:{width:"100%",padding:"20rpx 0"}},[o("v-uni-view",{staticClass:"upload_image display_flex"},[e._l(e.Images,(function(t,n){return e.Images&&e.Images.length>0?o("v-uni-view",{key:n,staticStyle:{position:"relative"}},[o("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx","margin-right":"10rpx"},attrs:{src:t}}),o("fa-icon",{staticStyle:{position:"absolute",top:"-10rpx",right:"-10rpx"},attrs:{type:"times-circle-o",size:"20",color:"#426ab3"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.removeImg(n)}}})],1):e._e()})),e.Images.length<3?o("v-uni-view",{staticStyle:{width:"180rpx",height:"180rpx","line-height":"220rpx","text-align":"center",border:"1rpx solid#ccc","border-radius":"16rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.upload_image.apply(void 0,arguments)}}},[o("fa-icon",{attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1):e._e()],2)],1)],1),o("v-uni-view",{staticClass:"bottomEle display_flex_bet",staticStyle:{padding:"0 30rpx","margin-top":"60rpx"}},[o("v-uni-view",[o("v-uni-text",[e._v("本次收款：￥"+e._s(e.real_money||0))])],1),o("v-uni-view",{staticClass:"display_flex"},[o("v-uni-button",{staticClass:"confrim_button",staticStyle:{background:"#426ab3"},attrs:{disabled:e.button_disabled,"form-type":"submit","data-type":"1"}},[e._v("生成收款单")])],1)],1)],1)],1)],1)},r=[];o.d(t,"b",(function(){return a})),o.d(t,"c",(function(){return r})),o.d(t,"a",(function(){return n}))},"54f8":function(e,t,o){"use strict";o.r(t),o.d(t,"default",(function(){return a}));o("a4d3"),o("e01a"),o("d28b"),o("e260"),o("d3b7"),o("3ca3"),o("ddb0");var n=o("dde1");function a(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(n["a"])(e))){var t=0,o=function(){};return{s:o,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r,i=!0,u=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return i=e.done,e},e:function(e){u=!0,r=e},f:function(){try{i||null==a["return"]||a["return"]()}finally{if(u)throw r}}}}},"55ff":function(e,t,o){"use strict";var n=o("8c58"),a=o.n(n);a.a},"7fd5":function(e,t,o){"use strict";(function(t){var n=o("ee27");o("7db0"),o("a9e3"),o("d3b7"),o("25f0");var a=n(o("54f8")),r=n(o("9546"));e.exports={enterAddGoodNum:function(e,o){var n=this;return new Promise((function(i,u){for(var s=function(u){var s=0,c=r.default.Query("Goods");c.get(e[u].objectId).then((function(l){var d=l;if(e[u].selectd_model){var f,v=(0,a.default)(e[u].selected_model);try{for(v.s();!(f=v.n()).done;){var m,g=f.value,y=(0,a.default)(d.models);try{for(y.s();!(m=y.n()).done;){var h=m.value;h.id==g.id&&(h.reserve=Number(h.reserve)+Number(g.num)),delete h.num}}catch(p){y.e(p)}finally{y.f()}}}catch(p){v.e(p)}finally{v.f()}s=Number(d.reserve)+Number(e[u].num),c.set("models",d.models)}else s=Number(d.reserve)+Number(e[u].num);c.set("reserve",s),c.set("id",e[u].objectId),c.save().then((function(t){if(e[u].header){var a=r.default.Query("Goods");a.equalTo("header","==",e[u].header.objectId),a.equalTo("order","==",1),a.statTo("sum","reserve"),a.find().then((function(t){var a=t[0]._sumReserve,s=r.default.Query("Goods");s.set("reserve",a),"purchase"==o&&s.set("costPrice",e[u].modify_retailPrice),s.set("id",e[u].header.objectId),s.save().then((function(t){n.modifyStockType(e[u].header.objectId),u==e.length-1&&i(!0)}))}))}else n.modifyStockType(e[u].objectId),u==e.length-1&&i(!0)})).catch((function(e){t.log(e)}))}))},c=0;c<e.length;c++)s(c)}))},outRedGoodNum:function(e){var o=this;return new Promise((function(n,i){for(var u=function(i){var u=0,s=r.default.Query("Goods");s.get(e[i].objectId).then((function(c){var l=c;if(e[i].selectd_model){var d,f=(0,a.default)(e[i].selected_model);try{for(f.s();!(d=f.n()).done;){var v,m=d.value,g=(0,a.default)(l.models);try{for(g.s();!(v=g.n()).done;){var y=v.value;u+=Number(y.reserve),y.id==m.id&&(y.reserve=Number(y.reserve)-Number(m.num)),delete y.num}}catch(h){g.e(h)}finally{g.f()}}}catch(h){f.e(h)}finally{f.f()}u=Number(l.reserve)-Number(e[i].num),s.set("models",l.models)}else u=Number(l.reserve)-Number(e[i].num);s.set("reserve",u),s.set("id",e[i].objectId),s.save().then((function(t){if(e[i].header){var a=r.default.Query("Goods");a.equalTo("header","==",e[i].header.objectId),a.equalTo("order","==",1),a.statTo("sum","reserve"),a.find().then((function(t){var a=t[0]._sumReserve,u=r.default.Query("Goods");u.set("reserve",a),u.set("id",e[i].header.objectId),u.save().then((function(t){o.modifyStockType(e[i].header.objectId),i==e.length-1&&n(!0)}))}))}else o.modifyStockType(e[i].objectId),i==e.length-1&&n(!0)})).catch((function(e){t.log(e)}))}))},s=0;s<e.length;s++)u(s)}))},enterAddGoodNumNew:function(e,o){var n=this;return new Promise((function(i,u){for(var s=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",c=uni.getStorageSync("uid"),l=function(u){var l=0,d=r.default.Query("Goods");d.equalTo("userId","==",c),d.equalTo("header","==",e[u].objectId),d.equalTo("stocks","==",s.objectId),d.find().then((function(c){if(0==c.length)n.upload_good_withNoCan(e[u],s,Number(e[u].num)).then((function(t){d.equalTo("header","==",e[u].objectId),d.equalTo("order","==",1),d.statTo("sum","reserve"),d.find().then((function(t){var n=t[0]._sumReserve;d.set("reserve",n),d.set("id",e[u].objectId),"purchase"==o&&d.set("costPrice",e[u].modify_retailPrice),d.save().then((function(t){u==e.length-1&&i(!0)}))}))}));else{var f=c[0],v=r.default.Query("Goods");if(e[u].selected_model){var m,g=(0,a.default)(e[u].selected_model);try{for(g.s();!(m=g.n()).done;){var y,h=m.value,p=(0,a.default)(f.models);try{for(p.s();!(y=p.n()).done;){var b=y.value;b.id==h.id&&(b.reserve=Number(b.reserve)+Number(h.num)),delete b.num}}catch(_){p.e(_)}finally{p.f()}}}catch(_){g.e(_)}finally{g.f()}l=Number(f.reserve)+Number(e[u].num),v.set("models",f.models)}else l=Number(f.reserve)+Number(e[u].num);v.set("reserve",l),v.set("id",f.objectId),v.save().then((function(t){v.equalTo("header","==",e[u].objectId),v.equalTo("order","==",1),v.statTo("sum","reserve"),v.find().then((function(t){var n=t[0]._sumReserve;v.set("reserve",n),"purchase"==o&&v.set("costPrice",e[u].modify_retailPrice.toString()),v.set("id",e[u].objectId),v.save().then((function(t){u==e.length-1&&i(!0)}))}))})).catch((function(e){t.log(e)}))}}))},d=0;d<e.length;d++)l(d)}))},outRedGoodNumNew:function(e){var o=this;return new Promise((function(n,i){for(var u=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",s=uni.getStorageSync("uid"),c=function(i){var c=0,l=r.default.Query("Goods");l.equalTo("userId","==",s),l.equalTo("header","==",e[i].objectId),l.equalTo("stocks","==",u.objectId),l.find().then((function(s){if(0==s.length)o.upload_good_withNoCan(e[i],u,Number(e[i].num),"out").then((function(t){l.equalTo("header","==",e[i].objectId),l.equalTo("order","==",1),l.statTo("sum","reserve"),l.find().then((function(t){var o=t[0]._sumReserve;l.set("reserve",o),l.set("id",e[i].objectId),l.save().then((function(t){r.default.functions("warn_GoodNum",{uid:uni.getStorageSync("uid"),goodId:e[i].objectId}).then((function(e){})),i==e.length-1&&n(!0)}))}))}));else{var d=s[0];if(e[i].selected_model){var f,v=(0,a.default)(e[i].selected_model);try{for(v.s();!(f=v.n()).done;){var m,g=f.value,y=(0,a.default)(d.models);try{for(y.s();!(m=y.n()).done;){var h=m.value;h.id==g.id&&(h.reserve=Number(h.reserve)-Number(g.num)),delete h.num}}catch(p){y.e(p)}finally{y.f()}}}catch(p){v.e(p)}finally{v.f()}c=Number(d.reserve)-Number(e[i].num),l.set("models",d.models)}else c=Number(d.reserve)-Number(e[i].num);l.set("reserve",c),l.set("id",d.objectId),l.save().then((function(t){l.equalTo("header","==",e[i].objectId),l.equalTo("order","==",1),l.statTo("sum","reserve"),l.find().then((function(t){var o=t[0]._sumReserve;l.set("reserve",o),l.set("id",e[i].objectId),l.save().then((function(t){r.default.functions("warn_GoodNum",{uid:uni.getStorageSync("uid"),goodId:e[i].objectId}).then((function(e){})),i==e.length-1&&n(!0)}))}))})).catch((function(e){t.log(e)}))}}))},l=0;l<e.length;l++)c(l)}))},upload_good_withNoCan:function(e,o,n,i){return new Promise((function(u,s){var c=uni.getStorageSync("uid"),l=r.default.Pointer("_User"),d=l.set(c),f=r.default.Pointer("stocks"),v=f.set(o.objectId),m=r.default.Pointer("Goods"),g="";g=e.header?m.set(e.header.objectId):m.set(e.objectId);var y=r.default.Query("Goods");if(y.set("goodsName",e.goodsName),y.set("goodsIcon",e.goodsIcon),"out"==i){if(y.set("reserve",0-Number(n)),e.goodsId&&e.goodsId.models){var h,p=(0,a.default)(e.goodsId.models);try{for(p.s();!(h=p.n()).done;){var b=h.value;b.reserve=0-Number(b.num)}}catch(Q){p.e(Q)}finally{p.f()}y.set("models",e.goodsId.models)}else if(e.models&&e.models.length>0){var _,S=(0,a.default)(e.models);try{for(S.s();!(_=S.n()).done;){var w=_.value;w.reserve=0-Number(w.num)}}catch(Q){S.e(Q)}finally{S.f()}y.set("models",e.models)}}else if("allocation"==i){if(y.set("reserve",Number(n)),e.selected_model&&e.selected_model.length>0){var x,I=(0,a.default)(e.selected_model);try{for(I.s();!(x=I.n()).done;){var T=x.value;T.reserve=Number(T.num),delete T.num}}catch(Q){I.e(Q)}finally{I.f()}y.set("models",e.selected_model)}}else if(y.set("reserve",Number(n)),e.goodsId&&e.goodsId.models){var q,N=(0,a.default)(e.goodsId.models);try{for(N.s();!(q=N.n()).done;){var j=q.value;j.reserve=Number(j.num)}}catch(Q){N.e(Q)}finally{N.f()}y.set("models",e.goodsId.models)}else if(e.models&&e.models.length>0){var k,P=(0,a.default)(e.models);try{for(P.s();!(k=P.n()).done;){var C=k.value;C.reserve=Number(C.num?C.num:0)}}catch(Q){P.e(Q)}finally{P.f()}y.set("models",e.models)}y.set("stocks",v),y.set("userId",d),y.set("header",g),y.set("costPrice",""+e.costPrice),y.set("retailPrice",""+e.retailPrice),y.set("order",1),y.save().then((function(e){t.log(e),u([!0,e])})).catch((function(e){t.log(e)}))}))},handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(e,o,n){var a=r.default.Pointer("_User"),i=a.set(uni.getStorageSync("uid"));if(-2==o){var u=r.default.Pointer("Goods"),s=u.set(n),c=r.default.Query("logs");c.equalTo("goodId","==",n),c.find().then((function(n){if(0==n.length){var a=r.default.Query("logs");a.set("parent",i),a.set("goodId",s),a.set("log",e),a.set("type",o),a.save().then((function(e){t.log(e)})).catch((function(e){t.log(e)}))}}))}else{var l=r.default.Query("logs");l.set("parent",i),l.set("log",e),l.set("detail_id",n),l.set("type",o),l.save().then((function(e){t.log(e)})).catch((function(e){t.log(e)}))}},modifyStockType:function(e){var o=this,n=r.default.Query("Goods");n.get(e).then((function(e){var t=e;""==t.warning_num&&""==t.max_num?e.set("stocktype",1):void 0==t.warning_num&&void 0==t.max_num?e.set("stocktype",1):null==t.warning_num&&null==t.max_num?e.set("stocktype",1):(""!=t.warning_num&&(t.warning_num>=t.reserve?(e.set("stocktype",0),o.log(t.goodsName+"已经超过设置的最小库存值"+t.warning_num,-2,t.objectId)):t.warning_num<t.reserve&&t.reserve<t.max_num&&e.set("stocktype",1)),""!=t.max_num&&(t.max_num<=t.reserve?(e.set("stocktype",2),o.log(t.goodsName+"已经超过设置的最大库存值"+t.max_num,-2,t.objectId)):t.warning_num<t.reserve&&t.reserve<t.max_num&&e.set("stocktype",1))),e.save()})).catch((function(e){t.log(e)}))},record_shopOut:function(e,o){t.log(e,o);var n=r.default.Query("shops");n.set("id",e),n.set("have_out",o),n.save().then((function(e){t.log(e)})).catch((function(e){t.log(e)}))},record_staffOut:function(e){if(t.log(e,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var o=r.default.Query("_User");o.set("id",uni.getStorageSync("user").objectId),o.set("have_out",Number(e)+uni.getStorageSync("user").have_out),o.save().then((function(e){t.log(e)})).catch((function(e){t.log(e)}))}},get_allCost:function(){var e=uni.getStorageSync("uid");t.log(e);var o=r.default.Query("Goods");o.equalTo("userId","==",e),o.find().then((function(e){t.log(e);var o,n=(0,a.default)(e);try{for(n.s();!(o=n.n()).done;){var r=o.value;t.log(r),Number(r.costPrice)*r.reserve,r.reserve}}catch(i){n.e(i)}finally{n.f()}}))},getDay:function(e,t,o){var n=this,a=new Date,r=a.getTime()+864e5*e;a.setTime(r);var i=a.getFullYear(),u=a.getMonth(),s=a.getDate();return u=n.handleMonth(u+1),s=n.handleMonth(s),t?o?i+"-"+u+"-01 00:00:00":i+"-"+u+"-"+s+" 00:00:00":i+"-"+u+"-"+s},js_date_time:function(e,t){var o=new Date(e),n=o.getFullYear(),a=o.getMonth()+1;a=a<10?"0"+a:a;var r=o.getDate();r=r<10?"0"+r:r;var i=o.getHours();i=i<10?"0"+i:i;var u=o.getMinutes(),s=o.getSeconds();return u=u<10?"0"+u:u,s=s<10?"0"+s:s,t?n+"-"+a+"-"+r+" "+i+":"+u:n+"-"+a+"-"+r},handleMonth:function(e){var t=e;return 1==e.toString().length&&(t="0"+e),t}}}).call(this,o("5a52")["default"])},"8c58":function(e,t,o){var n=o("8cc6");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=o("4f06").default;a("417d8fe5",n,!0,{sourceMap:!1,shadowMode:!1})},"8cc6":function(e,t,o){var n=o("24fb");t=n(!1),t.push([e.i,".page[data-v-1f6d5c26]{color:#4d4d4d;font-size:%?28?%;height:calc(100vh - %?110?%);overflow:scroll}.bottomEle[data-v-1f6d5c26]{position:fixed;bottom:0;left:0;width:calc(100% - %?30?%);background:#fafafa;padding:%?20?% %?0?% %?20?% %?30?%;font-weight:700}.pro_list[data-v-1f6d5c26]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.pro_listitem[data-v-1f6d5c26]{background-color:#fff;padding:%?10?% %?20?%;border-bottom:%?1?% solid#ddd}.pro_allmoney[data-v-1f6d5c26]{background-color:#fff;padding:%?10?% %?20?%;text-align:right;font-size:%?32?%;color:#f30}.beizhu_style[data-v-1f6d5c26]{text-align:right;width:calc(100% - %?40?%);background-color:#fff;max-height:%?100?%;padding:%?10?% 0}.confrim_button[data-v-1f6d5c26]{background:#1651aa;color:#fff;font-weight:700;font-size:%?32?%;border-radius:unset;padding:0 %?50?%}",""]),e.exports=t},deb0:function(e,t,o){"use strict";(function(e){var n=o("ee27");o("a434"),o("a9e3"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,i,u,s=n(o("54f8")),c=n(o("9546")),l=n(o("7fd5")),d=(n(o("114b")),{data:function(){return{custom:{},user:uni.getStorageSync("user"),identity:uni.getStorageSync("identity"),Images:[],account:"",button_disabled:!1,beizhu_text:"",real_money:"",nowDay:l.default.getDay(0,!0,!0),type:"",category:""}},onLoad:function(e){r=this,a=uni.getStorageSync("uid"),r.type=e.type||"","record"==e.type&&uni.removeStorageSync("custom")},onShow:function(){if(r.custom=uni.getStorageSync("custom"),r.account=uni.getStorageSync("account"),uni.getStorageSync("category"))if(r.category=uni.getStorageSync("category"),2==r.category.type){var e=c.default.Pointer("financeFristClass");i=e.set(r.category.parent.objectId);var t=c.default.Pointer("financeSecondClass");u=t.set(r.category.objectId)}else{var o=c.default.Pointer("financeFristClass");i=o.set(r.category.objectId)}},methods:{bindDateChange:function(e){r.nowDay=e.detail.value+" 00:00:00"},removeImg:function(e){r.Images.splice(e,1),r.Images=r.Images},upload_image:function(){r.user.is_vip?uni.chooseImage({count:3,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){var t,o,n=Date.parse(new Date),a=e.tempFilePaths,i=(0,s.default)(a);try{for(i.s();!(o=i.n()).done;){var u=o.value;t=c.default.File(n+".jpg",u)}}catch(l){i.e(l)}finally{i.f()}t.save().then((function(e){var t,o=(0,s.default)(e);try{for(o.s();!(t=o.n()).done;){var n=t.value;r.Images.push(n.url)}}catch(l){o.e(l)}finally{o.f()}}))}}):uni.showToast({title:"您还不是会员，无法使用",icon:"none"})},formSubmit:function(t){var o=this;if(r.button_disabled=!0,""==uni.getStorageSync("category")||void 0==uni.getStorageSync("category"))return uni.showToast({icon:"none",title:"请选择收入类别"}),void(this.button_disabled=!1);if(""==uni.getStorageSync("account")||void 0==uni.getStorageSync("account"))return uni.showToast({icon:"none",title:"请选择收款账户"}),void(this.button_disabled=!1);if(""==r.real_money)return uni.showToast({icon:"none",title:"请输入本次收款"}),void(this.button_disabled=!1);var n=c.default.Query("accounts");n.get(r.account.objectId).then((function(t){t.set("money",t.money+Number(r.real_money)),t.save().then((function(t){var n=c.default.Pointer("accounts"),s=n.set(r.account.objectId),d=c.default.Pointer("_User"),f=d.set(a),v=uni.getStorageSync("masterId"),m=c.default.Pointer("_User"),g=m.set(v),y=c.default.Query("order_opreations");y.set("account",s),y.set("master",f),y.set("opreater",g),y.set("real_money",Number(r.real_money)),y.set("beizhu",r.beizhu_text),y.set("createdTime",{__type:"Date",iso:r.nowDay}),y.set("type",-1),y.set("extra_type",6),y.set("Images",r.Images),1==r.category.type?y.set("fristClass",i):(y.set("fristClass",i),y.set("secondClass",u)),y.save().then((function(e){o.button_disabled=!1,l.default.log(uni.getStorageSync("user").nickName+"记录了收款￥"+r.real_money+"元",6,e.objectId),uni.navigateBack({delta:1}),setTimeout((function(){uni.showToast({icon:"none",title:"收款成功"})}),1e3)})).catch((function(t){e.log(t)}))}))}))}}});t.default=d}).call(this,o("5a52")["default"])},f74c:function(e,t,o){"use strict";o.r(t);var n=o("1c60"),a=o("1a64");for(var r in a)"default"!==r&&function(e){o.d(t,e,(function(){return a[e]}))}(r);o("55ff");var i,u=o("f0c5"),s=Object(u["a"])(a["default"],n["b"],n["c"],!1,null,"1f6d5c26",null,!1,n["a"],i);t["default"]=s.exports}}]);