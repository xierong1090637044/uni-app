(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-productCount-productCount"],{"28b97":function(e,t,a){t=e.exports=a("2350")(!1),t.push([e.i,"uni-page-body[data-v-48d62012]{font-size:%?28?%;color:#3d3d3d;background:#fff}.input_goodname[data-v-48d62012]{background:#e5e5e5;border-radius:%?40?%;padding:0 %?20?%;font-size:%?24?%}.Listitem[data-v-48d62012]{width:16.66%;text-align:center;font-size:%?24?%}.bottomEle[data-v-48d62012]{position:fixed;bottom:%?0?%;-webkit-box-shadow:0 %?0?% %?10?% rgba(0,0,0,.5);box-shadow:0 %?0?% %?10?% rgba(0,0,0,.5);width:calc(100% - %?60?%);padding:%?20?% %?30?%;font-weight:700;background:#fff}.text_overflow_2[data-v-48d62012]{word-break:break-all;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.swiper-tab-list[data-v-48d62012]{height:100%;line-height:%?100?%!important}.frist_item[data-v-48d62012]{-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;width:50%}.content[data-v-48d62012]{width:100%;padding:%?10?% %?30?%;width:calc(100% - %?60?%);height:calc(100vh - %?182?%)}.content_time[data-v-48d62012]{text-align:right;color:#999}.detail_item[data-v-48d62012]{border-bottom:%?1?% solid#ccc;margin-bottom:%?10?%;padding-bottom:%?10?%}.detail_name[data-v-48d62012]{font-size:%?32?%;margin-bottom:%?6?%;font-weight:700}body.?%PAGE?%[data-v-48d62012]{background:#fff}",""])},"3fe7":function(e,t,a){"use strict";a.r(t);var n=a("98ee"),o=a("cf15");for(var i in o)"default"!==i&&function(e){a.d(t,e,function(){return o[e]})}(i);a("eb8d");var r=a("2877"),s=Object(r["a"])(o["default"],n["a"],n["b"],!1,null,"48d62012",null);t["default"]=s.exports},"751d":function(e,t,a){var n=a("28b97");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=a("4f06").default;o("2b6f91d0",n,!0,{sourceMap:!1,shadowMode:!1})},"98ee":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"uni-tab-bar"},[a("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"30rpx 0","border-bottom":"6rpx solid#DDDDDD"}},[a("v-uni-picker",{staticClass:"frist_item display_flex",attrs:{mode:"date",fields:"day",start:e.starttime},on:{change:function(t){t=e.$handleEvent(t),e.selected_startday(t)}}},[a("v-uni-text",{staticStyle:{"margin-right":"10rpx"}},[e._v(e._s(e.starttime))]),a("fa-icon",{attrs:{type:"angle-down",size:"20",color:"#999"}})],1),a("v-uni-picker",{staticClass:"frist_item display_flex",attrs:{mode:"date",fields:"day",start:e.endtime},on:{change:function(t){t=e.$handleEvent(t),e.selected_endday(t)}}},[a("v-uni-text",{staticStyle:{"margin-right":"10rpx"}},[e._v(e._s(e.endtime))]),a("fa-icon",{attrs:{type:"angle-down",size:"20",color:"#999"}})],1)],1),a("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"20rpx 30rpx"}},[a("v-uni-view",{staticClass:"input_goodname"},[a("v-uni-input",{staticStyle:{height:"60rpx"},attrs:{placeholder:"请输入产品名字"},on:{confirm:function(t){t=e.$handleEvent(t),e.seachGoodName(t)},blur:function(t){t=e.$handleEvent(t),e.seachGoodName(t)}}})],1),a("v-uni-navigator",{staticClass:"display_flex",attrs:{"hover-class":"none",url:"/pages/manage/category/category?type=choose"}},[a("v-uni-view",[a("v-uni-input",{staticStyle:{width:"140rpx"},attrs:{placeholder:"产品类别",value:e.category.class_text,disabled:"true"}})],1),a("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),a("v-uni-view",{staticStyle:{padding:"4rpx 30rpx"}},[a("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{background:"#90d7ec",padding:"10rpx 0"}},[a("v-uni-view",{staticClass:"Listitem",staticStyle:{padding:"0 10rpx"}},[e._v("产品名称")]),a("v-uni-view",{staticClass:"Listitem",staticStyle:{padding:"0 10rpx"}},[e._v("当前库存")]),a("v-uni-view",{staticClass:"Listitem"},[e._v("进")]),a("v-uni-view",{staticClass:"Listitem"},[e._v("出")]),a("v-uni-view",{staticClass:"Listitem"},[e._v("总成本")]),a("v-uni-view",{staticClass:"Listitem"},[e._v("销售额")])],1)],1),a("v-uni-scroll-view",{staticClass:"content",attrs:{"scroll-y":""}},e._l(e.dataList,function(t,n){return a("v-uni-view",{key:n,staticClass:"display_flex_bet",style:{padding:"10rpx 0;",background:n%2==0?"#f2eada":""}},[a("v-uni-view",{staticClass:"text_overflow_2  Listitem",staticStyle:{padding:"0 10rpx"}},[e._v(e._s(t.goodsId.goodsName))]),a("v-uni-view",{staticClass:"Listitem",staticStyle:{padding:"0 10rpx"}},[e._v(e._s(t.goodsId.reserve))]),a("v-uni-view",{staticClass:"Listitem"},[e._v(e._s(t._sumNum1))]),a("v-uni-view",{staticClass:"Listitem"},[e._v(e._s(t._sumNum2))]),a("v-uni-view",{staticClass:"Listitem"},[e._v(e._s(t._sumTotal_money1))]),a("v-uni-view",{staticClass:"Listitem"},[e._v(e._s(t._sumTotal_money2))])],1)}),1)],1)},o=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return o})},cf15:function(e,t,a){"use strict";a.r(t);var n=a("d460"),o=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,function(){return n[e]})}(i);t["default"]=o.a},d460:function(e,t,a){"use strict";(function(e){var n=a("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a("5d73"));a("7514");var i,r,s,u,d=n(a("c74b")),l=n(a("df06")),c={components:{},data:function(){return{starttime:"起始时间",endtime:"截止时间",dataList:[],pageSize:30,pageNum:1,is_selected:!1,searchGoodName:"",category:""}},onLoad:function(e){i=this,r=wx.getStorageSync("uid"),uni.removeStorageSync("category");var t=new Date,a=t.getFullYear(),n=t.getMonth()+1;i.starttime=a+"-"+n+"-01",i.endtime=l.default.getDay(0),s=a+"-"+n+"-01",u=l.default.getDay(0),i.getdetail()},onShow:function(){uni.getStorageSync("category")&&(i.category=uni.getStorageSync("category"),i.is_selected=!1,i.getdetail())},methods:{seachGoodName:function(e){i.is_selected=!0,i.searchGoodName=e.detail.value,i.getdetail()},selected_startday:function(e){i.starttime=e.detail.value,i.starttime==s&&i.endtime==u?i.is_selected=!1:i.is_selected=!0,i.getdetail()},selected_endday:function(e){i.endtime=e.detail.value,i.starttime==s&&i.endtime==u?i.is_selected=!1:i.is_selected=!0,i.getdetail()},getdetail:function(){uni.showLoading({title:"加载中..."});var e=d.default.Query("Bills");e.equalTo("userId","==",r),e.equalTo("createdAt",">=",i.starttime+" 00:00:00"),e.equalTo("createdAt","<=",i.endtime+" 23:59:59"),e.equalTo("goodsName","==",{$regex:i.searchGoodName+".*"});var t=e.equalTo("type","==",1),a=e.equalTo("type","==",-1);e.or(t,a),e.include("goodsId"),e.statTo("sum","num,total_money"),e.statTo("groupby","goodsId,type"),e.statTo("order","-_sumnum"),e.find().then(function(e){uni.hideLoading();var t=[],a=!0,n=!1,r=void 0;try{for(var s,u=(0,o.default)(e);!(a=(s=u.next()).done);a=!0){var d=s.value,l={};1==d.type?(l.type=1,l.goodsId=d.goodsId,l._sumNum1=d._sumNum,l._sumTotal_money1=d._sumTotal_money,l._sumNum2=0,l._sumTotal_money2=0):-1==d.type&&(l.type=-1,l.goodsId=d.goodsId,l._sumNum1=0,l._sumTotal_money1=0,l._sumNum2=d._sumNum,l._sumTotal_money2=d._sumTotal_money),t.push(l)}}catch(c){n=!0,r=c}finally{try{a||null==u.return||u.return()}finally{if(n)throw r}}i.filterRoomNames(t)})},filterRoomNames:function(t){for(var a={},n=[],s=0;s<t.length;s++){var u=t[s];if(a[u.goodsId.objectId])for(var l=0;l<n.length;l++){var c=n[l];c.goodsId.objectId==u.goodsId.objectId&&(1==c.type?(c._sumNum2=u._sumNum2,c._sumTotal_money2=u._sumTotal_money2):-1==c.type&&(c._sumNum1=u._sumNum1,c._sumTotal_money1=u._sumTotal_money1))}else n.push(u),a[u.goodsId.objectId]=u}if(i.is_selected)i.dataList=n;else{var v=[],f=[],m=d.default.Query("Goods");m.equalTo("userId","==",r),m.equalTo("status","!=",-1),1==i.category.type?m.equalTo("goodsClass","==",i.category.objectId):m.equalTo("second_class","==",i.category.objectId),m.select("goodsName,reserve"),m.limit(500),m.find().then(function(e){var t=!0,a=!1,i=void 0;try{for(var r,s=(0,o.default)(e);!(t=(r=s.next()).done);t=!0){var u=r.value,d={};d.goodsId=u,d._sumNum2=0,d._sumTotal_money2=0,d._sumNum1=0,d._sumTotal_money1=0,f.push(d),v.push(u.objectId)}}catch(m){a=!0,i=m}finally{try{t||null==s.return||s.return()}finally{if(a)throw i}}for(var l=0;l<n.length;l++){var c=n[l];v.indexOf(c.goodsId.objectId)>-1&&(f.splice(v.indexOf(c.goodsId.objectId),1),f.unshift(c))}}),e.log(f),i.dataList=f}wx.hideLoading()}}};t.default=c}).call(this,a("5a52")["default"])},df06:function(e,t,a){"use strict";(function(t){var n=a("288e");a("6b54"),a("87b3"),a("7514");var o=n(a("5d73"));a("c5f6");var i=n(a("795b")),r=n(a("c74b"));e.exports={enterAddGoodNum:function(e){return new i.default(function(a,n){for(var i=function(n){var i=0,s=r.default.Query("Goods");s.get(e[n].objectId).then(function(r){if(t.log(e[n]),e[n].selectd_model){var s=!0,u=!1,d=void 0;try{for(var l,c=(0,o.default)(e[n].selected_model);!(s=(l=c.next()).done);s=!0){var v=l.value,f=!0,m=!1,g=void 0;try{for(var y,_=(0,o.default)(e[n].models);!(f=(y=_.next()).done);f=!0){var h=y.value;h.id==v.id&&(h.reserve=Number(h.reserve)+Number(v.num)),delete h.num}}catch(p){m=!0,g=p}finally{try{f||null==_.return||_.return()}finally{if(m)throw g}}}}catch(p){u=!0,d=p}finally{try{s||null==c.return||c.return()}finally{if(u)throw d}}i=Number(e[n].reserve)+Number(e[n].num),r.set("models",e[n].models)}else i=Number(e[n].reserve)+Number(e[n].num);r.set("reserve",i),r.set("stocktype",i>e[n].warning_num?1:0),r.save(),n==e.length-1&&a(!0)}).catch(function(e){t.log(e)})},s=0;s<e.length;s++)i(s)})},outRedGoodNum:function(e){var a=this;return new i.default(function(n,i){for(var s=function(i){var s=0,u=r.default.Query("Goods");u.get(e[i].objectId).then(function(t){if(e[i].selectd_model){var r=!0,u=!1,d=void 0;try{for(var l,c=(0,o.default)(e[i].selected_model);!(r=(l=c.next()).done);r=!0){var v=l.value,f=!0,m=!1,g=void 0;try{for(var y,_=(0,o.default)(e[i].models);!(f=(y=_.next()).done);f=!0){var h=y.value;s+=Number(h.reserve),h.id==v.id&&(h.reserve=Number(h.reserve)-Number(v.num)),delete h.num}}catch(p){m=!0,g=p}finally{try{f||null==_.return||_.return()}finally{if(m)throw g}}}}catch(p){u=!0,d=p}finally{try{r||null==c.return||c.return()}finally{if(u)throw d}}s=Number(e[i].reserve)-Number(e[i].num),t.set("models",e[i].models)}else s=Number(e[i].reserve)-Number(e[i].num);t.set("reserve",s),t.set("stocktype",s>=e[i].warning_num?1:0),t.save(),e[i].warning_num>=s&&a.log(e[i].goodsName+"出库了"+e[i].num+"件，已经低于预警数量"+e[i].warning_num,-2,e[i].objectId),a.record_staffOut(Number(e[i].num)),i==e.length-1&&n(!0)}).catch(function(e){t.log(e)})},u=0;u<e.length;u++)s(u)})},handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(e,a,n){var o=r.default.Pointer("_User"),i=o.set(uni.getStorageSync("uid")),s=r.default.Query("logs");s.set("parent",i),s.set("log",e),s.set("detail_id",n),s.set("type",a),s.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})},record_shopOut:function(e,a){t.log(e,a);var n=r.default.Query("shops");n.set("id",e),n.set("have_out",a),n.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})},record_staffOut:function(e){if(t.log(e,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var a=r.default.Query("staffs");a.set("id",uni.getStorageSync("user").objectId),a.set("have_out",Number(e)+uni.getStorageSync("user").have_out),a.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}},get_allCost:function(){var e=uni.getStorageSync("uid");t.log(e);var a=r.default.Query("Goods");a.equalTo("userId","==",e),a.find().then(function(e){t.log(e);var a=!0,n=!1,i=void 0;try{for(var r,s=(0,o.default)(e);!(a=(r=s.next()).done);a=!0){var u=r.value;t.log(u),Number(u.costPrice)*u.reserve,u.reserve}}catch(d){n=!0,i=d}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}})},getDay:function(e,t){var a=this,n=new Date,o=n.getTime()+864e5*e;n.setTime(o);var i=n.getFullYear(),r=n.getMonth(),s=n.getDate();return r=a.handleMonth(r+1),s=a.handleMonth(s),t?i+"-"+r+"-"+s+" 00:00:00":i+"-"+r+"-"+s},js_date_time:function(e,t){var a=new Date(e),n=a.getFullYear(),o=a.getMonth()+1;o=o<10?"0"+o:o;var i=a.getDate();i=i<10?"0"+i:i;var r=a.getHours();r=r<10?"0"+r:r;var s=a.getMinutes(),u=a.getSeconds();return s=s<10?"0"+s:s,u=u<10?"0"+u:u,t?n+"-"+o+"-"+i+" "+r+":"+s:n+"-"+o+"-"+i},handleMonth:function(e){var t=e;return 1==e.toString().length&&(t="0"+e),t}}}).call(this,a("5a52")["default"])},eb8d:function(e,t,a){"use strict";var n=a("751d"),o=a.n(n);o.a}}]);