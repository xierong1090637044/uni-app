(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-warehouse-add-add"],{"24e4":function(e,t,a){"use strict";(function(e){var i=a("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("7514"),a("c5f6");var n,s,o,r,u,c,l=i(a("9546")),h=i(a("9ef1")),d=i(a("4d52")),f=i(a("96bd")),g={components:{faIcon:d.default,uniNavBar:f.default},data:function(){return{textDesc:"添加",user:uni.getStorageSync("user"),Images:[],warehouse_name:"",warehouse_shop:"",warehouse_num:0,warehouse_charge:"",warehouse_beizhu:"",disabled:!0}},onLoad:function(e){n=this,c=uni.getStorageSync("uid")},onShow:function(){if(s=uni.getStorageSync("warehouse"),r=uni.getStorageSync("shop"),s?(o=s.Ncharge,n.Images=s.Image||[],n.warehouse_name=s.stock_name,n.warehouse_shop=s.shop,n.warehouse_num=s.num,n.warehouse_charge=s.Ncharge.nickName,n.warehouse_beizhu=s.beizhu,n.disabled=!s.disabled,n.textDesc="修改",uni.setNavigationBarTitle({title:"修改仓库信息"})):uni.setNavigationBarTitle({title:"新增仓库"}),r){n.warehouse_shop=r.name;var e=l.default.Pointer("shops");u=e.set(r.objectId)}uni.getStorageSync("charge")&&(o=uni.getStorageSync("charge"),n.warehouse_charge=o.username)},onUnload:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("shop"),uni.removeStorageSync("charge")},methods:{removeImg:function(e){n.Images.splice(e,1),n.Images=n.Images},upload_image:function(){h.default.upload_image(1).then(function(t){e.log(t),n.Images=t})},switchChange:function(e){n.disabled=e.detail.value},start_add:function(){""==this.warehouse_name?uni.showToast({title:"请输入仓库名字",icon:"none"}):""==this.warehouse_charge||null==this.warehouse_charge?uni.showToast({title:"请选择仓库负责人",icon:"none"}):n.add_data()},add_data:function(){uni.showLoading({title:"上传中..."});var t=l.default.Pointer("_User"),a=t.set(c),i=l.default.Pointer("_User"),h=i.set(o.objectId);if(s){var d=l.default.Query("stocks");d.set("Image",n.Images),d.set("stock_name",n.warehouse_name),d.set("num",Number(n.warehouse_num?n.warehouse_num:0)),r&&d.set("shop",u),d.set("Ncharge",h),d.set("beizhu",n.warehouse_beizhu||""),d.set("disabled",!n.disabled),d.set("parent",a),d.set("id",s.objectId),d.save().then(function(t){uni.hideLoading(),e.log(t),uni.showToast({icon:"none",title:"修改成功"}),setTimeout(function(){uni.navigateBack({delta:1})},1e3)}).catch(function(t){e.log(t)})}else{var f=l.default.Query("stocks");f.equalTo("parent","==",c),f.equalTo("stock_name","==",n.warehouse_name),f.find().then(function(t){if(e.log(t),0==t.length){var i=l.default.Query("stocks");i.set("Image",n.Images),i.set("stock_name",n.warehouse_name),i.set("num",Number(n.warehouse_num)),r&&i.set("shop",u),i.set("Ncharge",h),i.set("beizhu",n.warehouse_beizhu),i.set("disabled",!n.disabled),i.set("parent",a),i.save().then(function(t){e.log(t),uni.hideLoading(),uni.showToast({title:"添加成功"}),n.warehouse_name="",n.warehouse_shop="",n.warehouse_num=0,n.warehouse_charge="",n.warehouse_beizhu="",n.disabled=!0}).catch(function(t){e.log(t)})}else uni.showToast({title:"已存在此仓库",icon:"none"})})}}}};t.default=g}).call(this,a("5a52")["default"])},"29c5":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("uni-nav-bar",{attrs:{fixed:!1,color:"#333333","background-color":"#FFFFFF","right-text":e.textDesc},on:{"click-right":function(t){arguments[0]=t=e.$handleEvent(t),e.start_add.apply(void 0,arguments)}}},[a("v-uni-view")],1),a("v-uni-view",[a("v-uni-view",{staticStyle:{"margin-top":"20px",background:"#fff",padding:"0 30rpx"}},[a("v-uni-view",{staticClass:"notice_text"},[e._v("上传仓库图(会员可用)")]),a("v-uni-view",{staticStyle:{width:"100%",padding:"20rpx 0"}},[a("v-uni-view",{staticClass:"upload_image display_flex"},[e._l(e.Images,function(t,i){return e.Images.length>0?a("v-uni-view",{key:i,staticStyle:{position:"relative"}},[a("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx"},attrs:{src:t}}),a("fa-icon",{staticStyle:{position:"absolute",top:"-10rpx",right:"-10rpx"},attrs:{type:"times-circle-o",size:"20",color:"#426ab3"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.removeImg(i)}}})],1):e._e()}),0==e.Images.length?a("v-uni-view",{staticStyle:{width:"180rpx",height:"180rpx","line-height":"220rpx","text-align":"center",border:"1rpx solid#ccc","border-radius":"16rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.upload_image.apply(void 0,arguments)}}},[a("fa-icon",{attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1):e._e()],2)],1)],1),a("v-uni-view",{staticClass:"display_flex item"},[a("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v("名称")]),a("v-uni-text",{staticStyle:{color:"#d93a49","margin-right":"20rpx"}},[e._v("*")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入名称"},model:{value:e.warehouse_name,callback:function(t){e.warehouse_name=t},expression:"warehouse_name"}})],1),a("v-uni-view",{staticClass:"display_flex item"},[a("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v("排序")]),a("v-uni-text",{staticStyle:{color:"#d93a49","margin-right":"20rpx"}},[e._v("*")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入排序(数值越大,排列越靠前)",type:"number",maxlength:"11"},model:{value:e.warehouse_num,callback:function(t){e.warehouse_num=t},expression:"warehouse_num"}})],1),a("v-uni-navigator",{staticClass:"display_flex_bet item",attrs:{"hover-class":"none",url:"../../shops/shops?type=choose"}},[a("v-uni-view",{staticClass:"display_flex"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("门店")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请选择门店"},model:{value:e.warehouse_shop,callback:function(t){e.warehouse_shop=t},expression:"warehouse_shop"}})],1),a("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#ddd"}})],1),a("v-uni-navigator",{staticClass:"display_flex_bet item",staticStyle:{"margin-bottom":"60rpx"},attrs:{"hover-class":"none",url:"../../staff/staff?type=choose"}},[a("v-uni-view",{staticClass:"display_flex"},[a("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v("负责人")]),a("v-uni-text",{staticStyle:{color:"#d93a49","margin-right":"20rpx"}},[e._v("*")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请选择负责人",disabled:"true"},model:{value:e.warehouse_charge,callback:function(t){e.warehouse_charge=t},expression:"warehouse_charge"}})],1),a("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#ddd"}})],1),a("v-uni-view",{staticClass:"display_flex item"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("备注")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入备注"},model:{value:e.warehouse_beizhu,callback:function(t){e.warehouse_beizhu=t},expression:"warehouse_beizhu"}})],1),a("v-uni-view",{staticClass:"display_flex_bet item",staticStyle:{"margin-bottom":"60rpx"}},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("启用")]),a("v-uni-switch",{attrs:{checked:e.disabled},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.switchChange.apply(void 0,arguments)}}})],1)],1)],1)},n=[];a.d(t,"a",function(){return i}),a.d(t,"b",function(){return n})},"4c8a":function(e,t,a){var i=a("886d");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("4f06").default;n("6133485c",i,!0,{sourceMap:!1,shadowMode:!1})},5915:function(e,t,a){"use strict";var i=a("4c8a"),n=a.n(i);n.a},"5cc0":function(e,t,a){"use strict";a.r(t);var i=a("24e4"),n=a.n(i);for(var s in i)"default"!==s&&function(e){a.d(t,e,function(){return i[e]})}(s);t["default"]=n.a},"886d":function(e,t,a){t=e.exports=a("2350")(!1),t.push([e.i,"uni-page-body[data-v-82e3bfd6]{background:#fafafa}.item[data-v-82e3bfd6]{padding:%?20?% %?30?%;background:#fff}.rights_item[data-v-82e3bfd6]{margin-bottom:%?20?%}body.?%PAGE?%[data-v-82e3bfd6]{background:#fafafa}",""])},"9ef1":function(e,t,a){"use strict";(function(t){var i=a("288e"),n=i(a("5d73")),s=i(a("795b")),o=i(a("9546"));e.exports={upload_image:function(e){return new s.default(function(a,i){var s=uni.getStorageSync("user"),r=[];s.is_vip?uni.chooseImage({count:e,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){t.log(e);var i,s=Date.parse(new Date),u=e.tempFilePaths,c=!0,l=!1,h=void 0;try{for(var d,f=(0,n.default)(u);!(c=(d=f.next()).done);c=!0){var g=d.value;i=o.default.File(s+".jpg",g)}}catch(v){l=!0,h=v}finally{try{c||null==f.return||f.return()}finally{if(l)throw h}}i.save().then(function(e){var t=!0,i=!1,s=void 0;try{for(var o,u=(0,n.default)(e);!(t=(o=u.next()).done);t=!0){o.value;r.push(e[0].url)}}catch(v){i=!0,s=v}finally{try{t||null==u.return||u.return()}finally{if(i)throw s}}a(r)})}}):uni.showToast({title:"您还不是会员，无法使用",icon:"none"})})}}}).call(this,a("5a52")["default"])},f80b:function(e,t,a){"use strict";a.r(t);var i=a("29c5"),n=a("5cc0");for(var s in n)"default"!==s&&function(e){a.d(t,e,function(){return n[e]})}(s);a("5915");var o=a("f0c5"),r=Object(o["a"])(n["default"],i["a"],i["b"],!1,null,"82e3bfd6",null);t["default"]=r.exports}}]);