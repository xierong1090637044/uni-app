(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-shops-add-add"],{"1d48":function(e,t,a){var n=a("45f7");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=a("4f06").default;i("4b34d1f4",n,!0,{sourceMap:!1,shadowMode:!1})},2598:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("uni-nav-bar",{attrs:{fixed:!1,color:"#333333","background-color":"#FFFFFF","right-text":"添加"},on:{"click-right":function(t){t=e.$handleEvent(t),e.start_add(t)}}},[a("v-uni-view")],1),a("v-uni-view",[a("v-uni-view",{staticStyle:{"margin-top":"20px",background:"#fff",padding:"0 30rpx"}},[a("v-uni-view",{staticClass:"notice_text"},[e._v("上传门店图(会员可用)")]),a("v-uni-view",{staticStyle:{width:"100%",padding:"20rpx 0"}},[a("v-uni-view",{staticClass:"upload_image display_flex"},[e._l(e.Images,function(t,n){return e.Images.length>0?a("v-uni-view",{key:n,staticStyle:{position:"relative"}},[a("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx"},attrs:{src:t}}),a("fa-icon",{staticStyle:{position:"absolute",top:"-10rpx",right:"-10rpx"},attrs:{type:"times-circle-o",size:"20",color:"#426ab3"},on:{click:function(t){t=e.$handleEvent(t),e.removeImg(n)}}})],1):e._e()}),0==e.Images.length?a("v-uni-view",{staticStyle:{width:"180rpx",height:"180rpx","line-height":"220rpx","text-align":"center",border:"1rpx solid#ccc","border-radius":"16rpx"},on:{click:function(t){t=e.$handleEvent(t),e.upload_image(t)}}},[a("fa-icon",{attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1):e._e()],2)],1)],1),a("v-uni-view",{staticClass:"display_flex item"},[a("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v("门店名字")]),a("v-uni-text",{staticStyle:{color:"#d93a49","margin-right":"20rpx"}},[e._v("*")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入门店名字"},model:{value:e.shop_name,callback:function(t){e.shop_name=t},expression:"shop_name"}})],1),a("v-uni-view",{staticClass:"display_flex item"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("门店地址")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入门店地址"},model:{value:e.shop_address,callback:function(t){e.shop_address=t},expression:"shop_address"}})],1),a("v-uni-view",{staticClass:"display_flex item"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("门店电话")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入门店电话",type:"number",maxlength:"11"},model:{value:e.shop_phone,callback:function(t){e.shop_phone=t},expression:"shop_phone"}})],1),a("v-uni-view",{staticClass:"display_flex item"},[a("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v("排序")]),a("v-uni-text",{staticStyle:{color:"#d93a49","margin-right":"20rpx"}},[e._v("*")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入排序(数值越小,排列越靠前)",type:"number",maxlength:"11"},model:{value:e.shop_num,callback:function(t){e.shop_num=t},expression:"shop_num"}})],1),a("v-uni-view",{staticClass:"display_flex_bet item",staticStyle:{"margin-bottom":"60rpx"}},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("启用")]),a("v-uni-switch",{attrs:{checked:e.disabled},on:{change:function(t){t=e.$handleEvent(t),e.switchChange(t)}}})],1),a("v-uni-view",{staticClass:"display_flex item"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("备注")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入备注"},model:{value:e.shop_beizhu,callback:function(t){e.shop_beizhu=t},expression:"shop_beizhu"}})],1)],1)],1)},i=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return i})},"45f7":function(e,t,a){t=e.exports=a("2350")(!1),t.push([e.i,"uni-page-body[data-v-0ab42476]{background:#fafafa}.item[data-v-0ab42476]{padding:%?20?% %?30?%;background:#fff}.rights_item[data-v-0ab42476]{margin-bottom:%?20?%}body.?%PAGE?%[data-v-0ab42476]{background:#fafafa}",""])},5693:function(e,t,a){"use strict";var n=a("1d48"),i=a.n(n);i.a},6503:function(e,t,a){"use strict";a.r(t);var n=a("2598"),i=a("e7e9");for(var s in i)"default"!==s&&function(e){a.d(t,e,function(){return i[e]})}(s);a("5693");var o=a("2877"),u=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"0ab42476",null);t["default"]=u.exports},d332:function(e,t,a){"use strict";(function(e){var n=a("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("7514"),a("c5f6"),a("7f7f");var i,s,o,u=n(a("c74b")),r=n(a("e601")),l=n(a("0914")),c=n(a("b92d")),d={components:{faIcon:l.default,uniNavBar:c.default},data:function(){return{user:uni.getStorageSync("user"),Images:[],disabled:!0,shop_name:"",shop_address:"",shop_num:0,shop_phone:"",shop_beizhu:""}},onLoad:function(e){i=this,o=uni.getStorageSync("uid")},onShow:function(){s=uni.getStorageSync("shop"),s?(uni.setNavigationBarTitle({title:"修改门店"}),i.Images=s.Image,i.shop_name=s.name,i.shop_address=s.address,i.shop_phone=s.phone,i.shop_num=s.num,i.shop_beizhu=s.beizhu):uni.setNavigationBarTitle({title:"新增门店"})},onUnload:function(){uni.removeStorageSync("shop")},methods:{removeImg:function(e){i.Images.splice(e,1),i.Images=i.Images},upload_image:function(){r.default.upload_image(1).then(function(t){e.log(t),i.Images=t})},switchChange:function(e){i.disabled=e.detail.value},start_add:function(){""==this.shop_name?uni.showToast({title:"请输入门店名字",icon:"none"}):i.add_data()},add_data:function(){uni.showLoading({title:"上传中..."});var t=u.default.Pointer("_User"),a=t.set(o);if(s){var n=u.default.Query("shops");n.set("Image",i.Images),n.set("name",i.shop_name),n.set("num",Number(i.shop_num)),n.set("address",i.shop_address),n.set("phone",i.shop_phone),n.set("beizhu",i.shop_beizhu),n.set("parent",a),n.set("disabled",!i.disabled),n.set("id",s.objectId),n.save().then(function(t){uni.hideLoading(),e.log(t),uni.showToast({title:"修改成功"})}).catch(function(t){e.log(t)})}else{var r=u.default.Query("shops");r.equalTo("parent","==",o),r.equalTo("name","==",i.shop_name),r.find().then(function(t){if(e.log(t),0==t.length){var n=u.default.Query("shops");n.set("Image",i.Images),n.set("name",i.shop_name),n.set("num",Number(i.shop_num)),n.set("address",i.shop_address),n.set("phone",i.shop_phone),n.set("beizhu",i.shop_beizhu),n.set("have_out",0),n.set("disabled",!i.disabled),n.set("parent",a),n.save().then(function(t){e.log(t),uni.hideLoading(),uni.showToast({title:"添加成功"}),i.disabled=!0,i.shop_name="",i.shop_address="",i.shop_num=0,i.shop_phone="",i.shop_beizhu=""}).catch(function(t){e.log(t)})}else uni.showToast({title:"已存在此门店",icon:"none"})})}}}};t.default=d}).call(this,a("5a52")["default"])},e601:function(e,t,a){"use strict";(function(t){var n=a("288e"),i=n(a("5d73")),s=n(a("795b")),o=n(a("c74b"));e.exports={upload_image:function(e){return new s.default(function(a,n){var s=uni.getStorageSync("user"),u=[];s.is_vip?uni.chooseImage({count:e,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){t.log(e);var n,s=Date.parse(new Date),r=e.tempFilePaths,l=!0,c=!1,d=void 0;try{for(var p,h=(0,i.default)(r);!(l=(p=h.next()).done);l=!0){var f=p.value;n=o.default.File(s+".jpg",f)}}catch(v){c=!0,d=v}finally{try{l||null==h.return||h.return()}finally{if(c)throw d}}n.save().then(function(e){var t=!0,n=!1,s=void 0;try{for(var o,r=(0,i.default)(e);!(t=(o=r.next()).done);t=!0){o.value;u.push(e[0].url)}}catch(v){n=!0,s=v}finally{try{t||null==r.return||r.return()}finally{if(n)throw s}}a(u)})}}):uni.showToast({title:"您还不是会员，无法使用",icon:"none"})})}}}).call(this,a("5a52")["default"])},e7e9:function(e,t,a){"use strict";a.r(t);var n=a("d332"),i=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,function(){return n[e]})}(s);t["default"]=i.a}}]);