(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-finance-otherHistory-outRecord-outRecord"],{"311a":function(t,e,i){"use strict";i.r(e);var a=i("de57"),n=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=n.a},4991:function(t,e,i){"use strict";var a,n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",{staticClass:"page"},[i("v-uni-form",{attrs:{"report-submit":"true"},on:{submit:function(e){arguments[0]=e=t.$handleEvent(e),t.formSubmit.apply(void 0,arguments)}}},[i("v-uni-view",{staticStyle:{margin:"30rpx 0"}},[i("v-uni-view",{staticStyle:{margin:"0 0 10rpx 10rpx","font-size":"32rpx",color:"#333","font-weight":"bold"}},[t._v("基本信息")]),i("v-uni-view",{staticClass:"kaidan_detail",staticStyle:{"line-height":"70rpx"}},[i("v-uni-view",[i("v-uni-navigator",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0","border-bottom":"1rpx solid#F7F7F7"},attrs:{"hover-class":"none",url:"/pages/finance/myData/outClass/outClass?type=choose"}},[i("v-uni-view",{staticStyle:{width:"160rpx"}},[t._v("支出类别"),i("v-uni-text",{staticStyle:{color:"#f30"}},[t._v("*")])],1),i("v-uni-view",{staticClass:"kaidan_rightinput display_flex",staticStyle:{width:"100%","justify-content":"flex-end"}},[i("v-uni-input",{staticStyle:{"text-align":"right","margin-right":"20rpx"},attrs:{placeholder:"选择支出类别",disabled:"true",value:t.category.class_text}}),i("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1)],1),i("v-uni-navigator",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 0","border-bottom":"1rpx solid#F7F7F7"},attrs:{"hover-class":"none",url:"/pages/finance/myData/account/account?type=choose"}},[i("v-uni-view",{staticStyle:{width:"140rpx"}},[t._v("付款账户"),i("v-uni-text",{staticStyle:{color:"#f30"}},[t._v("*")])],1),i("v-uni-view",{staticClass:"kaidan_rightinput display_flex",staticStyle:{"justify-content":"flex-end"}},[i("v-uni-input",{staticStyle:{"text-align":"right","margin-right":"20rpx"},attrs:{placeholder:"选择付款账户",disabled:"true",value:t.account?t.account.name:""}}),i("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),i("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 0","border-bottom":"1rpx solid#F7F7F7"}},[i("v-uni-view",[t._v("本次付款"),i("v-uni-text",{staticStyle:{"font-size":"20rpx",color:"#f30"}},[t._v("*")])],1),i("v-uni-view",{staticClass:"kaidan_rightinput",staticStyle:{"text-align":"right"}},[i("v-uni-input",{staticStyle:{color:"#d71345"},attrs:{placeholder:"输入实际付款金额",type:"digit"},model:{value:t.real_money,callback:function(e){t.real_money=e},expression:"real_money"}})],1)],1),i("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 0","border-bottom":"1rpx solid#F7F7F7"}},[i("v-uni-view",{staticStyle:{width:"140rpx"}},[t._v("付款日期")]),i("v-uni-picker",{attrs:{mode:"date",value:t.nowDay,end:t.nowDay},on:{change:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.bindDateChange.apply(void 0,arguments)},click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",{staticStyle:{"margin-right":"20rpx"}},[t._v(t._s(t.nowDay.split(" ")[0]))]),i("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1)],1),i("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 0","border-bottom":"1rpx solid#F7F7F7"}},[i("v-uni-view",{staticStyle:{width:"140rpx"}},[t._v("备注")]),i("v-uni-input",{staticClass:"beizhu_style",attrs:{placeholder:"请输入备注",name:"input_beizhu"},model:{value:t.beizhu_text,callback:function(e){t.beizhu_text=e},expression:"beizhu_text"}})],1)],1)],1),i("v-uni-view",{staticStyle:{"margin-top":"20px",background:"#fff",padding:"10rpx"}},[i("v-uni-view",{staticClass:"notice_text"},[t._v("上传凭证图(会员可用)")]),i("v-uni-view",{staticStyle:{width:"100%",padding:"20rpx 0"}},[i("v-uni-view",{staticClass:"upload_image display_flex"},[t._l(t.Images,(function(e,a){return t.Images&&t.Images.length>0?i("v-uni-view",{key:a,staticStyle:{position:"relative"}},[i("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx","margin-right":"10rpx"},attrs:{src:e}}),i("fa-icon",{staticStyle:{position:"absolute",top:"-10rpx",right:"-10rpx"},attrs:{type:"times-circle-o",size:"20",color:"#426ab3"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.removeImg(a)}}})],1):t._e()})),t.Images.length<3?i("v-uni-view",{staticStyle:{width:"180rpx",height:"180rpx","line-height":"220rpx","text-align":"center",border:"1rpx solid#ccc","border-radius":"16rpx"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.upload_image.apply(void 0,arguments)}}},[i("fa-icon",{attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1):t._e()],2)],1)],1),i("v-uni-view",{staticClass:"bottomEle display_flex_bet",staticStyle:{padding:"0 30rpx","margin-top":"60rpx"}},[i("v-uni-view",[i("v-uni-text",[t._v("本次付款：￥"+t._s(t.real_money||0))])],1),i("v-uni-view",{staticClass:"display_flex"},[i("v-uni-button",{staticClass:"confrim_button",staticStyle:{background:"#426ab3"},attrs:{disabled:t.button_disabled,"form-type":"submit","data-type":"1"}},[t._v("生成付款单")])],1)],1)],1)],1)],1)},o=[];i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return a}))},d10b:function(t,e,i){var a=i("d422");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("7334cf92",a,!0,{sourceMap:!1,shadowMode:!1})},d422:function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,".page[data-v-d73b2e20]{color:#4d4d4d;font-size:%?28?%;height:calc(100vh - %?110?%);overflow:scroll}.bottomEle[data-v-d73b2e20]{position:fixed;bottom:0;left:0;width:calc(100% - %?30?%);background:#fafafa;padding:%?20?% %?0?% %?20?% %?30?%;font-weight:700}.pro_list[data-v-d73b2e20]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.pro_listitem[data-v-d73b2e20]{background-color:#fff;padding:%?10?% %?20?%;border-bottom:%?1?% solid#ddd}.pro_allmoney[data-v-d73b2e20]{background-color:#fff;padding:%?10?% %?20?%;text-align:right;font-size:%?32?%;color:#f30}.beizhu_style[data-v-d73b2e20]{text-align:right;width:calc(100% - %?40?%);background-color:#fff;max-height:%?100?%;padding:%?10?% 0}.confrim_button[data-v-d73b2e20]{background:#1651aa;color:#fff;font-weight:700;font-size:%?32?%;border-radius:unset;padding:0 %?50?%}",""]),t.exports=e},d8c1:function(t,e,i){"use strict";var a=i("d10b"),n=i.n(a);n.a},de57:function(t,e,i){"use strict";(function(t){var a=i("ee27");i("a434"),i("a9e3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,o,r,s,c=a(i("54f8")),l=a(i("9546")),u=a(i("7fd5")),d=(a(i("7faa")),{data:function(){return{producer:{},user:uni.getStorageSync("user"),identity:uni.getStorageSync("identity"),Images:[],account:"",button_disabled:!1,beizhu_text:"",real_money:"",nowDay:u.default.getDay(0,!0,!0),type:"",category:""}},onLoad:function(t){o=this,n=uni.getStorageSync("uid"),o.type=t.type||"","record"==t.type&&uni.removeStorageSync("producer")},onShow:function(){if(o.producer=uni.getStorageSync("producer"),o.account=uni.getStorageSync("account"),uni.getStorageSync("category"))if(o.category=uni.getStorageSync("category"),2==o.category.type){var t=l.default.Pointer("financeFristClass");r=t.set(o.category.parent.objectId);var e=l.default.Pointer("financeSecondClass");s=e.set(o.category.objectId)}else{var i=l.default.Pointer("financeFristClass");r=i.set(o.category.objectId)}},methods:{bindDateChange:function(t){o.nowDay=t.detail.value+" 00:00:00"},removeImg:function(t){o.Images.splice(t,1),o.Images=o.Images},upload_image:function(){o.user.is_vip?uni.chooseImage({count:3,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){var e,i,a=Date.parse(new Date),n=t.tempFilePaths,r=(0,c.default)(n);try{for(r.s();!(i=r.n()).done;){var s=i.value;e=l.default.File(a+".jpg",s)}}catch(u){r.e(u)}finally{r.f()}e.save().then((function(t){var e,i=(0,c.default)(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;o.Images.push(a.url)}}catch(u){i.e(u)}finally{i.f()}}))}}):uni.showToast({title:"您还不是会员，无法使用",icon:"none"})},formSubmit:function(e){var i=this;if(o.button_disabled=!0,""==uni.getStorageSync("category")||void 0==uni.getStorageSync("category"))return uni.showToast({icon:"none",title:"请选择支出类别"}),void(this.button_disabled=!1);if(""==uni.getStorageSync("account")||void 0==uni.getStorageSync("account"))return uni.showToast({icon:"none",title:"请选择付款账户"}),void(this.button_disabled=!1);if(""==o.real_money)return uni.showToast({icon:"none",title:"请输入本次付款"}),void(this.button_disabled=!1);var a=l.default.Query("accounts");a.get(o.account.objectId).then((function(e){e.set("money",e.money-Number(o.real_money)),e.save().then((function(e){var a=l.default.Pointer("accounts"),c=a.set(o.account.objectId),d=l.default.Pointer("_User"),p=d.set(n),f=uni.getStorageSync("masterId"),v=l.default.Pointer("_User"),g=v.set(f),y=l.default.Query("order_opreations");y.set("account",c),y.set("master",p),y.set("opreater",g),y.set("real_money",Number(o.real_money)),y.set("beizhu",o.beizhu_text),y.set("createdTime",{__type:"Date",iso:o.nowDay}),y.set("type",1),y.set("extra_type",6),y.set("Images",o.Images),1==o.category.type?y.set("fristClass",r):y.set("secondClass",s),y.save().then((function(t){i.button_disabled=!1,uni.removeStorageSync("account"),o.producer=t,u.default.log(uni.getStorageSync("user").nickName+"记录了付款￥"+o.real_money+"元",6,t.objectId),uni.navigateBack({delta:1}),setTimeout((function(){uni.showToast({icon:"none",title:"付款成功"})}),1e3)})).catch((function(e){t.log(e)}))}))}))}}});e.default=d}).call(this,i("5a52")["default"])},e444:function(t,e,i){"use strict";i.r(e);var a=i("4991"),n=i("311a");for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);i("d8c1");var r,s=i("f0c5"),c=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"d73b2e20",null,!1,a["a"],r);e["default"]=c.exports}}]);