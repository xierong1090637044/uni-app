(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-common-goods-select-goods-select"],{"0bd2":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"page"},[t.loading?i("loading"):i("v-uni-view",{staticClass:"content"},[i("uni-nav-bar",{attrs:{fixed:!1,color:"#333333","background-color":"#FFFFFF","right-text":"确定","left-text":"筛选"},on:{"click-left":function(e){e=t.$handleEvent(e),t.shaixuan(e)},"click-right":function(e){e=t.$handleEvent(e),t.confrim_this(e)}}},[i("v-uni-view",{staticClass:"input-view"},[i("uni-icon",{attrs:{type:"search",size:"22",color:"#666666"}}),i("v-uni-input",{staticClass:"input",attrs:{"confirm-type":"search",type:"text",placeholder:"输入搜索关键词"},on:{confirm:function(e){e=t.$handleEvent(e),t.confirm(e)}}})],1)],1),i("v-uni-view",{staticClass:"display_flex good_option_view"},[i("v-uni-view",{staticClass:"good_option",on:{click:function(e){e=t.$handleEvent(e),t.selectd("createdAt")}}},[i("v-uni-text",{class:"createdAt"==t.checked_option?"option_selected":""},[t._v("创建时间")]),"createdAt"==t.checked_option?i("fa-icon",{attrs:{type:"check",size:"20",color:"#1d953f"}}):t._e()],1),i("v-uni-view",{staticClass:"good_option",on:{click:function(e){e=t.$handleEvent(e),t.selectd("goodsName")}}},[i("v-uni-text",{class:"goodsName"==t.checked_option?"option_selected":""},[t._v("名字")]),"goodsName"==t.checked_option?i("fa-icon",{attrs:{type:"check",size:"20",color:"#1d953f"}}):t._e()],1),i("v-uni-view",{staticClass:"good_option",on:{click:function(e){e=t.$handleEvent(e),t.selectd("reserve")}}},[i("v-uni-text",{class:"reserve"==t.checked_option?"option_selected":""},[t._v("库存")]),"reserve"==t.checked_option?i("fa-icon",{attrs:{type:"check",size:"20",color:"#1d953f"}}):t._e()],1)],1),i("v-uni-view",{staticClass:"uni-product-list"},[t.productList.length>0?i("v-uni-scroll-view",{staticClass:"uni-product-list",attrs:{"scroll-y":""}},[i("v-uni-checkbox-group",{on:{change:function(e){e=t.$handleEvent(e),t.radioChange(e)}}},t._l(t.productList,function(e,o){return i("v-uni-view",{key:o,staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",[i("v-uni-checkbox",{staticClass:"round blue",staticStyle:{transform:"scale(0.9)"},attrs:{value:JSON.stringify(e),color:"#426ab3",data:o,id:""+o,checked:e.checked}})],1),i("v-uni-label",{staticClass:"uni-product",attrs:{for:""+o}},[i("v-uni-view",[e.goodsIcon?i("v-uni-image",{staticClass:"product_image",attrs:{src:e.goodsIcon,mode:"widthFix","lazy-load":"true"}}):i("v-uni-image",{staticClass:"product_image",attrs:{src:"/static/goods-default.png",mode:"widthFix","lazy-load":"true"}})],1),i("v-uni-view",{staticStyle:{"margin-left":"20rpx",width:"100%","line-height":"40rpx"}},[i("v-uni-view",{staticClass:"product_name",staticStyle:{"font-size":"30rpx"}},[t._v(t._s(e.goodsName))]),e.stocks?i("v-uni-view",{staticClass:"product_reserve"},[e.stocks.stock_name?i("v-uni-view",[t._v("所存仓库:"),i("v-uni-text",{staticClass:"text_notice"},[t._v(t._s(e.stocks.stock_name))])],1):t._e()],1):t._e(),e.packageContent&&e.packingUnit?i("v-uni-view",{staticClass:"product_reserve"},[t._v("规格:"),i("v-uni-text",{staticClass:"text_notice"},[t._v(t._s(e.packageContent)+"*"+t._s(e.packingUnit))])],1):t._e(),i("v-uni-view",{staticClass:"product_reserve"},[t._v("库存数量:"),i("v-uni-text",{staticClass:"text_notice"},[t._v(t._s(e.reserve))])],1),i("v-uni-view",{staticClass:"product_reserve"},[t._v("创建时间:"),i("v-uni-text",{staticClass:"text_notice"},[t._v(t._s(e.createdAt))])],1)],1)],1)],1)}),1)],1):i("nocontent",{attrs:{type:1}})],1),i("v-uni-view",{staticStyle:{padding:"6rpx 0","border-top":"1rpx solid#ddd"}},[i("uni-pagination",{attrs:{"show-icon":!0,total:"100000",current:t.page_num},on:{change:function(e){e=t.$handleEvent(e),t.change_page(e)}}})],1)],1),t.showOptions?i("v-uni-view",{staticClass:"modal_background"},[i("v-uni-view",{staticClass:"showOptions"},[i("v-uni-navigator",{staticClass:"input_item1",attrs:{"hover-class":"none",url:"/pages/manage/category/category?type=choose"}},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center",width:"100%"}},[i("v-uni-view",{staticClass:"left_item"},[t._v("类别")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"产品类别",value:t.category.class_text,disabled:"true"}})],1)],1),i("v-uni-view",[i("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),i("v-uni-navigator",{staticClass:"input_item1",attrs:{"hover-class":"none",url:"/pages/manage/warehouse/warehouse?type=choose"}},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center",width:"100%"}},[i("v-uni-view",{staticClass:"left_item"},[t._v("仓库")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"存放仓库",value:t.stock.stock_name,disabled:"true"}})],1)],1),i("v-uni-view",[i("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),i("v-uni-view",{staticClass:"option_bottom"},[i("v-uni-view",{staticClass:"selection",on:{click:function(e){e=t.$handleEvent(e),t.option_reset(e)}}},[t._v("重置")]),i("v-uni-view",{staticClass:"selection1",on:{click:function(e){e=t.$handleEvent(e),t.option_confrim(e)}}},[t._v("确定")])],1)],1)],1):t._e(),t.models_good?i("v-uni-view",{staticClass:"custom_mask",on:{click:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.hide_mask(e)}}},[i("v-uni-view",{staticClass:"custom_mask_content"},[i("v-uni-view",{staticClass:"display_flex",staticStyle:{padding:"0 0 20rpx","border-bottom":"1rpx solid#ccc"}},[t.models_good.goodsIcon?i("v-uni-image",{staticClass:"product_image",attrs:{src:t.models_good.goodsIcon,mode:"widthFix","lazy-load":"true"}}):i("v-uni-image",{staticClass:"product_image",attrs:{src:"/static/goods-default.png",mode:"widthFix","lazy-load":"true"}}),i("v-uni-view",{staticStyle:{"margin-left":"20rpx"}},[i("v-uni-view",[t._v(t._s(t.models_good.goodsName))]),i("v-uni-view",{staticStyle:{"font-size":"24rpx",color:"#999"}},[t._v("总库存:"+t._s(t.models_good.reserve))])],1)],1),i("v-uni-view",{on:{click:function(e){e.stopPropagation(),e=t.$handleEvent(e)}}},[i("v-uni-checkbox-group",{on:{change:function(e){e=t.$handleEvent(e),t.modelChange(e)}}},t._l(t.models_good.models,function(e,o){return i("v-uni-view",{key:o,staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",[i("v-uni-checkbox",{staticClass:"round blue",staticStyle:{transform:"scale(0.9)"},attrs:{value:JSON.stringify(e),color:"#426ab3",data:o,id:"s"+o}})],1),i("v-uni-label",{staticClass:"uni-product",attrs:{for:"s"+o}},[i("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{width:"100%"}},[i("v-uni-view",{staticClass:"display_flex"},[e.custom1.value?i("v-uni-view",[t._v(t._s(e.custom1.value))]):t._e(),e.custom2.value?i("v-uni-view",{staticStyle:{"margin-left":"6rpx"}},[t._v(t._s(e.custom2.value))]):t._e(),e.custom3.value?i("v-uni-view",{staticStyle:{"margin-left":"6rpx"}},[t._v(t._s(e.custom3.value))]):t._e(),e.custom4.value?i("v-uni-view",{staticStyle:{"margin-left":"6rpx"}},[t._v(t._s(e.custom4.value))]):t._e()],1),i("v-uni-view",[t._v("库存:"+t._s(e.reserve))])],1)],1)],1)}),1)],1),i("v-uni-view",{staticStyle:{"margin-top":"100rpx"}},[i("v-uni-button",{staticClass:"confrim_button",on:{click:function(e){e=t.$handleEvent(e),t.confrim_thismodel()}}},[t._v("确认")])],1)],1)],1):t._e()],1)},n=[];i.d(e,"a",function(){return o}),i.d(e,"b",function(){return n})},"3fed":function(t,e,i){"use strict";i.r(e);var o=i("0bd2"),n=i("82b9");for(var a in n)"default"!==a&&function(t){i.d(e,t,function(){return n[t]})}(a);i("afe0");var s=i("2877"),c=Object(s["a"])(n["default"],o["a"],o["b"],!1,null,"48f8350e",null);e["default"]=c.exports},"82b9":function(t,e,i){"use strict";i.r(e);var o=i("9e56"),n=i.n(o);for(var a in o)"default"!==a&&function(t){i.d(e,t,function(){return o[t]})}(a);e["default"]=n.a},"8d2c":function(t,e,i){var o=i("e9e7");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var n=i("4f06").default;n("7e31bab6",o,!0,{sourceMap:!1,shadowMode:!1})},"9e56":function(t,e,i){"use strict";var o=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("7514");var n,a,s=o(i("5d73")),c=o(i("f499")),r=o(i("00eb")),l=o(i("b841")),u=o(i("e081")),d=o(i("c8e0")),v=o(i("11b1")),f=[],g=[],p=[],_="",h=30,m=1,y={components:{loading:l.default,uniNavBar:u.default,faIcon:r.default,uniIcon:d.default,uniPagination:v.default},data:function(){return{selectd_model:"",models_good:"",models_good_key:"",page_num:1,search_text:"",url:null,showOptions:!1,loading:!0,productList:null,checked_option:"createdAt",category:"",stock:"",type:""}},onLoad:function(t){a=this,this.handle_data(),"entering"==t.type?this.url="../good_confrim/good_confrim":"delivery"==t.type?this.url="../goods_out/goods_out":"returing"==t.type?this.url="../good_return/good_return":"counting"==t.type?this.url="../good_count/good_count":"allocation"==t.type&&(this.url="../good_allocation/good_allocation"),this.type=t.type,n=uni.getStorageSync("uid"),a.get_productList()},onShow:function(){uni.removeStorageSync("products"),uni.getStorageSync("category")&&(a.showOptions=!0,a.category=uni.getStorageSync("category")),uni.getStorageSync("warehouse")&&(a.showOptions=!0,a.stock=uni.getStorageSync("warehouse")[uni.getStorageSync("warehouse").length-1].stock),uni.getStorageSync("is_option")&&(this.productList=[],a.get_productList())},onHide:function(){_="",h=30,f=[],p=[],g=[],uni.removeStorageSync("is_option")},methods:{hide_mask:function(){a.models_good=""},change_page:function(t){m=t.current,a.get_productList()},shaixuan:function(){a.showOptions=!0},confirm:function(t){_=t.detail.value,a.search_text=t.detail.value,a.page_num=1,m=1,a.get_productList()},confrim_this:function(){this.go_goodsconfrim()},option_reset:function(){this.productList=[],uni.removeStorageSync("category"),uni.removeStorageSync("warehouse"),a.category="",a.stock="",a.showOptions=!1,a.get_productList()},option_confrim:function(){this.productList=[],uni.getStorageSync("category")&&(a.category=uni.getStorageSync("category")),uni.getStorageSync("warehouse")&&(a.stock=uni.getStorageSync("warehouse")[uni.getStorageSync("warehouse").length-1].stock),a.showOptions=!1,a.get_productList()},selectd:function(t){h=30,a.checked_option=t,a.get_productList()},modelChange:function(t){a.selectd_model=t.detail.value,console.log(t.detail.value)},confrim_thismodel:function(){if(a.selectd_model){console.log(a.models_good);var t=a.models_good.key;p.splice(a.models_good_key-1,1),a.models_good.is_selected=!0,a.models_good.selectd_model=(0,c.default)(a.selectd_model),p.push((0,c.default)(a.models_good)),a.productList.splice(t,1,a.models_good),a.models_good=""}else uni.showToast({title:"请选择规格",icon:"none"})},radioChange:function(t){console.log(t);var e=0;if(_?g[m-1]=t.detail.value:f[m-1]=t.detail.value,p=g.concat(f),p=p.reduce(function(t,e){return t.concat(e)}),"allocation"!=this.type){var i=!0,o=!1,n=void 0;try{for(var c,r=(0,s.default)(p);!(i=(c=r.next()).done);i=!0){var l=c.value;l=JSON.parse(l),console.log(l),e+=1,l.models&&l.models.length>0&&1!=l.is_selected&&(a.models_good=l,a.models_good_key=e)}}catch(u){o=!0,n=u}finally{try{i||null==r.return||r.return()}finally{if(o)throw n}}}},go_goodsconfrim:function(){console.log(p),0==p.length?uni.showToast({title:"请选择产品",icon:"none"}):"allocation"==this.type?this.stock?this.confrim_next():uni.showToast({title:"请在筛选中选择调拨的仓库",icon:"none"}):"counting"==this.type?this.stock?this.confrim_next():uni.showToast({title:"请在筛选中选择要盘点的仓库",icon:"none"}):this.confrim_next()},confrim_next:function(){var t=0;if("entering"==this.type){var e=!0,i=!1,o=void 0;try{for(var n,a=(0,s.default)(p);!(e=(n=a.next()).done);e=!0){var c=n.value;p[t]=JSON.parse(c),p[t].num=1,p[t].total_money=1*p[t].costPrice,p[t].modify_retailPrice=p[t].costPrice,t+=1}}catch(g){i=!0,o=g}finally{try{e||null==a.return||a.return()}finally{if(i)throw o}}}else{var r=!0,l=!1,u=void 0;try{for(var d,v=(0,s.default)(p);!(r=(d=v.next()).done);r=!0){var f=d.value;p[t]=JSON.parse(f),p[t].num=1,p[t].total_money=1*p[t].retailPrice,p[t].modify_retailPrice=p[t].retailPrice,t+=1}}catch(g){l=!0,u=g}finally{try{r||null==v.return||v.return()}finally{if(l)throw u}}}uni.setStorageSync("products",p),uni.navigateTo({url:this.url})},get_productList:function(){var t=this;a.productList=[];var e=Bmob.Query("Goods");e.include("stocks"),e.equalTo("userId","==",n),e.equalTo("stocks","==",a.stock.objectId),e.equalTo("status","!=",-1),e.equalTo("second_class","==",a.category.objectId);var i=e.equalTo("goodsName","==",{$regex:_+".*"}),o=e.equalTo("packageContent","==",{$regex:_+".*"});e.or(i,o),e.limit(h),e.skip(h*(m-1)),e.order("-"+a.checked_option),e.find().then(function(e){var i=0;if(p.length>=1){var o=!0,n=!1,a=void 0;try{for(var c,r=(0,s.default)(p);!(o=(c=r.next()).done);o=!0){var l=c.value,u=!0,d=!1,v=void 0;try{for(var f,g=(0,s.default)(e);!(u=(f=g.next()).done);u=!0){var _=f.value;_.objectId==JSON.parse(l).objectId&&(_.checked=!0,_.key=i,i+=1)}}catch(b){d=!0,v=b}finally{try{u||null==g.return||g.return()}finally{if(d)throw v}}}}catch(b){n=!0,a=b}finally{try{o||null==r.return||r.return()}finally{if(n)throw a}}}else{var h=!0,m=!1,y=void 0;try{for(var w,x=(0,s.default)(e);!(h=(w=x.next()).done);h=!0){var k=w.value;k.key=i,i+=1}}catch(b){m=!0,y=b}finally{try{h||null==x.return||x.return()}finally{if(m)throw y}}}t.productList=e,t.loading=!1})},handle_data:function(){uni.removeStorageSync("category"),uni.removeStorageSync("warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("shop"),_="",h=30}}};e.default=y},afe0:function(t,e,i){"use strict";var o=i("8d2c"),n=i.n(o);n.a},e9e7:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,"uni-page-body[data-v-48f8350e]{background:#fff}.text_notice[data-v-48f8350e]{margin-left:%?6?%}.custom_mask[data-v-48f8350e]{position:fixed;top:0;left:0;width:100%;height:100vh;z-index:1;background-color:rgba(0,0,0,.3)}.confrim_button[data-v-48f8350e]{background:#aa2116;color:#fff;font-weight:700;font-size:%?32?%}.custom_mask_content[data-v-48f8350e]{position:fixed;bottom:0;left:0;width:calc(100% - %?60?%);z-index:10;background:#fff;padding:%?30?%}.content[data-v-48f8350e]{height:100%;overflow:hidden}.uni-product-list[data-v-48f8350e]{padding:0 %?10?%;width:calc(100% - %?20?%);height:calc(100vh - %?236?%)}.uni-product[data-v-48f8350e]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:%?10?% 0;border-bottom:1px solid#ddd;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;width:100%;margin-left:%?20?%}.product_image[data-v-48f8350e]{width:%?80?%;height:%?80?%}.product_name[data-v-48f8350e]{font-weight:700;color:#333}.product_reserve[data-v-48f8350e]{color:#6c757d;font-size:%?24?%;font-weight:700}.title[data-v-48f8350e]{font-size:15px;line-height:20px;color:#333;padding:15px}.city[data-v-48f8350e]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;width:100%;margin-left:8px;white-space:nowrap}.input-view[data-v-48f8350e]{width:92%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;background-color:#e7e7e7;height:30px;border-radius:15px;padding:0 4%;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;margin:%?8?% 0;line-height:30px}.input-view .uni-icon[data-v-48f8350e]{line-height:30px!important}.input-view .input[data-v-48f8350e]{height:30px;line-height:30px;width:94%;padding:0 3%}body.?%PAGE?%[data-v-48f8350e]{background:#fff}",""])}}]);