(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-commonNew-goods_out-gooSellNew-gooSellNew"],{"1f5f":function(e,t,o){"use strict";o.r(t);var i=o("3baf"),n=o("2721");for(var a in n)"default"!==a&&function(e){o.d(t,e,(function(){return n[e]}))}(a);o("d5a5");var r,s=o("f0c5"),u=Object(s["a"])(n["default"],i["b"],i["c"],!1,null,"60ea6b92",null,!1,i["a"],r);t["default"]=u.exports},2721:function(e,t,o){"use strict";o.r(t);var i=o("dbf1"),n=o.n(i);for(var a in i)"default"!==a&&function(e){o.d(t,e,(function(){return i[e]}))}(a);t["default"]=n.a},"345f":function(e,t,o){var i=o("24fb");t=i(!1),t.push([e.i,".page[data-v-60ea6b92]{color:#4d4d4d;font-size:%?28?%;height:calc(100vh - %?110?%);overflow:scroll}.bottomEle[data-v-60ea6b92]{position:fixed;bottom:0;left:0;width:calc(100% - %?30?%);background:#fafafa;padding:%?20?% %?0?% %?20?% %?30?%}.pro_list[data-v-60ea6b92]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.pro_listitem[data-v-60ea6b92]{background-color:#fff;padding:%?10?% %?20?%;border-bottom:%?1?% solid#ddd}.pro_allmoney[data-v-60ea6b92]{background-color:#fff;padding:%?10?% %?20?%;text-align:right;font-size:%?32?%;color:#f30}.beizhu_style[data-v-60ea6b92]{text-align:right;width:calc(100% - %?40?%);background-color:#fff;max-height:%?100?%}.confrim_button[data-v-60ea6b92]{padding:0 %?50?%;background:#1651aa;color:#fff;font-weight:700;font-size:%?32?%;border-radius:unset}",""]),e.exports=t},"3baf":function(e,t,o){"use strict";var i,n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-uni-view",[o("v-uni-view",{staticClass:"page"},[o("v-uni-view",{staticStyle:{"line-height":"70rpx",padding:"20rpx 20rpx 0",color:"#3D3D3D","font-weight":"bold"}},[e._v("已选产品")]),o("v-uni-view",e._l(e.products,(function(t,i){return o("v-uni-view",{key:i,staticClass:"pro_listitem"},[o("v-uni-view",{staticClass:"pro_list",staticStyle:{color:"#3D3D3D"}},[o("v-uni-view",{staticStyle:{width:"calc(100% - 200rpx)"}},[e._v("产品："+e._s(t.goodsName))]),o("v-uni-view",[e._v("零售价：￥"+e._s(t.retailPrice?t.retailPrice:0))])],1),t.selected_model?o("v-uni-view",e._l(t.selected_model,(function(t,i){return t.num>0?o("v-uni-view",{key:i,staticClass:"display_flex_bet"},[t?o("v-uni-view",{staticStyle:{"font-size":"24rpx",color:"#999"}},[e._v(e._s(t.custom1.value+t.custom2.value+t.custom3.value+t.custom4.value))]):e._e(),t?o("v-uni-view",{staticStyle:{"font-size":"24rpx",color:"#f30"}},[e._v(e._s(t.num))]):e._e()],1):e._e()})),1):e._e(),o("v-uni-view",{staticClass:"pro_list"},[o("v-uni-view",[e._v("实际零售价：￥"+e._s(t.modify_retailPrice)+"（X"+e._s(t.num)+"）")]),o("v-uni-view",[e._v("合计：￥"+e._s(t.total_money))])],1),t.stocks&&t.stocks.stock_name?o("v-uni-view",{staticStyle:{"font-size":"24rpx",color:"#2ca879"}},[e._v("出库店仓:"+e._s(t.stocks.stock_name))]):e._e()],1)})),1),o("v-uni-form",{attrs:{"report-submit":"true"},on:{submit:function(t){arguments[0]=t=e.$handleEvent(t),e.formSubmit.apply(void 0,arguments)}}},[o("v-uni-view",{staticStyle:{margin:"30rpx 0 0"}},[o("v-uni-view",{staticStyle:{margin:"0 0 10rpx 20rpx",color:"#3D3D3D","font-weight":"bold"}},[e._v("销售明细")]),o("v-uni-view",{staticStyle:{"line-height":"70rpx"}},[o("v-uni-navigator",{staticClass:"display_flex_bet orderListItemBorder borderBot",attrs:{"hover-class":"none",url:"/pages/manage/custom/custom?type=custom"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("客户"),o("v-uni-text",{staticStyle:{color:"#f30"}},[e._v("*")])],1),o("v-uni-view",{staticClass:"kaidan_rightinput display_flex"},[o("v-uni-input",{staticStyle:{"text-align":"right","margin-right":"20rpx"},attrs:{placeholder:"选择客户",disabled:"true",value:e.custom.custom_name}}),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),o("v-uni-navigator",{staticClass:"display_flex_bet orderListItemBorder borderBot",attrs:{"hover-class":"none",url:"/pages/manage/warehouse/warehouse?type=choose"}},[o("v-uni-view",{staticClass:"left_content",staticStyle:{width:"150rpx"}},[e._v("出库仓库")]),o("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[o("v-uni-input",{staticStyle:{"text-align":"right","margin-right":"20rpx"},attrs:{placeholder:"请选择要出库的仓库",disabled:"true",value:e.stock.stock_name}}),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),o("v-uni-view",{staticClass:"display_flex_bet orderListItemBorder borderBot"},[o("v-uni-view",[e._v("商品总价")]),o("v-uni-view",{staticClass:"kaidan_rightinput display_flex"},[o("v-uni-input",{staticStyle:{color:"#d71345","text-align":"right","margin-right":"20rpx","font-size":"30rpx"},attrs:{disabled:"true"},model:{value:e.all_money,callback:function(t){e.all_money=t},expression:"all_money"}}),o("v-uni-text",{staticStyle:{color:"#333","font-weight":"bold"}},[e._v("元")])],1)],1),o("v-uni-view",{staticClass:"display_flex_bet orderListItemBorder borderBot"},[o("v-uni-view",[e._v("其他费用")]),o("v-uni-view",{staticClass:"kaidan_rightinput display_flex"},[o("v-uni-input",{staticStyle:{color:"#d71345","text-align":"right","margin-right":"20rpx","font-size":"30rpx"},attrs:{placeholder:"输入实际收款金额",type:"digit"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.inputOtherMoney.apply(void 0,arguments)}},model:{value:e.otherMoney,callback:function(t){e.otherMoney=t},expression:"otherMoney"}}),o("v-uni-text",{staticStyle:{color:"#333","font-weight":"bold"}},[e._v("元")])],1)],1),o("v-uni-view",{staticClass:"display_flex_bet orderListItemBorder borderBot"},[o("v-uni-view",[e._v("优惠金额")]),o("v-uni-view",{staticClass:"kaidan_rightinput display_flex"},[o("v-uni-input",{staticStyle:{color:"#d71345","text-align":"right","margin-right":"20rpx","font-size":"30rpx"},attrs:{placeholder:"输入优惠金额",type:"digit"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.inputDiscountMoney.apply(void 0,arguments)}},model:{value:e.discountMoney,callback:function(t){e.discountMoney=t},expression:"discountMoney"}}),o("v-uni-text",{staticStyle:{color:"#333","font-weight":"bold"}},[e._v("元")])],1)],1),o("v-uni-navigator",{staticClass:"display_flex_bet orderListItemBorder borderBot",staticStyle:{"margin-top":"20rpx"},attrs:{"hover-class":"none",url:"/pages/finance/myData/account/account?type=choose"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("结算账户")]),o("v-uni-view",{staticClass:"kaidan_rightinput display_flex"},[o("v-uni-input",{staticStyle:{"text-align":"right","margin-right":"20rpx"},attrs:{placeholder:"选择结算账户",disabled:"true",value:e.account.name}}),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),o("v-uni-view",{staticClass:"display_flex_bet orderListItemBorder borderBot"},[o("v-uni-view",[e._v("现结（预付）款")]),o("v-uni-view",{staticClass:"kaidan_rightinput display_flex"},[o("v-uni-input",{staticStyle:{color:"#d71345","text-align":"right","margin-right":"20rpx","font-size":"30rpx"},attrs:{placeholder:"输入预付款",type:"digit"},model:{value:e.haveGetMoney,callback:function(t){e.haveGetMoney=t},expression:"haveGetMoney"}}),o("v-uni-text",{staticStyle:{color:"#333","font-weight":"bold"}},[e._v("元")])],1)],1),o("v-uni-view",{staticClass:"display_flex_bet orderListItemBorder borderBot"},[o("v-uni-view",[e._v("现结（预付）后欠款")]),o("v-uni-view",{staticClass:"kaidan_rightinput display_flex"},[o("v-uni-input",{staticStyle:{color:"#d71345","text-align":"right","margin-right":"20rpx","font-size":"30rpx"},attrs:{value:Number(e.real_money)-Number(e.haveGetMoney)-Number(e.discountMoney)+Number(e.otherMoney),type:"digit",disabled:"true"}}),o("v-uni-text",{staticStyle:{color:"#333","font-weight":"bold"}},[e._v("元")])],1)],1),o("v-uni-view",{staticClass:"display_flex_bet orderListItemBorder borderBot",staticStyle:{"margin-top":"20rpx"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("发货方式")]),o("v-uni-picker",{staticClass:"kaidan_rightinput",attrs:{range:e.pickerTypes,"range-key":"desc"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.select_outType.apply(void 0,arguments)}}},[o("v-uni-input",{staticStyle:{"text-align":"right","margin-right":"20rpx"},attrs:{placeholder:"请选择发货方式",disabled:"true"},model:{value:e.outType.desc,callback:function(t){e.$set(e.outType,"desc",t)},expression:"outType.desc"}})],1)],1),2==e.outType.type||3==e.outType.type?o("v-uni-view",{staticClass:"display_flex_bet orderListItemBorder borderBot"},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("快递单号")]),o("v-uni-view",{staticClass:"kaidan_rightinput display_flex",attrs:{range:e.pickerTypes,"range-key":"desc"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.select_outType.apply(void 0,arguments)}}},[o("v-uni-input",{staticStyle:{"text-align":"right","margin-right":"20rpx"},attrs:{placeholder:"请输入快递单号"},model:{value:e.expressNum,callback:function(t){e.expressNum=t},expression:"expressNum"}}),o("fa-icon",{attrs:{type:"clone",size:"16",color:"#426ab3"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.scan_code.apply(void 0,arguments)}}})],1)],1):e._e(),o("v-uni-view",{staticClass:"display_flex_bet orderListItemBorder borderBot",staticStyle:{"margin-top":"20rpx"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("销售时间")]),o("v-uni-picker",{attrs:{mode:"date",value:e.nowDay,end:e.nowDay},on:{change:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.bindDateChange.apply(void 0,arguments)},click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[o("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[o("v-uni-view",{staticStyle:{"margin-right":"20rpx"}},[e._v(e._s(e.nowDay.split(" ")[0]))]),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1)],1),o("v-uni-view",{staticClass:"display_flex_bet orderListItemBorder borderBot"},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("备注")]),o("v-uni-input",{staticClass:"beizhu_style",attrs:{placeholder:"请输入备注",name:"input_beizhu"}})],1)],1)],1),o("v-uni-view",{staticStyle:{background:"#fff",padding:"10rpx 20rpx"}},[o("v-uni-view",{staticClass:"notice_text"},[e._v("上传凭证图(会员可用)")]),o("v-uni-view",{staticStyle:{width:"100%",padding:"20rpx 0"}},[o("v-uni-view",{staticClass:"upload_image display_flex"},[e._l(e.Images,(function(t,i){return e.Images&&e.Images.length>0?o("v-uni-view",{key:i,staticStyle:{position:"relative"}},[o("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx","margin-right":"10rpx"},attrs:{src:t}}),o("fa-icon",{staticStyle:{position:"absolute",top:"-10rpx",right:"-10rpx"},attrs:{type:"times-circle-o",size:"20",color:"#426ab3"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.removeImg(i)}}})],1):e._e()})),e.Images.length<3?o("v-uni-view",{staticStyle:{width:"180rpx",height:"180rpx","line-height":"220rpx","text-align":"center",border:"1rpx solid#ccc","border-radius":"16rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.upload_image.apply(void 0,arguments)}}},[o("fa-icon",{attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1):e._e()],2)],1)],1),o("v-uni-view",{staticClass:"bottomEle display_flex_bet",staticStyle:{padding:"0 30rpx"}},[o("v-uni-view",{staticStyle:{color:"#333333","font-weight":"bold"}},[o("v-uni-view",[e._v("合计：￥"+e._s(Number(e.real_money)-Number(e.discountMoney)+Number(e.otherMoney)))]),o("v-uni-view",[e._v("总数："+e._s(e.total_num))])],1),o("v-uni-view",{staticClass:"display_flex"},[o("v-uni-button",{staticClass:"confrim_button",staticStyle:{background:"#a1aa16"},attrs:{disabled:e.button_disabled,"form-type":"submit","data-type":"1"}},[e._v("销售")])],1)],1)],1)],1)],1)},a=[];o.d(t,"b",(function(){return n})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return i}))},"408a":function(e,t,o){var i=o("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=i(e))throw TypeError("Incorrect invocation");return+e}},"9f50":function(e,t,o){"use strict";(function(e){var i=o("ee27");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(o("9546")),a={sendTempMini:function(e,t){if("enter"==t){var o={thing1:{value:e.goodsName+"...等",color:"#173177"},number2:{value:e.total_num,color:"#173177"},name3:{value:uni.getStorageSync("user").nickName},date4:{value:e.createdAt}};o.id=e.operationId,this.send_in_mini(o)}else if("out"==t){var i={thing1:{value:e.goodsName+"...等",color:"#173177"},number2:{value:e.total_num,color:"#173177"},name3:{value:uni.getStorageSync("user").nickName},time4:{value:e.createdAt}};i.id=e.operationId,this.send_out_mini(i)}},send_in:function(t){var o=uni.getStorageSync("setting").wx_openid;uni.request({url:"https://www.jimuzhou.com/api/send_temp.php",method:"POST",data:{openid:o,frist:t.frist,data1:t.data1,data2:t.data2,remark:t.remark,url:t.url,type:"in"},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t)}})},send_in_noconfrim:function(t){var o=uni.getStorageSync("setting").wx_openid;uni.request({url:"https://www.jimuzhou.com/api/send_temp.php",method:"POST",data:{openid:o,frist:t.frist,data1:t.data1,data2:t.data2,data3:t.data3,data4:t.data4,remark:t.remark,url:t.url,type:"in_noconfrim"},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t)}})},send_in_mini:function(t){var o={touser:uni.getStorageSync("openid"),template_id:"G2UJEDEyAtGuBdO-Yv96yBi-UnTLhaInr-KzEXqZ-48",page:"/pages/report/EnteringHistory/detail/detail?id="+t.id,data:t,emphasis_keyword:""};n.default.sendWeAppMessage(o).then((function(t){e.log(t)})).catch((function(t){e.log(t)}))},send_out_mini:function(t){var o={touser:uni.getStorageSync("openid"),template_id:"BKT2_0OuWF3mLZGvFmpRzWFa_Dyr4EIppl_LFF1uRLE",page:"/pages/report/EnteringHistory/detail/detail?id="+t.id,data:t,emphasis_keyword:""};n.default.sendWeAppMessage(o).then((function(t){e.log(t)})).catch((function(t){e.log(t)}))},send_temp:function(t){var o=uni.getStorageSync("setting").wx_openid;uni.request({url:"https://www.jimuzhou.com/api/send_temp.php",method:"POST",data:{openid:o,data1:t.data1,data2:t.data2,data3:t.data3,data4:t.data4,remark:"备注:"+t.remark,url:t.url,type:"out"},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t)}})}};t.default=a}).call(this,o("5a52")["default"])},a2fc:function(e,t,o){"use strict";(function(e){var i=o("ee27");o("7db0"),o("a9e3"),o("d3b7"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(o("54f8")),a=i(o("9546")),r={delete_goods:function(t){return new Promise((function(o,i){var r,s=0,u=(0,n.default)(t);try{for(u.s();!(r=u.n()).done;){var c=r.value,l=a.default.Query("Goods");l.destroy(c.objectId).then((function(e){s+=1,s==t.length&&o(!0)})).catch((function(t){e.log(t)}))}}catch(d){u.e(d)}finally{u.f()}}))},upload_good_withNoCan:function(t,o){return new Promise((function(i,n){var r=uni.getStorageSync("uid"),s=a.default.Pointer("_User"),u=s.set(r),c=t.reserve,l=a.default.Pointer("stocks"),d=l.set(o.objectId),p=a.default.Query("Goods");p.equalTo("userId","==",r),p.equalTo("goodsName","==",t.goodsName),p.equalTo("stocks","==",o.objectId),p.find().then((function(o){if(e.log(o),o.length>=1)i([!1,"该商品存在此店仓中"]);else{var n=a.default.Query("Goods");if(n.set("goodsName",t.goodsName),n.set("goodsIcon",t.goodsIcon),n.set("costPrice",t.costPrice),n.set("retailPrice",t.retailPrice),n.set("reserve",Number(t.reserve)),n.set("productCode",t.productCode?t.productCode:""),n.set("stocks",d),n.set("product_info",t.product_info?t.product_info:""),n.set("producer",t.producer?t.producer:""),n.set("packingUnit",t.packingUnit?t.packingUnit:""),n.set("packageContent",t.packageContent?t.packageContent:""),n.set("warning_num",Number(t.warning_num?t.warning_num:0)),n.set("stocktype",Number(t.warning_num?t.warning_num:0)>=Number(c)?0:1),t.second_class){var r=a.default.Pointer("class_user"),s=r.set(t.goodsClass);n.set("second_class",p);var l=a.default.Pointer("second_class"),p=l.set(t.second_class);n.set("goodsClass",s)}n.set("userId",u),n.save().then((function(t){e.log(t),i([!0,t])})).catch((function(t){e.log(t)}))}}))}))},upload_good:function(t){return new Promise((function(o,i){var n=JSON.parse(localStorage.getItem("bmob")).objectId,r=a.default.Pointer("_User"),s=r.set(n),u=a.default.Pointer("class_user"),c=u.set(t.goodsClass),l=a.default.Pointer("second_class"),d=l.set(t.second_class),p=a.default.Query("Goods");p.equalTo("userId","==",n),p.equalTo("goodsName","==",t.goodsName),p.equalTo("position","==",t.position),p.equalTo("stocks","==",t.stocks),p.find().then((function(i){if(e.log(i),i.length>=1)o([!1,i]);else{var n=t.reserve,r=a.default.Pointer("stocks"),u=r.set(t.stocks),l=a.default.Query("Goods");l.set("goodsName",t.goodsName),l.set("goodsIcon",t.goodsIcon),l.set("costPrice",t.costPrice),l.set("retailPrice",t.retailPrice),l.set("producttime",t.producttime),l.set("nousetime",t.nousetime),l.set("regNumber",t.regNumber),l.set("reserve",Number(t.reserve)),l.set("productCode",t.productCode),l.set("stocks",u),l.set("product_info",t.product_info),l.set("producer",t.producer),l.set("packingUnit",t.packingUnit),l.set("packageContent",t.packageContent),l.set("warning_num",Number(t.warning_num)),l.set("stocktype",Number(t.warning_num)>=Number(n)?0:1),l.set("second_class",d),l.set("goodsClass",c),l.set("userId",s),l.save().then((function(t){e.log(t),o([!0,t])})).catch((function(t){e.log(t)}))}}))}))},get_fristclass:function(){var e=JSON.parse(localStorage.getItem("bmob")).objectId;return new Promise((function(t,o){var i=a.default.Query("class_user");i.equalTo("parent","==",e),i.find().then((function(e){localStorage.setItem("frist_class",JSON.stringify(e)),t(e)}))}))},get_secondclass:function(e){return new Promise((function(t,o){var i=a.default.Query("class_user");i.field("second",e),i.relation("second_class").then((function(e){t(e.results)}))}))},getstock_list:function(e){var t=JSON.parse(localStorage.getItem("bmob")).objectId;return new Promise((function(o,i){var n=a.default.Query("stocks");n.order("-num"),n.include("charge","shop"),n.equalTo("parent","==",t),e&&n.equalTo("stock_name","==",{$regex:e+".*"}),n.limit(500),n.find().then((function(e){localStorage.setItem("stocks",JSON.stringify(e)),o(e)}))}))}};t.default=r}).call(this,o("5a52")["default"])},b6802:function(e,t,o){"use strict";var i=o("23e7"),n=o("a691"),a=o("408a"),r=o("1148"),s=o("d039"),u=1..toFixed,c=Math.floor,l=function(e,t,o){return 0===t?o:t%2===1?l(e,t-1,o*e):l(e*e,t/2,o)},d=function(e){var t=0,o=e;while(o>=4096)t+=12,o/=4096;while(o>=2)t+=1,o/=2;return t},p=u&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){u.call({})}));i({target:"Number",proto:!0,forced:p},{toFixed:function(e){var t,o,i,s,u=a(this),p=n(e),g=[0,0,0,0,0,0],v="",m="0",f=function(e,t){var o=-1,i=t;while(++o<6)i+=e*g[o],g[o]=i%1e7,i=c(i/1e7)},y=function(e){var t=6,o=0;while(--t>=0)o+=g[t],g[t]=c(o/e),o=o%e*1e7},h=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==g[e]){var o=String(g[e]);t=""===t?o:t+r.call("0",7-o.length)+o}return t};if(p<0||p>20)throw RangeError("Incorrect fraction digits");if(u!=u)return"NaN";if(u<=-1e21||u>=1e21)return String(u);if(u<0&&(v="-",u=-u),u>1e-21)if(t=d(u*l(2,69,1))-69,o=t<0?u*l(2,-t,1):u/l(2,t,1),o*=4503599627370496,t=52-t,t>0){f(0,o),i=p;while(i>=7)f(1e7,0),i-=7;f(l(10,i,1),0),i=t-1;while(i>=23)y(1<<23),i-=23;y(1<<i),f(1,1),y(2),m=h()}else f(0,o),f(1<<-t,0),m=h()+r.call("0",p);return p>0?(s=m.length,m=v+(s<=p?"0."+r.call("0",p-s)+m:m.slice(0,s-p)+"."+m.slice(s-p))):m=v+m,m}})},cf9b:function(e,t,o){var i=o("345f");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=o("4f06").default;n("0dafb0a4",i,!0,{sourceMap:!1,shadowMode:!1})},d5a5:function(e,t,o){"use strict";var i=o("cf9b"),n=o.n(i);n.a},dbf1:function(e,t,o){"use strict";(function(e){var i=o("ee27");o("a15b"),o("a434"),o("a9e3"),o("b6802"),o("d3b7"),o("25f0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,a,r=i(o("54f8")),s=i(o("9546")),u=i(o("7fd5")),c=(i(o("9f50")),i(o("856d")),i(o("a2fc")),{data:function(){return{user:uni.getStorageSync("user"),identity:uni.getStorageSync("identity"),othercurrent:"",Images:[],stock:"",shop_name:"",products:null,button_disabled:!1,beizhu_text:"",real_money:0,all_money:0,allCostPrice:0,really_total_money:0,custom:null,account:"",outType:"",discount:"",pickerTypes:[{desc:"自提",type:1},{desc:"快递",type:2},{desc:"物流",type:3},{desc:"送货上门",type:4}],expressNum:"",total_num:0,nowDay:u.default.getDay(0,!0),otherMoney:0,discountMoney:0,haveGetMoney:0,sellLaterOrderId:""}},onLoad:function(e){a=this,n=uni.getStorageSync("uid"),a.products=uni.getStorageSync("products"),a.sellLaterOrderId=e.id||"",a.user.rights&&a.user.rights.othercurrent&&(a.othercurrent=a.user.rights.othercurrent);for(var t=0;t<a.products.length;t++)a.all_money=Number((a.products[t].total_money+a.all_money).toFixed(2)),a.really_total_money=Number((a.products[t].really_total_money+a.really_total_money).toFixed(2)),a.total_num+=Number(a.products[t].num),a.allCostPrice=a.allCostPrice+Number(a.products[t].num)*Number(a.products[t].costPrice);a.real_money=Number(a.all_money.toFixed(2)),a.haveGetMoney=Number(a.all_money.toFixed(2))},onShow:function(){a.custom=uni.getStorageSync("custom"),a.account=uni.getStorageSync("account"),a.stock=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",uni.getStorageSync("haveGetMoney")&&(a.haveGetMoney=Number(uni.getStorageSync("haveGetMoney").toFixed(2)),uni.removeStorageSync("haveGetMoney")),uni.getStorageSync("otherMoney")&&(a.otherMoney=Number(uni.getStorageSync("otherMoney").toFixed(2)),a.haveGetMoney=a.haveGetMoney+a.otherMoney,uni.removeStorageSync("otherMoney"))},onUnload:function(){uni.removeStorageSync("haveGetMoney"),uni.removeStorageSync("otherMoney"),uni.removeStorageSync("products")},methods:{inputOtherMoney:function(e){a.haveGetMoney=Number(a.all_money.toFixed(2))+Number(e.detail.value)-Number(a.discountMoney)},inputDiscountMoney:function(e){a.haveGetMoney=Number(a.all_money.toFixed(2))+Number(a.otherMoney)-Number(e.detail.value)},bindDateChange:function(e){a.nowDay=e.detail.value+" 00:00:00"},scan_code:function(){this.$wechat.scanQRCode().then((function(e){a.expressNum=e.result}))},removeImg:function(e){a.Images.splice(e,1),a.Images=a.Images},upload_image:function(){a.user.is_vip?uni.chooseImage({count:3,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){e.log(t);var o,i,n=Date.parse(new Date),u=t.tempFilePaths,c=(0,r.default)(u);try{for(c.s();!(i=c.n()).done;){var l=i.value;o=s.default.File(n+".jpg",l)}}catch(d){c.e(d)}finally{c.f()}o.save().then((function(e){var t,o=(0,r.default)(e);try{for(o.s();!(t=o.n()).done;){var i=t.value;a.Images.push(i.url)}}catch(d){o.e(d)}finally{o.f()}}))}}):uni.showToast({title:"您还不是会员，无法使用",icon:"none"})},select_outType:function(e){a.outType=a.pickerTypes[e.detail.value],2==a.outType.type&&3==a.outType.type||(a.expressNum="")},formSubmit:function(t){uni.getStorageSync("identity");this.button_disabled=!0;t.detail.formId;var o=1;if(uni.showLoading({title:"上传中..."}),""==uni.getStorageSync("custom")||void 0==uni.getStorageSync("custom"))return uni.showToast({icon:"none",title:"请选择客户"}),void(this.button_disabled=!1);var i=new Array,r=[],c=[],l=s.default.Pointer("customs"),d=l.set(uni.getStorageSync("custom").objectId),p=s.default.Pointer("stocks"),g="";a.stock&&a.stock.objectId&&(g=p.set(a.stock.objectId));for(var v=Number(a.real_money)-Number(a.discountMoney)+Number(a.otherMoney),m=v-Number(a.haveGetMoney),f=v-a.allCostPrice,y=0;y<this.products.length;y++){var h=Number(this.products[y].reserve)-this.products[y].num;c.push(this.products[y].goodsName);var _=s.default.Query("Bills"),b={},w=s.default.Pointer("_User"),S=w.set(n),x=s.default.Pointer("_User"),k=x.set(uni.getStorageSync("masterId")),N=s.default.Pointer("Goods"),I=N.set(this.products[y].objectId);_.set("custom",d),_.set("goodsName",this.products[y].goodsName),_.set("retailPrice",this.products[y].modify_retailPrice.toString()),_.set("num",Number(this.products[y].num)),_.set("total_money",this.products[y].total_money),_.set("really_total_money",this.products[y].really_total_money),_.set("allCostPrice",Number(a.products[y].num)*Number(a.products[y].costPrice)),_.set("goodsId",I),_.set("userId",S),_.set("type",-1),_.set("extra_type",o),_.set("opreater",k),_.set("createdTime",{__type:"Date",iso:a.nowDay});var P={};a.stock&&a.stock.objectId?(_.set("status",!0),_.set("stock",g),b.stock=a.stock.stock_name):_.set("status",!1),b.goodsName=this.products[y].goodsName,b.modify_retailPrice=this.products[y].modify_retailPrice.toString(),b.retailPrice=this.products[y].retailPrice,b.total_money=this.products[y].total_money,P.costPrice=this.products[y].costPrice,P.retailPrice=this.products[y].retailPrice,P.objectId=this.products[y].objectId,P.reserve=h,this.products[y].selectd_model&&(P.selected_model=this.products[y].selected_model,P.models=this.products[y].models),b.goodsId=P,b.type=-1,b.num=this.products[y].num,b.warning_num=this.products[y].warning_num,b.packingUnit=this.products[y].packingUnit||"",i.push(_),r.push(b)}s.default.Query("Bills").saveAll(i).then((function(i){for(var l=[],p=0;p<i.length;p++)l.push(i[p].success.objectId);var y=s.default.Pointer("_User"),h=y.set(n),_=uni.getStorageSync("masterId"),b=s.default.Pointer("_User"),w=b.set(_),S=s.default.Query("order_opreations");if(S.set("detail",r),S.set("bills",l),S.set("beizhu",t.detail.value.input_beizhu),S.set("type",-1),S.set("extra_type",o),S.set("opreater",w),S.set("master",h),S.set("real_num",a.total_num),S.set("goodsName",c.join(",")),S.set("all_money",a.all_money),S.set("allCostPrice",a.allCostPrice),S.set("profit",f),S.set("otherMoney",Number(a.otherMoney)),S.set("discountMoney",Number(a.discountMoney)),S.set("haveGetMoney",Number(a.haveGetMoney)),S.set("real_money",v),S.set("debt",m),a.account){var x=s.default.Pointer("accounts"),k=x.set(a.account.objectId);S.set("account",k);var N=s.default.Query("accounts");N.get(a.account.objectId).then((function(e){e.set("money",e.money+Number(a.haveGetMoney)),e.save().then((function(e){}))}))}if(S.set("recordType","new"),S.set("createdTime",{__type:"Date",iso:a.nowDay}),S.set("custom",d),m>0){var I=s.default.Query("customs");I.get(a.custom.objectId).then((function(e){var t=null==e.debt?0:e.debt;t+=m,I.get(a.custom.objectId).then((function(e){e.set("debt",t),e.save()}))}))}a.outType&&(S.set("typeDesc",a.outType.desc),S.set("expressNum",a.expressNum)),S.set("Images",a.Images),a.stock?(S.set("status",!0),S.set("stock",g)):S.set("status",!1),S.save().then((function(t){var o=t.objectId;a.stock&&a.stock.objectId?u.default.outRedGoodNumNew(a.products).then((function(t){uni.hideLoading(),uni.removeStorageSync("customs"),uni.removeStorageSync("_warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("category"),uni.setStorageSync("is_option",!0),uni.showToast({title:"销售出库成功"}),setTimeout((function(){a.sellLaterOrderId?(S.set("id",a.sellLaterOrderId),S.set("orderSellId",o),S.set("status",!0),S.save().then((function(t){uni.navigateBack({delta:2}),a.button_disabled=!1,u.default.log(uni.getStorageSync("user").nickName+"销售了'"+a.products[0].goodsName+"'等"+a.products.length+"商品，已经出库",-11,o),e.log(t)}))):(uni.navigateBack({delta:2}),a.button_disabled=!1,u.default.log(uni.getStorageSync("user").nickName+"销售了'"+a.products[0].goodsName+"'等"+a.products.length+"商品，已经出库",-11,o))}),500)})):uni.showToast({title:"产品销售成功",icon:"success",duration:500,success:function(){setTimeout((function(){uni.hideLoading(),uni.removeStorageSync("customs"),uni.removeStorageSync("_warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("category"),uni.setStorageSync("is_option",!0),a.sellLaterOrderId?(S.set("id",a.sellLaterOrderId),S.set("orderSellId",o),S.set("status",!0),S.save().then((function(e){a.button_disabled=!1,u.default.log(uni.getStorageSync("user").nickName+"销售了'"+a.products[0].goodsName+"'等"+a.products.length+"商品，暂未出库",-11,o),uni.redirectTo({url:"/pages/report/EnteringHistory/SellDetail/SellDetail?id="+o})}))):(a.button_disabled=!1,u.default.log(uni.getStorageSync("user").nickName+"销售了'"+a.products[0].goodsName+"'等"+a.products.length+"商品，暂未出库",-11,o),uni.redirectTo({url:"/pages/report/EnteringHistory/SellDetail/SellDetail?id="+o}))}),500)}})}))}),(function(t){e.log("异常处理")}))}}});t.default=c}).call(this,o("5a52")["default"])}}]);