(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-custom-producer_detail-producer_detail"],{"12ad":function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-uni-view",[o("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"uni-mask",style:{top:e.offsetTop+"px"},on:{click:function(t){t=e.$handleEvent(t),e.hide(t)},touchmove:function(t){t.stopPropagation(),t.preventDefault(),t=e.$handleEvent(t),e.moveHandle(t)}}}),o("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"uni-popup",class:"uni-popup-"+e.position+" uni-popup-"+e.mode},[e._v(e._s(e.msg)),e._t("default"),"middle"===e.position&&"insert"===e.mode?o("v-uni-view",{staticClass:" uni-icon uni-icon-close",class:{"uni-close-bottom":"bottom"===e.buttonMode,"uni-close-right":"right"===e.buttonMode},on:{click:function(t){t=e.$handleEvent(t),e.closeMask(t)}}}):e._e()],2)],1)},i=[];o.d(t,"a",function(){return n}),o.d(t,"b",function(){return i})},"252c":function(e,t,o){"use strict";var n=o("58d9"),i=o.n(n);i.a},3472:function(e,t,o){"use strict";o.r(t);var n=o("8479"),i=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,function(){return n[e]})}(a);t["default"]=i.a},4454:function(e,t,o){t=e.exports=o("2350")(!1),t.push([e.i,'.uni-mask[data-v-ce6dbc2a]{position:fixed;z-index:998;top:0;right:0;bottom:0;left:0;background-color:rgba(0,0,0,.3)}.uni-popup[data-v-ce6dbc2a]{position:fixed;z-index:999;background-color:#fff}.uni-popup-middle[data-v-ce6dbc2a]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.uni-popup-middle.uni-popup-insert[data-v-ce6dbc2a]{min-width:%?380?%;min-height:%?380?%;max-width:100%;max-height:80%;-webkit-transform:translate(-50%,-65%);-ms-transform:translate(-50%,-65%);transform:translate(-50%,-65%);background:none;-webkit-box-shadow:none;box-shadow:none}.uni-popup-middle.uni-popup-fixed[data-v-ce6dbc2a]{border-radius:%?10?%;padding:%?30?%}.uni-close-bottom[data-v-ce6dbc2a],.uni-close-right[data-v-ce6dbc2a]{position:absolute;bottom:%?-180?%;text-align:center;border-radius:50%;color:#f5f5f5;font-size:%?60?%;font-weight:700;opacity:.8;z-index:-1}.uni-close-bottom[data-v-ce6dbc2a]{margin:auto;left:0;right:0}.uni-close-right[data-v-ce6dbc2a]{right:%?-60?%;top:%?-80?%}.uni-close-bottom[data-v-ce6dbc2a]:after{content:"";position:absolute;width:0;border:1px #f5f5f5 solid;top:%?-200?%;bottom:%?56?%;left:50%;-webkit-transform:translate(-50%);-ms-transform:translate(-50%);transform:translate(-50%);opacity:.8}.uni-popup-bottom[data-v-ce6dbc2a],.uni-popup-top[data-v-ce6dbc2a]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.uni-popup-top[data-v-ce6dbc2a]{top:0;left:0;width:100%;height:%?100?%;line-height:%?100?%;text-align:center}.uni-popup-bottom[data-v-ce6dbc2a]{left:0;bottom:0;width:100%;min-height:%?100?%;line-height:%?100?%;text-align:center}',""])},"58d9":function(e,t,o){var n=o("4454");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=o("4f06").default;i("8dd48b32",n,!0,{sourceMap:!1,shadowMode:!1})},8479:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={name:"UniPopup",props:{show:{type:Boolean,default:!1},position:{type:String,default:"middle"},mode:{type:String,default:"insert"},msg:{type:String,default:""},h5Top:{type:Boolean,default:!1},buttonMode:{type:String,default:"bottom"}},data:function(){return{offsetTop:0}},watch:{h5Top:function(e){this.offsetTop=e?44:0}},created:function(){var e=0;e=this.h5Top?0:44,this.offsetTop=e},methods:{hide:function(){"insert"===this.mode&&"middle"===this.position||this.$emit("hidePopup")},closeMask:function(){"insert"===this.mode&&this.$emit("hidePopup")},moveHandle:function(){}}};t.default=n},"93e8":function(e,t,o){"use strict";(function(t){var n=o("288e");o("6b54"),o("87b3"),o("c5f6");var i=n(o("5d73"));o("7514");var a=n(o("906f"));e.exports={handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(e,o,n){var i=a.default.Pointer("_User"),r=i.set(uni.getStorageSync("uid")),u=a.default.Query("logs");u.set("parent",r),u.set("log",e),u.set("detail_id",n),u.set("type",o),u.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})},record_shopOut:function(e,o){t.log(e,o);var n=a.default.Query("shops");n.set("id",e),n.set("have_out",o),n.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})},record_staffOut:function(e){if(t.log(e,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var o=a.default.Query("staffs");o.set("id",uni.getStorageSync("user").objectId),o.set("have_out",e+uni.getStorageSync("user").have_out),o.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}},get_allCost:function(){var e=uni.getStorageSync("uid");t.log(e);var o=a.default.Query("Goods");o.equalTo("userId","==",e),o.find().then(function(e){t.log(e);var o=!0,n=!1,a=void 0;try{for(var r,u=(0,i.default)(e);!(o=(r=u.next()).done);o=!0){var s=r.value;t.log(s),Number(s.costPrice)*s.reserve,s.reserve}}catch(d){n=!0,a=d}finally{try{o||null==u.return||u.return()}finally{if(n)throw a}}})},getDay:function(e,t){var o=this,n=new Date,i=n.getTime()+864e5*e;n.setTime(i);var a=n.getFullYear(),r=n.getMonth(),u=n.getDate();return r=o.handleMonth(r+1),u=o.handleMonth(u),t?a+"-"+r+"-"+u+" 00:00:00":a+"-"+r+"-"+u},js_date_time:function(e,t){var o=new Date(e),n=o.getFullYear(),i=o.getMonth()+1;i=i<10?"0"+i:i;var a=o.getDate();a=a<10?"0"+a:a;var r=o.getHours();r=r<10?"0"+r:r;var u=o.getMinutes(),s=o.getSeconds();return u=u<10?"0"+u:u,s=s<10?"0"+s:s,t?n+"-"+i+"-"+a+" "+r+":"+u:n+"-"+i+"-"+a},handleMonth:function(e){var t=e;return 1==e.toString().length&&(t="0"+e),t}}}).call(this,o("5a52")["default"])},adae:function(e,t,o){"use strict";o.r(t);var n=o("12ad"),i=o("3472");for(var a in i)"default"!==a&&function(e){o.d(t,e,function(){return i[e]})}(a);o("252c");var r=o("2877"),u=Object(r["a"])(i["default"],n["a"],n["b"],!1,null,"ce6dbc2a",null);t["default"]=u.exports},bbe3:function(e,t,o){t=e.exports=o("2350")(!1),t.push([e.i,"uni-page-body[data-v-2420eb82]{color:#3d3d3d}.modal_confrimbutton[data-v-2420eb82]{background:#426ab3;color:#fff;width:60%;padding:%?20?% 0;text-align:center;margin-left:20%;border-radius:%?8?%;margin-top:%?30?%}.list_item[data-v-2420eb82]{padding:%?20?% %?30?%;background:#fff}.left_desc[data-v-2420eb82]{color:#999}.border_bottom[data-v-2420eb82]{border-bottom:%?1?% solid#DDDDDD}.getmoney_button[data-v-2420eb82]{width:100%;background:#426ab3;color:#fff;padding:%?20?% 0;text-align:center;position:fixed;bottom:0;left:0}",""])},d4ff:function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-uni-view",[e.loading?o("loading"):o("v-uni-view",[o("v-uni-view",{staticClass:"display_flex_bet list_item border_bottom"},[o("v-uni-view",{staticClass:"left_desc"},[e._v("供货商昵称")]),o("v-uni-view",[e._v(e._s(e.producer.producer_name))])],1),o("v-uni-view",{staticClass:"display_flex_bet list_item border_bottom"},[o("v-uni-view",{staticClass:"left_desc"},[e._v("联系电话")]),e.producer.producer_phone?o("v-uni-view",[e._v(e._s(e.producer.producer_phone))]):o("v-uni-view",[e._v("未填写")])],1),o("v-uni-navigator",{staticClass:"display_flex_bet list_item border_bottom",attrs:{"hover-class":"none",url:"debt_history/debt_history?id="+e.producer.objectId+"&name="+e.producer.producer_name}},[o("v-uni-view",{staticClass:"left_desc"},[e._v("欠供应商款")]),o("v-uni-view",{staticClass:"display_flex"},[o("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("￥"+e._s(e.producer.debt))]),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),o("v-uni-view",{staticClass:"display_flex_bet list_item border_bottom"},[o("v-uni-view",{staticClass:"left_desc"},[e._v("建立时间")]),o("v-uni-view",[e._v(e._s(e.producer.createdAt))])],1),o("v-uni-navigator",{staticClass:"list_item display_flex_bet",staticStyle:{margin:"20rpx 0"},attrs:{"hover-class":"none",url:"history/history?id="+e.producer.objectId}},[o("v-uni-text",{staticClass:"left_desc"},[e._v("交易历史")]),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1),o("uni-popup",{attrs:{show:e.modal_show,position:"middle",mode:"fixed"},on:{hidePopup:function(t){t=e.$handleEvent(t),e.modal_show=!1}}},[o("v-uni-view",{staticStyle:{width:"500rpx"}},[o("v-uni-view",{staticClass:"display_flex"},[o("v-uni-view",{staticStyle:{width:"160rpx",color:"#999"}},[e._v("本次还款：")]),o("v-uni-input",{staticClass:"uni-input",attrs:{placeholder:"请输入本次还款金额",type:"digit"},model:{value:e.modal_sk.sk_number,callback:function(t){e.$set(e.modal_sk,"sk_number",t)},expression:"modal_sk.sk_number"}})],1),o("v-uni-view",{staticClass:"display_flex"},[o("v-uni-view",{staticStyle:{width:"160rpx",color:"#999"}},[e._v("备注：")]),o("v-uni-input",{staticClass:"uni-input",attrs:{placeholder:"请输入备注信息"},model:{value:e.modal_sk.beizhu,callback:function(t){e.$set(e.modal_sk,"beizhu",t)},expression:"modal_sk.beizhu"}})],1),o("v-uni-view",{staticClass:"modal_confrimbutton",on:{click:function(t){t=e.$handleEvent(t),e.confrim_sk(t)}}},[e._v("确定")])],1)],1),o("v-uni-view",{staticClass:"getmoney_button",on:{click:function(t){t=e.$handleEvent(t),e.modal_show=!0}}},[e._v("还款")])],1)],1)},i=[];o.d(t,"a",function(){return n}),o.d(t,"b",function(){return i})},d74a:function(e,t,o){"use strict";(function(e){var n=o("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,o("c5f6");var i=n(o("f499"));o("7514");var a=n(o("795b")),r=n(o("906f")),u={get_producerList:function(e,t){return new a.default(function(o,n){var a=JSON.parse(localStorage.getItem("bmob")).objectId,u=r.default.Query("producers");u.order("num"),u.equalTo("parent","==",a),u.equalTo("disabled","==",e),t&&u.equalTo("name","==",{$regex:t+".*"}),u.find().then(function(e){localStorage.setItem("shops",(0,i.default)(e)),o(e)})})},add_producer:function(t){e.log(t);var o=JSON.parse(localStorage.getItem("bmob")).objectId;return new a.default(function(n,i){var a=r.default.Pointer("_User"),u=a.set(o);if(t.objectId){var s=r.default.Query("producers");s.set("producer_name",t.producer_name),s.set("debt",Number(t.debt)),s.set("producer_address",t.producer_address),s.set("producer_phone",t.producer_phone),s.set("parent",u),s.set("disabled",!t.disabled),s.set("id",t.objectId),s.save().then(function(e){n(e)}).catch(function(t){e.log(t)})}else{var d=r.default.Query("producers");d.equalTo("parent","==",o),d.equalTo("name","==",t.producer_name),d.find().then(function(o){if(e.log(o),0==o.length){var i=r.default.Query("producers");i.set("producer_name",t.producer_name),i.set("debt",Number(t.debt)),i.set("producer_address",t.producer_address),i.set("producer_phone",t.producer_phone),i.set("have_out",0),i.set("disabled",!t.disabled),i.set("parent",u),i.save().then(function(e){n(e)}).catch(function(t){e.log(t)})}else n(!1)})}})},delete_producer:function(t){return new a.default(function(o,n){var i=r.default.Query("producers");i.destroy(t).then(function(e){o(e)}).catch(function(t){e.log(t)})})},producer_detail:function(t){return new a.default(function(o,n){var i=r.default.Query("producers");i.get(t).then(function(e){o(e)}).catch(function(t){e.log(t)})})},get_moneyList:function(t){return new a.default(function(o,n){var i=r.default.Query("debt_history");i.equalTo("producer","==",t),i.include("operater"),i.find().then(function(t){e.log(t),o(t)})})}};t.default=u}).call(this,o("5a52")["default"])},db77:function(e,t,o){"use strict";var n=o("ea2c"),i=o.n(n);i.a},de2e:function(e,t,o){"use strict";o.r(t);var n=o("fe2f"),i=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,function(){return n[e]})}(a);t["default"]=i.a},ea2c:function(e,t,o){var n=o("bbe3");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=o("4f06").default;i("395724c5",n,!0,{sourceMap:!1,shadowMode:!1})},fd9b:function(e,t,o){"use strict";o.r(t);var n=o("d4ff"),i=o("de2e");for(var a in i)"default"!==a&&function(e){o.d(t,e,function(){return i[e]})}(a);o("db77");var r=o("2877"),u=Object(r["a"])(i["default"],n["a"],n["b"],!1,null,"2420eb82",null);t["default"]=u.exports},fe2f:function(e,t,o){"use strict";(function(e){var n=o("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,o("c5f6");var i,a=n(o("906f")),r=n(o("d74a")),u=n(o("93e8")),s=n(o("eaf0")),d=n(o("adae")),c=n(o("c7fb")),l={components:{faIcon:s.default,loading:c.default,uniPopup:d.default},data:function(){return{loading:!0,modal_show:!1,producer:{},modal_sk:{sk_number:"",beizhu:""}}},onLoad:function(t){i=this,r.default.producer_detail(t.id).then(function(t){e.log(t),t.debt||(t.debt=0),i.producer=t,i.loading=!1})},methods:{confrim_sk:function(){e.log(i.modal_sk);var t=i.modal_sk.sk_number,o=i.modal_sk.beizhu,n=i.producer.objectId;if(null==t||0==t.length)uni.showToast({title:"请输入还款金额",icon:"none"});else{uni.showLoading({title:"加载中..."}),i.modal_show=!1;var s=a.default.Query("producers");s.get(n).then(function(s){if(s.debt-Number(t)<0)uni.hideLoading(),uni.showToast({icon:"none",title:"还款金额超出"});else if(null==s.debt||0==s.debt)uni.hideLoading(),uni.showToast({icon:"none",title:"没有欠款"});else{s.set("debt",s.debt-Number(t)),s.save();var d=a.default.Pointer("producers"),c=d.set(n),l=a.default.Pointer("_User"),f=l.set(uni.getStorageSync("uid")),p=a.default.Pointer("_User"),v=p.set(uni.getStorageSync("masterId")),b=a.default.Query("debt_history");b.set("producer",c),b.set("master",f),b.set("operater",v),b.set("debt_number",Number(t)),b.set("beizhu",o),b.save().then(function(o){e.log(o),u.default.log(uni.getStorageSync("user").nickName+"操作'"+i.producer.producer_name+"'供货商收款￥"+t+"元",6,o.objectId),uni.hideLoading(),r.default.producer_detail(i.producer.objectId).then(function(t){e.log(t),i.producer=t,uni.showToast({title:"还款成功"})})}).catch(function(t){e.log(t)})}}).catch(function(t){e.log(t)})}}}};t.default=l}).call(this,o("5a52")["default"])}}]);