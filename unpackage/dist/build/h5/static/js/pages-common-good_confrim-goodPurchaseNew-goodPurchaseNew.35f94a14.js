(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-common-good_confrim-goodPurchaseNew-goodPurchaseNew"],{"01c3":function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-uni-view",[o("v-uni-view",{staticClass:"page"},[o("v-uni-view",{staticStyle:{"line-height":"70rpx",padding:"20rpx 20rpx 0",color:"#3D3D3D","font-weight":"bold"}},[e._v("已选产品")]),o("v-uni-view",e._l(e.products,function(t,a){return o("v-uni-view",{key:a,staticClass:"pro_listitem"},[o("v-uni-view",{staticClass:"pro_list"},[o("v-uni-view",{staticStyle:{width:"calc(100% - 260rpx)"}},[e._v("产品："+e._s(t.goodsName))]),e.user.rights&&-1==e.othercurrent.indexOf("1")?o("v-uni-view",[e._v("期初进货价：￥0")]):o("v-uni-view",[e._v("期初进货价：￥"+e._s(t.costPrice))])],1),t.selected_model?o("v-uni-view",e._l(t.selected_model,function(t,a){return t.num>0?o("v-uni-view",{key:a,staticClass:"display_flex_bet"},[t?o("v-uni-view",{staticStyle:{"font-size":"24rpx",color:"#999"}},[e._v(e._s(t.custom1.value+t.custom2.value+t.custom3.value+t.custom4.value))]):e._e(),t?o("v-uni-view",{staticStyle:{"font-size":"24rpx",color:"#f30"}},[e._v(e._s(t.num))]):e._e()],1):e._e()}),1):e._e(),e.user.rights&&"0"!=e.user.rights.othercurrent[0]?o("v-uni-view",{staticClass:"pro_list"},[o("v-uni-view",[e._v("实际进货价：￥0（X"+e._s(t.num)+"）")]),o("v-uni-view",[e._v("合计：￥0")])],1):o("v-uni-view",{staticClass:"pro_list"},[o("v-uni-view",[e._v("实际进货价：￥"+e._s(t.modify_retailPrice)+"（X"+e._s(t.num)+"）")]),o("v-uni-view",[e._v("合计：￥"+e._s(t.modify_retailPrice*t.num))])],1),t.stocks&&t.stocks.stock_name?o("v-uni-view",{staticStyle:{"font-size":"24rpx",color:"#2ca879"}},[e._v("存放仓库:"+e._s(t.stocks.stock_name))]):e._e()],1)}),1),o("v-uni-form",{attrs:{"report-submit":"true"},on:{submit:function(t){arguments[0]=t=e.$handleEvent(t),e.formSubmit.apply(void 0,arguments)}}},[o("v-uni-view",{staticStyle:{margin:"30rpx 0"}},[o("v-uni-view",{staticStyle:{margin:"0 0 10rpx 20rpx",color:"#333","font-weight":"bold"}},[e._v("采购明细")]),o("v-uni-view",{staticStyle:{"line-height":"70rpx"}},[o("v-uni-navigator",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 20rpx","border-bottom":"1rpx solid#F7F7F7"},attrs:{"hover-class":"none",url:"/pages/manage/custom/custom?type=producer"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("供应商"),o("v-uni-text",{staticStyle:{color:"#f30"}},[e._v("*")])],1),o("v-uni-view",{staticClass:"kaidan_rightinput display_flex",staticStyle:{width:"100%","justify-content":"flex-end"}},[o("v-uni-input",{staticStyle:{"text-align":"right","margin-right":"20rpx"},attrs:{placeholder:"选择供货商",disabled:"true",value:e.producer.producer_name}}),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),o("v-uni-navigator",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 20rpx","border-bottom":"1rpx solid#F7F7F7",background:"#fff"},attrs:{"hover-class":"none",url:"/pages/finance/account/account?type=producerChoose&money="+e.real_money}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("结算账户")]),o("v-uni-view",{staticClass:"kaidan_rightinput display_flex"},[o("v-uni-input",{staticStyle:{"text-align":"right","margin-right":"20rpx"},attrs:{placeholder:"选择结算账户",disabled:"true",value:e.account.name}}),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),e.user.rights&&"0"!=e.user.rights.othercurrent[0]?o("v-uni-view"):o("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 20rpx","border-bottom":"1rpx solid#F7F7F7",background:"#fff"}},[o("v-uni-view",[e._v("是否赊账")]),o("v-uni-view",{staticClass:"kaidan_rightinput",staticStyle:{"text-align":"right"}},[o("v-uni-switch",{attrs:{checked:e.wetherDebt},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.changeDebtStatus.apply(void 0,arguments)}}})],1)],1),e.wetherDebt?o("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 20rpx","border-bottom":"1rpx solid#F7F7F7",background:"#fff"}},[o("v-uni-view",[e._v("实际付款")]),o("v-uni-view",{staticClass:"kaidan_rightinput"},[o("v-uni-input",{staticStyle:{color:"#d71345","text-align":"right","margin-right":"20rpx","font-size":"30rpx"},attrs:{placeholder:"输入实际付款金额",type:"digit"},model:{value:e.real_money,callback:function(t){e.real_money=t},expression:"real_money"}})],1)],1):e._e(),o("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 20rpx","border-bottom":"1rpx solid#F7F7F7","margin-top":"20rpx"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("采购时间")]),o("v-uni-picker",{attrs:{mode:"date",value:e.nowDay,end:e.nowDay},on:{change:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.bindDateChange.apply(void 0,arguments)},click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[o("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[o("v-uni-view",{staticStyle:{"margin-right":"20rpx"}},[e._v(e._s(e.nowDay.split(" ")[0]))]),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1)],1),o("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"10rpx 20rpx","border-bottom":"1rpx solid#F7F7F7"}},[o("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("备注")]),o("v-uni-input",{staticClass:"beizhu_style",attrs:{placeholder:"请输入备注",name:"input_beizhu"}})],1),o("v-uni-view",{staticStyle:{background:"#fff",padding:"10rpx 20rpx"}},[o("v-uni-view",{staticStyle:{width:"100%"}},[o("v-uni-view",{staticClass:"upload_image display_flex"},[e._l(e.Images,function(t,a){return e.Images&&e.Images.length>0?o("v-uni-view",{key:a,staticStyle:{position:"relative"}},[o("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx","margin-right":"10rpx"},attrs:{src:t}}),o("fa-icon",{staticStyle:{position:"absolute",top:"-10rpx",right:"-10rpx"},attrs:{type:"times-circle-o",size:"20",color:"#426ab3"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.removeImg(a)}}})],1):e._e()}),e.Images.length<3?o("v-uni-view",{staticStyle:{width:"180rpx",height:"180rpx","line-height":"220rpx","text-align":"center",border:"1rpx solid#ccc","border-radius":"16rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.upload_image.apply(void 0,arguments)}}},[o("fa-icon",{attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1):e._e()],2)],1)],1)],1)],1),o("v-uni-view",{staticClass:"bottomEle display_flex_bet",staticStyle:{padding:"0 30rpx","margin-top":"60rpx"}},[o("v-uni-view",{staticStyle:{color:"#333333","font-weight":"bold"}},[e.user.rights&&"0"!=e.user.rights.othercurrent[0]?o("v-uni-view",[e._v("合计：￥0")]):o("v-uni-view",[e._v("合计：￥"+e._s(e.real_money))]),o("v-uni-view",[e._v("总数："+e._s(e.total_num))])],1),o("v-uni-view",{staticClass:"display_flex"},[-1!=e.othercurrent.indexOf("1")||1==e.identity?o("v-uni-button",{staticClass:"confrim_button",staticStyle:{background:"#a1aa16"},attrs:{disabled:e.button_disabled,"form-type":"submit","data-type":"1"}},[e._v("采购")]):e._e()],1)],1)],1)],1)],1)},i=[];o.d(t,"a",function(){return a}),o.d(t,"b",function(){return i})},"258c":function(e,t,o){"use strict";o.r(t);var a=o("01c3"),i=o("5fed");for(var n in i)"default"!==n&&function(e){o.d(t,e,function(){return i[e]})}(n);o("3863");var r=o("f0c5"),s=Object(r["a"])(i["default"],a["a"],a["b"],!1,null,"9349eaa0",null);t["default"]=s.exports},3863:function(e,t,o){"use strict";var a=o("fba4"),i=o.n(a);i.a},"58bf":function(e,t,o){t=e.exports=o("2350")(!1),t.push([e.i,".page[data-v-9349eaa0]{color:#4d4d4d;font-size:%?28?%;height:calc(100vh - %?110?%);overflow:scroll}.display_flex_bet[data-v-9349eaa0]{background:#fff}.bottomEle[data-v-9349eaa0]{position:fixed;bottom:0;left:0;width:calc(100% - %?30?%);background:#fafafa;padding:%?20?% %?0?% %?20?% %?30?%}.pro_list[data-v-9349eaa0]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.pro_listitem[data-v-9349eaa0]{background-color:#fff;padding:%?10?% %?20?%;border-bottom:%?1?% solid#ddd}.pro_allmoney[data-v-9349eaa0]{background-color:#fff;padding:%?10?% %?20?%;text-align:right;font-size:%?32?%;color:#f30}.beizhu_style[data-v-9349eaa0]{text-align:right;width:calc(100% - %?40?%);background-color:#fff;max-height:%?100?%}.confrim_button[data-v-9349eaa0]{background:#1651aa;color:#fff;font-weight:700;font-size:%?32?%;border-radius:unset;padding:0 %?50?%}",""])},"5fed":function(e,t,o){"use strict";o.r(t);var a=o("717c"),i=o.n(a);for(var n in a)"default"!==n&&function(e){o.d(t,e,function(){return a[e]})}(n);t["default"]=i.a},"717c":function(e,t,o){"use strict";(function(e){var a=o("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(o("795b"));o("6b54");var n=a(o("5d73"));o("c5f6");var r,s,u=a(o("9546")),c=a(o("7fd5")),l=(a(o("a2fc")),a(o("9f50")),a(o("856d")),{data:function(){return{user:uni.getStorageSync("user"),identity:uni.getStorageSync("identity"),othercurrent:"",Images:[],stock:"",shop_name:"",products:null,account:"",button_disabled:!1,beizhu_text:"",real_money:0,all_money:0,really_total_money:0,producer:null,total_num:0,nowDay:c.default.getDay(0,!0,!0),wetherDebt:!1}},onLoad:function(){s=this,r=uni.getStorageSync("uid"),this.products=uni.getStorageSync("products");for(var e=0;e<this.products.length;e++)this.all_money=Number((this.products[e].total_money+this.all_money).toFixed(2)),this.really_total_money=Number((this.products[e].really_total_money+this.really_total_money).toFixed(2)),this.total_num+=Number(this.products[e].num);this.real_money=Number(this.all_money.toFixed(2)),s.user.rights&&s.user.rights.othercurrent&&(s.othercurrent=s.user.rights.othercurrent)},onShow:function(){s.producer=uni.getStorageSync("producer"),s.stock=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",s.account=uni.getStorageSync("account")},methods:{changeDebtStatus:function(e){0==e.detail.value&&(this.real_money=Number(this.all_money.toFixed(2))),s.wetherDebt=e.detail.value},bindDateChange:function(e){s.nowDay=e.detail.value+" 00:00:00"},removeImg:function(e){s.Images.splice(e,1),s.Images=s.Images},upload_image:function(){s.user.is_vip?uni.chooseImage({count:3,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){var t,o=Date.parse(new Date),a=e.tempFilePaths,i=!0,r=!1,c=void 0;try{for(var l,d=(0,n.default)(a);!(i=(l=d.next()).done);i=!0){var p=l.value;t=u.default.File(o+".jpg",p)}}catch(f){r=!0,c=f}finally{try{i||null==d.return||d.return()}finally{if(r)throw c}}t.save().then(function(e){var t=!0,o=!1,a=void 0;try{for(var i,r=(0,n.default)(e);!(t=(i=r.next()).done);t=!0){var u=i.value;s.Images.push(u.url)}}catch(f){o=!0,a=f}finally{try{t||null==r.return||r.return()}finally{if(o)throw a}}})}}):uni.showToast({title:"您还不是会员，无法使用",icon:"none"})},formSubmit:function(t){uni.getStorageSync("identity");this.button_disabled=!0;t.detail.formId;var o=1;if(uni.showLoading({title:"上传中..."}),""==uni.getStorageSync("producer")||void 0==uni.getStorageSync("producer"))return uni.showToast({icon:"none",title:"请选择供应商"}),void(this.button_disabled=!1);for(var a=new Array,i=[],n=0;n<this.products.length;n++){var l=Number(this.products[n].reserve)+this.products[n].num,d={},p=u.default.Query("Bills"),f=u.default.Pointer("_User"),v=f.set(r),g=u.default.Pointer("Goods"),m=g.set(this.products[n].objectId),_=uni.getStorageSync("masterId"),h=u.default.Pointer("_User"),y=h.set(_);if(p.set("goodsName",this.products[n].goodsName),p.set("retailPrice",this.products[n].modify_retailPrice),p.set("num",Number(this.products[n].num)),p.set("total_money",Number(this.products[n].total_money)),p.set("really_total_money",Number(this.products[n].really_total_money)),p.set("goodsId",m),p.set("userId",v),p.set("opreater",y),p.set("type",1),p.set("extra_type",o),p.set("status",!1),p.set("createdTime",{__type:"Date",iso:s.nowDay}),s.producer){var b=u.default.Pointer("producers"),w=b.set(s.producer.objectId);p.set("producer",w)}var S={};if(s.stock&&s.stock.objectId){var x=u.default.Pointer("stocks"),k=x.set(s.stock.objectId);p.set("stock",k),d.stock=s.stock.stock_name}d.goodsName=this.products[n].goodsName,d.modify_retailPrice=this.products[n].modify_retailPrice.toString(),d.retailPrice=this.products[n].retailPrice,d.total_money=this.products[n].total_money,S.costPrice=this.products[n].costPrice,S.retailPrice=this.products[n].retailPrice,S.objectId=this.products[n].objectId,S.reserve=l,this.products[n].selectd_model&&(S.selected_model=this.products[n].selected_model,S.models=this.products[n].models),d.goodsId=S,d.num=this.products[n].num,d.type=1,a.push(p),i.push(d)}u.default.Query("Bills").saveAll(a).then(function(e){for(var a=[],n=0;n<e.length;n++)a.push(e[n].success.objectId);var l=u.default.Pointer("_User"),d=l.set(r),p=uni.getStorageSync("masterId"),f=u.default.Pointer("_User"),v=f.set(p),g=u.default.Query("order_opreations");if(g.set("beizhu",t.detail.value.input_beizhu),g.set("detail",i),g.set("real_num",s.total_num),g.set("type",1),g.set("extra_type",o),g.set("bills",a),g.set("opreater",v),g.set("master",d),s.stock&&s.stock.objectId){var m=u.default.Pointer("stocks"),_=m.set(s.stock.objectId);g.set("stock",_)}if(g.set("goodsName",s.products[0].goodsName),g.set("real_money",Number(s.real_money)),g.set("debt",s.all_money-Number(s.real_money)),s.account){var h=u.default.Pointer("accounts"),y=h.set(s.account.objectId);g.set("account",y);var b=u.default.Query("accounts");b.get(s.account.objectId).then(function(e){e.set("money",e.money-Number(s.real_money)),e.save().then(function(e){})})}if(g.set("recordType","new"),s.producer){var w=u.default.Pointer("producers"),S=w.set(s.producer.objectId);if(g.set("producer",S),s.all_money-Number(s.real_money)>0){var x=u.default.Query("producers");x.get(s.producer.objectId).then(function(e){var t=e.debt?e.debt:0;t+=s.all_money-Number(s.real_money);var o=u.default.Query("producers");o.get(s.producer.objectId).then(function(e){e.set("debt",t),e.save()})})}}g.set("all_money",s.all_money),g.set("Images",s.Images),g.set("status",!1),g.set("createdTime",{__type:"Date",iso:s.nowDay}),g.save().then(function(e){var t=e.objectId;uni.hideLoading(),uni.showToast({title:"产品采购成功",icon:"success",duration:1e3,complete:function(){setTimeout(function(){c.default.log(uni.getStorageSync("user").nickName+"采购了'"+s.products[0].goodsName+"'等"+s.products.length+"商品",11,t),s.button_disabled=!1,uni.setStorageSync("is_option",!0),uni.removeStorageSync("_warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("category"),uni.removeStorageSync("warehouse"),uni.redirectTo({url:"/pages/report/EnteringHistory/SellDetail/SellDetail?id="+t})},1e3)}})})},function(t){e.log("异常处理")})},can_addGoods:function(){return new i.default(function(t,o){var a=uni.getStorageSync("products"),i=uni.getStorageSync("warehouse");if(i){var r=!0,s=!1,u=void 0;try{for(var c,l=function(){var o=c.value;if(""==o.stocks.stock_name||void 0==o.stocks.stock_name||o.stocks.stock_name!=i[0].stock.stock_name)return uni.showModal({title:"'"+o.goodsName+"'没有关联到调出仓库",content:"是否将它关联到此仓库",showCancel:!0,success:function(a){e.log(a),a.confirm?t([!0,o]):t([!1])},fail:function(){}}),{v:void 0};t([!1])},d=(0,n.default)(a);!(r=(c=d.next()).done);r=!0){var p=l();if("object"===typeof p)return p.v}}catch(f){s=!0,u=f}finally{try{r||null==d.return||d.return()}finally{if(s)throw u}}}else t([!1])})}}});t.default=l}).call(this,o("5a52")["default"])},"9f50":function(e,t,o){"use strict";(function(e){var a=o("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(o("9546")),n={send_in:function(t){var o=uni.getStorageSync("setting").wx_openid;uni.request({url:"https://www.jimuzhou.com/api/send_temp.php",method:"POST",data:{openid:o,frist:t.frist,data1:t.data1,data2:t.data2,remark:t.remark,url:t.url,type:"in"},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t)}})},send_in_noconfrim:function(t){var o=uni.getStorageSync("setting").wx_openid;uni.request({url:"https://www.jimuzhou.com/api/send_temp.php",method:"POST",data:{openid:o,frist:t.frist,data1:t.data1,data2:t.data2,data3:t.data3,data4:t.data4,remark:t.remark,url:t.url,type:"in_noconfrim"},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t)}})},send_in_mini:function(t){var o={touser:uni.getStorageSync("openid"),template_id:"nqZl9FWDofCo9cxU4de45grLKh2GU-PJcAvWSbJMy9k",page:"/pages/report/EnteringHistory/detail/detail?id="+t.id,form_id:t.form_Id,data:t,emphasis_keyword:""};i.default.sendWeAppMessage(o).then(function(t){e.log(t)}).catch(function(t){e.log(t)})},send_out_mini:function(t){var o={touser:uni.getStorageSync("openid"),template_id:"BKT2_0OuWF3mLZGvFmpRzWFa_Dyr4EIppl_LFF1uRLE",page:"/pages/report/EnteringHistory/detail/detail?id="+t.id,form_id:t.form_Id,data:t,emphasis_keyword:""};i.default.sendWeAppMessage(o).then(function(t){e.log(t)}).catch(function(t){e.log(t)})},send_temp:function(t){var o=uni.getStorageSync("setting").wx_openid;uni.request({url:"https://www.jimuzhou.com/api/send_temp.php",method:"POST",data:{openid:o,data1:t.data1,data2:t.data2,data3:t.data3,data4:t.data4,remark:"备注:"+t.remark,url:t.url,type:"out"},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t)}})}};t.default=n}).call(this,o("5a52")["default"])},a2fc:function(e,t,o){"use strict";(function(e){var a=o("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(o("f499"));o("c5f6"),o("7514");var n=a(o("5d73")),r=a(o("795b")),s=a(o("9546")),u={delete_goods:function(t){return new r.default(function(o,a){var i=0,r=!0,u=!1,c=void 0;try{for(var l,d=(0,n.default)(t);!(r=(l=d.next()).done);r=!0){var p=l.value,f=s.default.Query("Goods");f.destroy(p.objectId).then(function(e){i+=1,i==t.length&&o(!0)}).catch(function(t){e.log(t)})}}catch(v){u=!0,c=v}finally{try{r||null==d.return||d.return()}finally{if(u)throw c}}})},upload_good_withNoCan:function(t,o){return new r.default(function(a,i){var n=uni.getStorageSync("uid"),r=s.default.Pointer("_User"),u=r.set(n),c=t.reserve,l=s.default.Pointer("stocks"),d=l.set(o.objectId),p=s.default.Query("Goods");p.equalTo("userId","==",n),p.equalTo("goodsName","==",t.goodsName),p.equalTo("stocks","==",o.objectId),p.find().then(function(o){if(e.log(o),o.length>=1)a([!1,"该商品存在此仓库中"]);else{var i=s.default.Query("Goods");if(i.set("goodsName",t.goodsName),i.set("goodsIcon",t.goodsIcon),i.set("costPrice",t.costPrice),i.set("retailPrice",t.retailPrice),i.set("reserve",Number(t.reserve)),i.set("productCode",t.productCode?t.productCode:""),i.set("stocks",d),i.set("product_info",t.product_info?t.product_info:""),i.set("producer",t.producer?t.producer:""),i.set("packingUnit",t.packingUnit?t.packingUnit:""),i.set("packageContent",t.packageContent?t.packageContent:""),i.set("warning_num",Number(t.warning_num?t.warning_num:0)),i.set("stocktype",Number(t.warning_num?t.warning_num:0)>=Number(c)?0:1),t.second_class){var n=s.default.Pointer("class_user"),r=n.set(t.goodsClass);i.set("second_class",p);var l=s.default.Pointer("second_class"),p=l.set(t.second_class);i.set("goodsClass",r)}i.set("userId",u),i.save().then(function(t){e.log(t),a([!0,t])}).catch(function(t){e.log(t)})}})})},upload_good:function(t){return new r.default(function(o,a){var i=JSON.parse(localStorage.getItem("bmob")).objectId,n=s.default.Pointer("_User"),r=n.set(i),u=s.default.Pointer("class_user"),c=u.set(t.goodsClass),l=s.default.Pointer("second_class"),d=l.set(t.second_class),p=s.default.Query("Goods");p.equalTo("userId","==",i),p.equalTo("goodsName","==",t.goodsName),p.equalTo("position","==",t.position),p.equalTo("stocks","==",t.stocks),p.find().then(function(a){if(e.log(a),a.length>=1)o([!1,a]);else{var i=t.reserve,n=s.default.Pointer("stocks"),u=n.set(t.stocks),l=s.default.Query("Goods");l.set("goodsName",t.goodsName),l.set("goodsIcon",t.goodsIcon),l.set("costPrice",t.costPrice),l.set("retailPrice",t.retailPrice),l.set("producttime",t.producttime),l.set("nousetime",t.nousetime),l.set("regNumber",t.regNumber),l.set("reserve",Number(t.reserve)),l.set("productCode",t.productCode),l.set("stocks",u),l.set("product_info",t.product_info),l.set("producer",t.producer),l.set("packingUnit",t.packingUnit),l.set("packageContent",t.packageContent),l.set("warning_num",Number(t.warning_num)),l.set("stocktype",Number(t.warning_num)>=Number(i)?0:1),l.set("second_class",d),l.set("goodsClass",c),l.set("userId",r),l.save().then(function(t){e.log(t),o([!0,t])}).catch(function(t){e.log(t)})}})})},get_fristclass:function(){var e=JSON.parse(localStorage.getItem("bmob")).objectId;return new r.default(function(t,o){var a=s.default.Query("class_user");a.equalTo("parent","==",e),a.find().then(function(e){localStorage.setItem("frist_class",(0,i.default)(e)),t(e)})})},get_secondclass:function(e){return new r.default(function(t,o){var a=s.default.Query("class_user");a.field("second",e),a.relation("second_class").then(function(e){t(e.results)})})},getstock_list:function(e){var t=JSON.parse(localStorage.getItem("bmob")).objectId;return new r.default(function(o,a){var n=s.default.Query("stocks");n.order("-num"),n.include("charge","shop"),n.equalTo("parent","==",t),e&&n.equalTo("stock_name","==",{$regex:e+".*"}),n.limit(500),n.find().then(function(e){localStorage.setItem("stocks",(0,i.default)(e)),o(e)})})}};t.default=u}).call(this,o("5a52")["default"])},fba4:function(e,t,o){var a=o("58bf");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=o("4f06").default;i("5cd72a40",a,!0,{sourceMap:!1,shadowMode:!1})}}]);