(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-staff-add-add"],{"262d":function(t,e,a){"use strict";var s=a("f39f"),n=a.n(s);n.a},6052:function(t,e,a){"use strict";a.r(e);var s=a("ed2c"),n=a("e134");for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);a("262d");var o=a("f0c5"),f=Object(o["a"])(n["default"],s["a"],s["b"],!1,null,"50597cfb",null);e["default"]=f.exports},c76f:function(t,e,a){"use strict";(function(t){var s=a("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("7514");var n,i,o,f,d=s(a("9546")),r=s(a("4d52")),c=s(a("96bd")),l={},u={components:{faIcon:r.default,uniNavBar:c.default},data:function(){return{stocks:uni.getStorageSync("_warehouse"),modify_desc:"添加",disabled:!0,shop_name:"",staff_name:"",staff_address:"",staff_phone:"",staff_password:""}},onLoad:function(t){n=this,uni.getStorageSync("uid")},onShow:function(){if(f=uni.getStorageSync("staff"),o=uni.getStorageSync("shop"),l=uni.getStorageSync("staffRights")||{},f&&(uni.setNavigationBarTitle({title:"修改员工信息"}),n.modify_desc="修改",n.shop_name=f.shop?f.shop.name:"",n.staff_name=f.nickName,n.staff_address=f.address,n.staff_phone=f.mobilePhoneNumber,n.staff_password=f.pwd||"",uni.setStorageSync("staffRights",f.rights)),o){n.shop_name=o.name;var t=d.default.Pointer("shops");i=t.set(o.objectId)}},methods:{switchChange:function(t){n.disabled=t.detail.value},start_add:function(){null==this.staff_name?uni.showToast({title:"请输入姓名",icon:"none"}):this.staff_phone.length<11?uni.showToast({title:"账号不能少于11位",icon:"none"}):""==this.staff_password||null==this.staff_password||void 0==this.staff_password?uni.showToast({title:"请输入密码",icon:"none"}):this.staff_password.length<6?uni.showToast({title:"密码不能少于6位",icon:"none"}):n.add_data()},add_data:function(){if(uni.showLoading({title:"上传中..."}),f){uni.hideLoading();var e=uni.getStorageSync("uid"),a=d.default.Pointer("_User"),s=a.set(e),r=d.default.Query("_User");r.set("username",n.staff_phone),r.set("nickName",n.staff_name),r.set("password",n.staff_password),r.set("pwd",n.staff_password),r.set("mobilePhoneNumber",n.staff_phone),r.set("rights",l),r.set("address",null==n.staff_address?"":n.staff_address),r.set("avatarUrl","http://bmob-cdn-23134.b0.upaiyun.com/2019/04/29/4705b31340bfff8080c068f52fd17e2c.png"),r.set("masterId",s),r.set("disabled",!n.disabled),r.set("stocks",l.select_stocks||[]),r.set("identity",2),o&&r.set("shop",i),r.set("id",f.objectId),r.save().then(function(e){t.log(e),uni.showToast({title:"修改成功"}),n.select_stocks=[],uni.removeStorageSync("staffRights")}).catch(function(e){t.log(e)})}else{var c=d.default.Query("_User");c.equalTo("mobilePhoneNumber","==",n.staff_phone),c.find().then(function(e){if(t.log(e),0==e.length){uni.hideLoading();var a=uni.getStorageSync("uid"),s=d.default.Pointer("_User"),f=s.set(a),r=d.default.Query("_User");r.set("username",n.staff_phone),o&&r.set("shop",i),r.set("stocks",l.select_stocks||[]),r.set("nickName",n.staff_name),r.set("password",n.staff_password),r.set("pwd",n.staff_password),r.set("mobilePhoneNumber",n.staff_phone),r.set("rights",l),r.set("address",null==n.staff_address?"":n.staff_address),r.set("avatarUrl","http://bmob-cdn-23134.b0.upaiyun.com/2019/04/29/4705b31340bfff8080c068f52fd17e2c.png"),r.set("masterId",f),r.set("have_out",0),r.set("disabled",!n.disabled),r.save().then(function(e){t.log(e),uni.showToast({title:"添加成功"}),n.select_stocks=[],uni.removeStorageSync("staffRights")}).catch(function(t){209==t.code&&uni.showToast({title:"已存在此账号",icon:"none"})})}else uni.hideLoading(),uni.showToast({title:"已存在此账号",icon:"none"})})}}}};e.default=u}).call(this,a("5a52")["default"])},e134:function(t,e,a){"use strict";a.r(e);var s=a("c76f"),n=a.n(s);for(var i in s)"default"!==i&&function(t){a.d(e,t,function(){return s[t]})}(i);e["default"]=n.a},ed2c:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("uni-nav-bar",{attrs:{fixed:!1,color:"#333333","background-color":"#FFFFFF","right-text":t.modify_desc},on:{"click-right":function(e){arguments[0]=e=t.$handleEvent(e),t.start_add.apply(void 0,arguments)}}}),a("v-uni-view",[a("v-uni-view",{staticClass:"display_flex item"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[t._v("姓名")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入姓名"},model:{value:t.staff_name,callback:function(e){t.staff_name=e},expression:"staff_name"}})],1),a("v-uni-view",{staticClass:"display_flex item"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[t._v("账号")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"手机号(员工不用注册,直接在员工登陆界面输入即可)",type:"number",maxlength:"11"},model:{value:t.staff_phone,callback:function(e){t.staff_phone=e},expression:"staff_phone"}})],1),a("v-uni-view",{staticClass:"display_flex item"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[t._v("密码")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入登录密码",type:"number",maxlength:"11"},model:{value:t.staff_password,callback:function(e){t.staff_password=e},expression:"staff_password"}})],1),a("v-uni-view",{staticClass:"display_flex item"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[t._v("联系地址")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请输入地址"},model:{value:t.staff_address,callback:function(e){t.staff_address=e},expression:"staff_address"}})],1),a("v-uni-navigator",{staticClass:"display_flex_bet item",attrs:{"hover-class":"none",url:"../../shops/shops?type=choose"}},[a("v-uni-view",{staticClass:"display_flex"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[t._v("门店")]),a("v-uni-input",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"请选择门店",disabled:"true"},model:{value:t.shop_name,callback:function(e){t.shop_name=e},expression:"shop_name"}})],1),a("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#ddd"}})],1),a("v-uni-navigator",{staticClass:"display_flex_bet item",attrs:{"hover-class":"none",url:"../authAdd/authAdd"}},[a("v-uni-view",{staticClass:"display_flex"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[t._v("权限分配")]),a("v-uni-view",{staticStyle:{width:"calc(100% - 200rpx)"},attrs:{placeholder:"权限分配"}})],1),a("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#ddd"}})],1),a("v-uni-view",{staticClass:"display_flex_bet item",staticStyle:{"margin-bottom":"60rpx"}},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[t._v("启用")]),a("v-uni-switch",{attrs:{checked:t.disabled},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.switchChange.apply(void 0,arguments)}}})],1)],1)],1)},n=[];a.d(e,"a",function(){return s}),a.d(e,"b",function(){return n})},f39f:function(t,e,a){var s=a("fe6a");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var n=a("4f06").default;n("c623bbf4",s,!0,{sourceMap:!1,shadowMode:!1})},fe6a:function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,"uni-page-body[data-v-50597cfb]{background:#fafafa}.item[data-v-50597cfb]{padding:%?20?% %?30?%;background:#fff;border-bottom:%?1?% solid#f6f5ec}.rights_item[data-v-50597cfb]{margin-bottom:%?20?%}body.?%PAGE?%[data-v-50597cfb]{background:#fafafa}",""])}}]);