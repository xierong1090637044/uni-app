(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-custom-custom_detail-debt_history-debt_history"],{"114b":function(e,t,n){"use strict";(function(e){var r=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("c5f6");var o=r(n("5d73"));n("7514");var a=r(n("795b")),u=r(n("9546")),d={get_customList:function(e,t){return new a.default(function(n,r){var o=uni.getStorageSync("uid"),a=u.default.Query("customs");a.order("num"),a.equalTo("parent","==",o),a.equalTo("disabled","==",e),t&&a.equalTo("name","==",{$regex:t+".*"}),a.find().then(function(e){n(e)})})},get_customCount:function(){return new a.default(function(e,t){var n=uni.getStorageSync("uid"),r=u.default.Query("customs");r.equalTo("parent","==",n),r.find().then(function(t){var n=t,r=!0,a=!1,d=void 0;try{for(var s,i=function(){var e=s.value,t=u.default.Query("Bills");t.equalTo("type","==",-1),t.equalTo("custom","==",e.objectId),t.find().then(function(t){e.relations=t})},l=(0,o.default)(n);!(r=(s=l.next()).done);r=!0)i()}catch(c){a=!0,d=c}finally{try{r||null==l.return||l.return()}finally{if(a)throw d}}e(n)})})},add_custom:function(t){e.log(t);var n=JSON.parse(localStorage.getItem("bmob")).objectId;return new a.default(function(r,o){var a=u.default.Pointer("_User"),d=a.set(n);if(t.objectId){var s=u.default.Query("customs");s.set("custom_name",t.custom_name),s.set("debt",Number(t.debt)),s.set("custom_address",t.custom_address),s.set("custom_phone",t.custom_phone),s.set("parent",d),s.set("disabled",!t.disabled),s.set("id",t.objectId),s.save().then(function(e){r(e)}).catch(function(t){e.log(t)})}else{var i=u.default.Query("customs");i.equalTo("parent","==",n),i.equalTo("name","==",t.custom_name),i.find().then(function(n){if(e.log(n),0==n.length){var o=u.default.Query("customs");o.set("custom_name",t.custom_name),o.set("debt",Number(t.debt)),o.set("custom_address",t.custom_address),o.set("custom_phone",t.custom_phone),o.set("have_out",0),o.set("disabled",!t.disabled),o.set("parent",d),o.save().then(function(e){r(e)}).catch(function(t){e.log(t)})}else r(!1)})}})},delete_custom:function(t){return new a.default(function(n,r){var o=u.default.Query("customs");o.destroy(t).then(function(e){n(e)}).catch(function(t){e.log(t)})})},custom_detail:function(t){return new a.default(function(n,r){var o=u.default.Query("customs");o.get(t).then(function(e){n(e)}).catch(function(t){e.log(t)})})},get_moneyList:function(t){return new a.default(function(n,r){var o=u.default.Query("order_opreations");o.equalTo("custom","==",t),o.include("opreater","account"),o.find().then(function(t){e.log(t),n(t)})})}};t.default=d}).call(this,n("5a52")["default"])},"156f":function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,'@charset "UTF-8";\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.frist[data-v-14249dd8]{background:#fff;padding:%?20?% %?30?%;border-bottom:%?1?% solid #ddd}.list_item[data-v-14249dd8]{padding:%?16?% 0;border-bottom:%?1?% solid #ddd}.select[data-v-14249dd8]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;padding:%?20?% %?30?%;border-bottom:%?1?% solid #f7f7f7;background:#fff}.select .section[data-v-14249dd8]{width:50%;text-align:center}',""])},"2cb9":function(e,t,n){"use strict";n.r(t);var r=n("fdfe"),o=n.n(r);for(var a in r)"default"!==a&&function(e){n.d(t,e,function(){return r[e]})}(a);t["default"]=o.a},"32d6":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[e.loading?n("loading"):n("v-uni-view",[n("v-uni-view",{staticClass:"select"},[n("v-uni-view",{staticClass:"section",staticStyle:{"border-right":"1rpx solid#DDDDDD"}},[n("v-uni-picker",{attrs:{mode:"date",end:e.start_date_desc},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.bindDate_startChange.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"picker"},[n("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v(e._s(e.start_date.split(" ")[0]))]),n("fa-icon",{attrs:{type:"angle-down",size:"20",color:"#999"}})],1)],1)],1),n("v-uni-view",{staticClass:"section"},[n("v-uni-picker",{attrs:{mode:"date",end:e.end_date_desc},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.bindDate_endChange.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"picker"},[n("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v(e._s(e.end_date.split(" ")[0]))]),n("fa-icon",{attrs:{type:"angle-down",size:"20",color:"#999"}})],1)],1)],1)],1),n("v-uni-scroll-view",{staticStyle:{height:"calc(100vh - 182rpx)",padding:"0 30rpx",background:"#FFFFFF",width:"calc(100% - 60rpx)"},attrs:{"scroll-y":!0}},e._l(e.debt_list,function(t,r){return n("v-uni-navigator",{key:r,staticClass:"list_item",attrs:{"hover-class":"none",url:"/pages/finance/recordDetail/recordDetail?id="+t.objectId}},[n("v-uni-view",{staticClass:"display_flex_bet"},[n("v-uni-view",[e._v("收款账户："),n("v-uni-text",[e._v(e._s(t.account.name))])],1),n("v-uni-view",[n("v-uni-text",{staticStyle:{color:"#2ca879"}},[e._v("+"+e._s(t.real_money))])],1)],1),t.opreater?n("v-uni-view",[e._v("操作人："+e._s(t.opreater.nickName))]):e._e(),n("v-uni-view",{staticStyle:{color:"#999999"}},[e._v(e._s(t.createdAt))])],1)}),1),n("v-uni-view",{staticClass:"display_flex",staticStyle:{position:"fixed",bottom:"0",width:"100%",background:"#fff",padding:"20rpx 30rpx","border-top":"1rpx solid#F4F4F4"}},[n("v-uni-view",{staticStyle:{"margin-right":"60rpx"}},[e._v("收入："),n("v-uni-text",{staticStyle:{color:"#2ca879","font-weight":"bold"}},[e._v("￥"+e._s(e.inMoney))])],1)],1)],1)],1)},o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},7603:function(e,t,n){"use strict";var r=n("eb7d"),o=n.n(r);o.a},"7fd5":function(e,t,n){"use strict";(function(t){var r=n("288e");n("6b54"),n("7514");var o=r(n("5d73"));n("c5f6");var a=r(n("795b")),u=r(n("9546"));e.exports={enterAddGoodNum:function(e){var n=this;return new a.default(function(r,a){for(var d=function(a){var d=0,s=u.default.Query("Goods");s.get(e[a].objectId).then(function(i){var l=i;if(e[a].selectd_model){var c=!0,f=!1,v=void 0;try{for(var m,g=(0,o.default)(e[a].selected_model);!(c=(m=g.next()).done);c=!0){var h=m.value,y=!0,_=!1,b=void 0;try{for(var p,w=(0,o.default)(l.models);!(y=(p=w.next()).done);y=!0){var S=p.value;S.id==h.id&&(S.reserve=Number(S.reserve)+Number(h.num)),delete S.num}}catch(N){_=!0,b=N}finally{try{y||null==w.return||w.return()}finally{if(_)throw b}}}}catch(N){f=!0,v=N}finally{try{c||null==g.return||g.return()}finally{if(f)throw v}}d=Number(l.reserve)+Number(e[a].num),s.set("models",l.models)}else d=Number(l.reserve)+Number(e[a].num);s.set("reserve",d),s.set("id",e[a].objectId),s.save().then(function(o){if(e[a].header){var d=u.default.Query("Goods");d.equalTo("header","==",e[a].header.objectId),d.equalTo("order","==",1),d.statTo("sum","reserve"),d.find().then(function(o){t.log("dasds",o);var d=o[0]._sumReserve,s=u.default.Query("Goods");s.set("reserve",d),s.set("id",e[a].header.objectId),s.save().then(function(t){n.modifyStockType(e[a].header.objectId),a==e.length-1&&r(!0)})})}else n.modifyStockType(e[a].objectId),a==e.length-1&&r(!0)}).catch(function(e){t.log(e)})})},s=0;s<e.length;s++)d(s)})},outRedGoodNum:function(e){var n=this;return new a.default(function(r,a){for(var d=function(a){var d=0,s=u.default.Query("Goods");s.get(e[a].objectId).then(function(i){var l=i;if(e[a].selectd_model){var c=!0,f=!1,v=void 0;try{for(var m,g=(0,o.default)(e[a].selected_model);!(c=(m=g.next()).done);c=!0){var h=m.value,y=!0,_=!1,b=void 0;try{for(var p,w=(0,o.default)(l.models);!(y=(p=w.next()).done);y=!0){var S=p.value;d+=Number(S.reserve),S.id==h.id&&(S.reserve=Number(S.reserve)-Number(h.num)),delete S.num}}catch(N){_=!0,b=N}finally{try{y||null==w.return||w.return()}finally{if(_)throw b}}}}catch(N){f=!0,v=N}finally{try{c||null==g.return||g.return()}finally{if(f)throw v}}d=Number(l.reserve)-Number(e[a].num),s.set("models",l.models)}else d=Number(l.reserve)-Number(e[a].num);s.set("reserve",d),s.set("id",e[a].objectId),s.save().then(function(t){if(e[a].header){var o=u.default.Query("Goods");o.equalTo("header","==",e[a].header.objectId),o.equalTo("order","==",1),o.statTo("sum","reserve"),o.find().then(function(t){var o=t[0]._sumReserve,d=u.default.Query("Goods");d.set("reserve",o),d.set("id",e[a].header.objectId),d.save().then(function(t){n.modifyStockType(e[a].header.objectId),a==e.length-1&&r(!0)})})}else n.modifyStockType(e[a].objectId),a==e.length-1&&r(!0)}).catch(function(e){t.log(e)})})},s=0;s<e.length;s++)d(s)})},enterAddGoodNumNew:function(e){var n=this;return new a.default(function(r,a){for(var d=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",s=uni.getStorageSync("uid"),i=function(a){var i=0,l=u.default.Query("Goods");l.get(e[a].objectId).then(function(l){if(e[a].selectd_model){var c=!0,f=!1,v=void 0;try{for(var m,g=(0,o.default)(e[a].selected_model);!(c=(m=g.next()).done);c=!0){var h=m.value,y=!0,_=!1,b=void 0;try{for(var p,w=(0,o.default)(e[a].models);!(y=(p=w.next()).done);y=!0){var S=p.value;S.id==h.id&&(S.reserve=Number(S.reserve)+Number(h.num)),delete S.num}}catch(x){_=!0,b=x}finally{try{y||null==w.return||w.return()}finally{if(_)throw b}}}}catch(x){f=!0,v=x}finally{try{c||null==g.return||g.return()}finally{if(f)throw v}}i=Number(e[a].reserve)+Number(e[a].num),l.set("models",e[a].models)}else i=Number(e[a].reserve)+Number(e[a].num);l.set("reserve",i),l.save();var N=u.default.Query("Goods");N.equalTo("userId","==",s),N.equalTo("header","==",e[a].objectId),N.equalTo("stocks","==",d.objectId),N.find().then(function(o){if(0==o.length)n.upload_good_withNoCan(e[a],d,Number(e[a].num)).then(function(n){t.log(n),a==e.length-1&&r(!0)});else{var s=u.default.Query("Goods");s.set("id",o[0].objectId),s.set("reserve",o[0].reserve+Number(e[a].num)),s.save().then(function(n){t.log(n),a==e.length-1&&r(!0)}).catch(function(e){t.log(e)})}})}).catch(function(e){t.log(e)})},l=0;l<e.length;l++)i(l)})},outRedGoodNumNew:function(e){var n=this;return new a.default(function(r,a){for(var d=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",s=uni.getStorageSync("uid"),i=function(a){var i=0,l=u.default.Query("Goods");l.get(e[a].objectId).then(function(l){if(e[a].selectd_model){var c=!0,f=!1,v=void 0;try{for(var m,g=(0,o.default)(e[a].selected_model);!(c=(m=g.next()).done);c=!0){var h=m.value,y=!0,_=!1,b=void 0;try{for(var p,w=(0,o.default)(e[a].models);!(y=(p=w.next()).done);y=!0){var S=p.value;S.id==h.id&&(S.reserve=Number(S.reserve)-Number(h.num)),delete S.num}}catch(x){_=!0,b=x}finally{try{y||null==w.return||w.return()}finally{if(_)throw b}}}}catch(x){f=!0,v=x}finally{try{c||null==g.return||g.return()}finally{if(f)throw v}}i=Number(e[a].reserve)-Number(e[a].num),l.set("models",e[a].models)}else i=Number(e[a].reserve)-Number(e[a].num);l.set("reserve",i),l.save();var N=u.default.Query("Goods");N.equalTo("userId","==",s),N.equalTo("header","==",e[a].objectId),N.equalTo("stocks","==",d.objectId),N.find().then(function(o){if(0==o.length)n.upload_good_withNoCan(e[a],d,Number(e[a].num),"out").then(function(n){t.log(n),a==e.length-1&&r(!0)});else{var s=u.default.Query("Goods");s.set("id",o[0].objectId),s.set("reserve",o[0].reserve-Number(e[a].num)),s.save().then(function(n){t.log(n),a==e.length-1&&r(!0)}).catch(function(e){t.log(e)})}})}).catch(function(e){t.log(e)})},l=0;l<e.length;l++)i(l)})},upload_good_withNoCan:function(e,n,r,d){return new a.default(function(a,s){t.log(e);var i=uni.getStorageSync("uid"),l=u.default.Pointer("_User"),c=l.set(i),f=u.default.Pointer("stocks"),v=f.set(n.objectId),m=u.default.Pointer("Goods"),g="";g=e.header?m.set(e.header.objectId):m.set(e.objectId);var h=u.default.Query("Goods");if(h.set("goodsName",e.goodsName),h.set("goodsIcon",e.goodsIcon),"out"==d){if(h.set("reserve",0-Number(r)),e.goodsId&&e.goodsId.models){var y=!0,_=!1,b=void 0;try{for(var p,w=(0,o.default)(e.goodsId.models);!(y=(p=w.next()).done);y=!0){var S=p.value;S.reserve=0-Number(S.num)}}catch(P){_=!0,b=P}finally{try{y||null==w.return||w.return()}finally{if(_)throw b}}h.set("models",e.goodsId.models)}}else if("allocation"==d){if(h.set("reserve",Number(r)),e.selected_model&&e.selected_model.length>0){var N=!0,x=!1,I=void 0;try{for(var j,k=(0,o.default)(e.selected_model);!(N=(j=k.next()).done);N=!0){var T=j.value;T.reserve=Number(T.num),delete T.num}}catch(P){x=!0,I=P}finally{try{N||null==k.return||k.return()}finally{if(x)throw I}}h.set("models",e.selected_model)}}else if(h.set("reserve",Number(r)),e.goodsId&&e.goodsId.models){var Q=!0,q=!1,G=void 0;try{for(var D,C=(0,o.default)(e.goodsId.models);!(Q=(D=C.next()).done);Q=!0){var M=D.value;M.reserve=Number(M.num)}}catch(P){q=!0,G=P}finally{try{Q||null==C.return||C.return()}finally{if(q)throw G}}h.set("models",e.goodsId.models)}h.set("stocks",v),h.set("userId",c),h.set("header",g),h.set("costPrice",""+e.costPrice),h.set("retailPrice",""+e.retailPrice),h.set("order",1),h.save().then(function(e){t.log(e),a([!0,e])}).catch(function(e){t.log(e)})})},handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(e,n,r){var o=u.default.Pointer("_User"),a=o.set(uni.getStorageSync("uid"));if(-2==n){var d=u.default.Pointer("Goods"),s=d.set(r),i=u.default.Query("logs");i.equalTo("goodId","==",r),i.find().then(function(r){if(0==r.length){var o=u.default.Query("logs");o.set("parent",a),o.set("goodId",s),o.set("log",e),o.set("type",n),o.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}})}else{var l=u.default.Query("logs");l.set("parent",a),l.set("log",e),l.set("detail_id",r),l.set("type",n),l.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}},modifyStockType:function(e){var n=this,r=u.default.Query("Goods");r.get(e).then(function(e){var t=e;""==t.warning_num&&""==t.max_num?e.set("stocktype",1):void 0==t.warning_num&&void 0==t.max_num?e.set("stocktype",1):null==t.warning_num&&null==t.max_num?e.set("stocktype",1):(""!=t.warning_num&&(t.warning_num>=t.reserve?(e.set("stocktype",0),n.log(t.goodsName+"已经超过设置的最小库存值"+t.warning_num,-2,t.objectId)):t.warning_num<t.reserve&&t.reserve<t.max_num&&e.set("stocktype",1)),""!=t.max_num&&(t.max_num<=t.reserve?(e.set("stocktype",2),n.log(t.goodsName+"已经超过设置的最大库存值"+t.max_num,-2,t.objectId)):t.warning_num<t.reserve&&t.reserve<t.max_num&&e.set("stocktype",1))),e.save()}).catch(function(e){t.log(e)})},record_shopOut:function(e,n){t.log(e,n);var r=u.default.Query("shops");r.set("id",e),r.set("have_out",n),r.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})},record_staffOut:function(e){if(t.log(e,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var n=u.default.Query("_User");n.set("id",uni.getStorageSync("user").objectId),n.set("have_out",Number(e)+uni.getStorageSync("user").have_out),n.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}},get_allCost:function(){var e=uni.getStorageSync("uid");t.log(e);var n=u.default.Query("Goods");n.equalTo("userId","==",e),n.find().then(function(e){t.log(e);var n=!0,r=!1,a=void 0;try{for(var u,d=(0,o.default)(e);!(n=(u=d.next()).done);n=!0){var s=u.value;t.log(s),Number(s.costPrice)*s.reserve,s.reserve}}catch(i){r=!0,a=i}finally{try{n||null==d.return||d.return()}finally{if(r)throw a}}})},getDay:function(e,t){var n=this,r=new Date,o=r.getTime()+864e5*e;r.setTime(o);var a=r.getFullYear(),u=r.getMonth(),d=r.getDate();return u=n.handleMonth(u+1),d=n.handleMonth(d),t?a+"-"+u+"-"+d+" 00:00:00":a+"-"+u+"-"+d},js_date_time:function(e,t){var n=new Date(e),r=n.getFullYear(),o=n.getMonth()+1;o=o<10?"0"+o:o;var a=n.getDate();a=a<10?"0"+a:a;var u=n.getHours();u=u<10?"0"+u:u;var d=n.getMinutes(),s=n.getSeconds();return d=d<10?"0"+d:d,s=s<10?"0"+s:s,t?r+"-"+o+"-"+a+" "+u+":"+d:r+"-"+o+"-"+a},handleMonth:function(e){var t=e;return 1==e.toString().length&&(t="0"+e),t}}}).call(this,n("5a52")["default"])},c9e5:function(e,t,n){"use strict";n.r(t);var r=n("32d6"),o=n("2cb9");for(var a in o)"default"!==a&&function(e){n.d(t,e,function(){return o[e]})}(a);n("7603");var u=n("f0c5"),d=Object(u["a"])(o["default"],r["a"],r["b"],!1,null,"14249dd8",null);t["default"]=d.exports},eb7d:function(e,t,n){var r=n("156f");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var o=n("4f06").default;o("3b6196fe",r,!0,{sourceMap:!1,shadowMode:!1})},fdfe:function(e,t,n){"use strict";(function(e){var r=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("28a5");var o=r(n("5d73"));n("7514");var a,u,d=r(n("7fd5")),s=r(n("9546")),i=(r(n("114b")),r(n("120a"))),l={components:{loading:i.default},data:function(){return{start_date:d.default.getDay(0,!0),end_date:d.default.getDay(1,!0),start_date_desc:"",end_date_desc:"",inMoney:0,outMoney:0,debt_list:[],name:"",loading:!0}},methods:{bindDate_startChange:function(t){e.log(t),a.start_date=t.detail.value+" 00:00:00",a.getList()},bindDate_endChange:function(t){e.log(t),a.end_date=t.detail.value+" 00:00:00",a.getList()},getList:function(){var e=s.default.Query("order_opreations");e.equalTo("custom","==",u),e.equalTo("type","==",-1),e.equalTo("account","!=",null),e.include("opreater","account"),e.find().then(function(e){a.loading=!1,a.debt_list=e;var t=!0,n=!1,r=void 0;try{for(var u,d=(0,o.default)(e);!(t=(u=d.next()).done);t=!0){var s=u.value;-1==s.type?a.inMoney+=s.real_money:1==s.type&&(a.outMoney+=s.real_money)}}catch(i){n=!0,r=i}finally{try{t||null==d.return||d.return()}finally{if(n)throw r}}})}},onLoad:function(e){a=this,a.name=e.name,a.start_date_desc=a.start_date.split(" ")[0],a.end_date_desc=a.end_date.split(" ")[0],u=e.id,a.getList()}};t.default=l}).call(this,n("5a52")["default"])}}]);