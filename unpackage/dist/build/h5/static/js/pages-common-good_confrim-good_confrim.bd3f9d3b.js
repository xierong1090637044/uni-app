(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-common-good_confrim-good_confrim"],{3865:function(t,e,n){"use strict";n.r(e);var i=n("db4e"),o=n("711b");for(var a in o)"default"!==a&&function(t){n.d(e,t,function(){return o[t]})}(a);n("394a");var r=n("2877"),u=Object(r["a"])(o["default"],i["a"],i["b"],!1,null,"04c8706f",null);e["default"]=u.exports},"394a":function(t,e,n){"use strict";var i=n("d163"),o=n.n(i);o.a},5551:function(t,e,n){"use strict";(function(t){var i=n("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("c5f6"),n("28a5");var o=i(n("5d73"));n("7514");var a,r,u=i(n("c74b")),l=i(n("872f")),s=i(n("8fad")),c=i(n("0914")),d=i(n("b92d")),f=i(n("5753")),v={components:{unicard:l.default,faIcon:c.default,uninumberbox:s.default,uniNavBar:d.default,uniIcon:f.default},data:function(){return{products:[],user:uni.getStorageSync("user"),nums:[],selected_model:[]}},onLoad:function(e){var n=this;if(this.products=[],r=this,uni.removeStorageSync("is_option"),a=uni.getStorageSync("uid"),e.id){uni.showLoading({title:"加载中..."});var i=u.default.Query("Goods");"false"==e.type?i.equalTo("objectId","==",e.id):i.equalTo("productCode","==",e.id),i.equalTo("userId","==",a),i.equalTo("status","!=",-1),i.find().then(function(e){t.log(e),-1==e[0].status?uni.showToast({title:"该产品已删除",icon:"none"}):(e[0].num=1,e[0].total_money=1*e[0].costPrice,e[0].really_total_money=1*e[0].costPrice,e[0].modify_retailPrice=e[0].costPrice,e[0].models&&(e[0].selectd_model=e[0].models),n.products=e),uni.hideLoading()})}else{this.products=uni.getStorageSync("products");var l=!0,s=!1,c=void 0;try{for(var d,f=(0,o.default)(this.products);!(l=(d=f.next()).done);l=!0){var v=d.value;v.selectd_model=v.models}}catch(m){s=!0,c=m}finally{try{l||null==f.return||f.return()}finally{if(s)throw c}}this.products=this.products}},methods:{scanGoods:function(){uni.scanCode({success:function(e){uni.showLoading({title:"加载中..."});var n=e.result,i=n.split("-"),l=u.default.Query("Goods");"false"==i[1]?l.equalTo("objectId","==",i[0]):l.equalTo("productCode","==",i[0]),l.equalTo("userId","==",a),l.find().then(function(e){if(t.log(e),-1==e[0].status)uni.showToast({title:"该产品已删除",icon:"none"});else{var n=!0,i=!1,a=void 0;try{for(var u,l=(0,o.default)(e);!(n=(u=l.next()).done);n=!0){var s=u.value;s.num=1,s.total_money=1*s.costPrice,s.really_total_money=1*s.costPrice,s.modify_retailPrice=s.costPrice}}catch(c){i=!0,a=c}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}r.products=r.products.concat(e)}uni.hideLoading()})},fail:function(t){uni.showToast({title:"未识别到条形码",icon:"none"})}})},confrim_this:function(){uni.navigateTo({url:"/pages/common/good_confrim/good_enter/good_enter"})},handleNumChange:function(t,e){this.products[e].num=Number(t),this.products[e].total_money=Number(t)*Number(this.products[e].modify_retailPrice),this.products[e].really_total_money=Number(t)*Number(this.products[e].really_total_money),uni.setStorageSync("products",this.products)},handleModelNumChange:function(t,e,n,i){r.nums[n]=Number(t);var a=!0,u=!1,l=void 0;try{for(var s,c=(0,o.default)(this.products[e].models);!(a=(s=c.next()).done);a=!0){var d=s.value;d.id==i.id&&(i.num=Number(t))}}catch(b){u=!0,l=b}finally{try{a||null==c.return||c.return()}finally{if(u)throw l}}var f=0,v=!0,m=!1,h=void 0;try{for(var p,g=(0,o.default)(r.nums);!(v=(p=g.next()).done);v=!0){var y=p.value;f+=y}}catch(b){m=!0,h=b}finally{try{v||null==g.return||g.return()}finally{if(m)throw h}}r.selected_model[n]=i,this.products[e].num=f,this.products[e].selected_model=r.selected_model,this.products[e].total_money=f*Number(this.products[e].modify_retailPrice),this.products[e].really_total_money=f*Number(this.products[e].really_total_money),uni.setStorageSync("products",this.products)},handleDel:function(e){t.log(e),1==this.products.length?uni.showToast({title:"最少选择一个产品",icon:"none"}):(this.products.splice(e,1),uni.setStorageSync("products",this.products))},getrealprice:function(t,e){this.products[e].modify_retailPrice=t.target.value,this.products[e].total_money=this.products[e].num*Number(t.target.value),uni.setStorageSync("products",this.products)}}};e.default=v}).call(this,n("5a52")["default"])},"711b":function(t,e,n){"use strict";n.r(e);var i=n("5551"),o=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);e["default"]=o.a},b297:function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,".page[data-v-04c8706f]{font-size:%?28?%;height:calc(100vh - %?88?%);overflow:scroll}.margin-b-10[data-v-04c8706f]{margin-top:%?20?%}.input_withlabel[data-v-04c8706f]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;margin:%?10?% 0}.bottom_del[data-v-04c8706f]{text-align:right}.del[data-v-04c8706f]{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;background:#aa2116;color:#fff;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;padding:%?4?% %?12?%;border-radius:%?8?%}.input_label[data-v-04c8706f]{border:%?1?% solid#ddd;border-radius:%?8?%;padding:0 %?6?%;width:%?140?%;color:#aa2116}",""])},d163:function(t,e,n){var i=n("b297");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=n("4f06").default;o("fd05b3ca",i,!0,{sourceMap:!1,shadowMode:!1})},db4e:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("uni-nav-bar",{attrs:{fixed:!1,color:"#333333","background-color":"#FFFFFF","right-text":"确定",leftIcon:"scan","left-text":"扫码"},on:{"click-right":function(e){e=t.$handleEvent(e),t.confrim_this(e)},"click-left":function(e){e=t.$handleEvent(e),t.scanGoods(e)}}}),n("v-uni-view",{staticClass:"page"},t._l(t.products,function(e,i){return n("v-uni-view",{key:i,staticClass:"margin-b-10"},[n("unicard",{attrs:{title:"品名："+e.goodsName}},[n("v-uni-view",[n("v-uni-view",{staticStyle:{"margin-bottom":"10rpx"}},[t._v("库存："+t._s(e.reserve))]),t.user.rights&&"0"!=t.user.rights.othercurrent[0]?n("v-uni-view"):n("v-uni-view",[t._v("期初进货价："+t._s(e.costPrice)+"(元)")]),t.user.rights&&"0"!=t.user.rights.othercurrent[0]?n("v-uni-view",{staticClass:"input_withlabel"},[n("v-uni-view",[t._v("实际进货价(可修改)：")]),n("v-uni-view",[n("v-uni-input",{staticClass:"input_label",attrs:{placeholder:"0",type:"digit"},on:{input:function(e){e=t.$handleEvent(e),t.getrealprice(e,i)}}})],1)],1):n("v-uni-view",{staticClass:"input_withlabel"},[n("v-uni-view",[t._v("实际进货价(可修改)：")]),n("v-uni-view",[n("v-uni-input",{staticClass:"input_label",attrs:{placeholder:e.costPrice,type:"digit"},on:{input:function(e){e=t.$handleEvent(e),t.getrealprice(e,i)}}})],1)],1),e.selectd_model?n("v-uni-view",t._l(e.selectd_model,function(e,o){return n("v-uni-view",{key:o,staticClass:"margin-t-5",staticStyle:{"margin-bottom":"10rpx"}},[n("v-uni-text",{staticStyle:{color:"#f30"}},[t._v(t._s(e.custom1.value+e.custom2.value+e.custom3.value+e.custom4.value))]),t._v("入库量："),n("uninumberbox",{attrs:{min:0,value:"0"},on:{change:function(n){n=t.$handleEvent(n),t.handleModelNumChange(n,i,o,e)}}})],1)}),1):n("v-uni-view",{staticClass:"margin-t-5"},[t._v("入库量："),n("uninumberbox",{attrs:{min:1},on:{change:function(e){e=t.$handleEvent(e),t.handleNumChange(e,i)}}})],1),n("v-uni-view",{staticClass:"bottom_del"},[n("v-uni-view",{staticClass:"del",on:{click:function(e){e=t.$handleEvent(e),t.handleDel(i)}}},[n("fa-icon",{attrs:{type:"close",size:"15",color:"#fff"}}),t._v("删除")],1)],1)],1)],1)],1)}),1)],1)},o=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o})}}]);