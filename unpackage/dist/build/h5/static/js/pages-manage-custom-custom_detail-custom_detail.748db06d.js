(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-custom-custom_detail-custom_detail"],{"0552":function(t,e,o){e=t.exports=o("2350")(!1),e.push([t.i,'.uni-mask[data-v-aaf92358]{position:fixed;z-index:998;top:0;right:0;bottom:0;left:0;background-color:rgba(0,0,0,.3)}.uni-popup[data-v-aaf92358]{position:fixed;z-index:999;background-color:#fff}.uni-popup-middle[data-v-aaf92358]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.uni-popup-middle.uni-popup-insert[data-v-aaf92358]{min-width:%?380?%;min-height:%?380?%;max-width:100%;max-height:80%;-webkit-transform:translate(-50%,-65%);-ms-transform:translate(-50%,-65%);transform:translate(-50%,-65%);background:none;-webkit-box-shadow:none;box-shadow:none}.uni-popup-middle.uni-popup-fixed[data-v-aaf92358]{border-radius:%?10?%;padding:%?30?%}.uni-close-bottom[data-v-aaf92358],.uni-close-right[data-v-aaf92358]{position:absolute;bottom:%?-180?%;text-align:center;border-radius:50%;color:#f5f5f5;font-size:%?60?%;font-weight:700;opacity:.8;z-index:-1}.uni-close-bottom[data-v-aaf92358]{margin:auto;left:0;right:0}.uni-close-right[data-v-aaf92358]{right:%?-60?%;top:%?-80?%}.uni-close-bottom[data-v-aaf92358]:after{content:"";position:absolute;width:0;border:1px #f5f5f5 solid;top:%?-200?%;bottom:%?56?%;left:50%;-webkit-transform:translate(-50%);-ms-transform:translate(-50%);transform:translate(-50%);opacity:.8}.uni-popup-bottom[data-v-aaf92358],.uni-popup-top[data-v-aaf92358]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.uni-popup-top[data-v-aaf92358]{top:0;left:0;width:100%;height:%?100?%;line-height:%?100?%;text-align:center}.uni-popup-bottom[data-v-aaf92358]{left:0;bottom:0;width:100%;min-height:%?100?%;line-height:%?100?%;text-align:center}',""])},"0a39":function(t,e,o){"use strict";o.r(e);var n=o("3212"),i=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,function(){return n[t]})}(a);e["default"]=i.a},"0e3f":function(t,e,o){"use strict";o.r(e);var n=o("c857"),i=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,function(){return n[t]})}(a);e["default"]=i.a},"1c24":function(t,e,o){e=t.exports=o("2350")(!1),e.push([t.i,"uni-page-body[data-v-0281d6d8]{color:#3d3d3d}.modal_confrimbutton[data-v-0281d6d8]{background:#426ab3;color:#fff;width:60%;padding:%?20?% 0;text-align:center;margin-left:20%;border-radius:%?8?%;margin-top:%?30?%}.list_item[data-v-0281d6d8]{padding:%?20?% %?30?%;background:#fff}.left_desc[data-v-0281d6d8]{color:#999}.border_bottom[data-v-0281d6d8]{border-bottom:%?1?% solid#DDDDDD}.getmoney_button[data-v-0281d6d8]{width:100%;background:#426ab3;color:#fff;padding:%?20?% 0;text-align:center;position:fixed;bottom:0;left:0}",""])},"2fd7":function(t,e,o){var n=o("0552");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=o("4f06").default;i("daa48e36",n,!0,{sourceMap:!1,shadowMode:!1})},3212:function(t,e,o){},"33f5":function(t,e,o){"use strict";var n=o("2fd7"),i=o.n(n);i.a},"4e00":function(t,e,o){"use strict";o.r(e);var n=o("646b"),i=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,function(){return n[t]})}(a);e["default"]=i.a},"524a":function(t,e,o){"use strict";o.r(e);var n=o("c636"),i=o("0a39");for(var a in i)"default"!==a&&function(t){o.d(e,t,function(){return i[t]})}(a);o("f68d");var s=o("2877"),u=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,"11ff4219",null);e["default"]=u.exports},"646b":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={name:"UniPopup",props:{show:{type:Boolean,default:!1},position:{type:String,default:"middle"},mode:{type:String,default:"insert"},msg:{type:String,default:""},h5Top:{type:Boolean,default:!1},buttonMode:{type:String,default:"bottom"}},data:function(){return{offsetTop:0}},watch:{h5Top:function(t){this.offsetTop=t?44:0}},created:function(){var t=0;t=this.h5Top?0:44,this.offsetTop=t},methods:{hide:function(){"insert"===this.mode&&"middle"===this.position||this.$emit("hidePopup")},closeMask:function(){"insert"===this.mode&&this.$emit("hidePopup")},moveHandle:function(){}}};e.default=n},"67fe":function(t,e,o){"use strict";var n=o("dc30"),i=o.n(n);i.a},"6eb0":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",[o("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"uni-mask",style:{top:t.offsetTop+"px"},on:{click:function(e){e=t.$handleEvent(e),t.hide(e)},touchmove:function(e){e.stopPropagation(),e.preventDefault(),e=t.$handleEvent(e),t.moveHandle(e)}}}),o("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"uni-popup",class:"uni-popup-"+t.position+" uni-popup-"+t.mode},[t._v(t._s(t.msg)),t._t("default"),"middle"===t.position&&"insert"===t.mode?o("v-uni-view",{staticClass:" uni-icon uni-icon-close",class:{"uni-close-bottom":"bottom"===t.buttonMode,"uni-close-right":"right"===t.buttonMode},on:{click:function(e){e=t.$handleEvent(e),t.closeMask(e)}}}):t._e()],2)],1)},i=[];o.d(e,"a",function(){return n}),o.d(e,"b",function(){return i})},"7be9":function(t,e,o){"use strict";o.r(e);var n=o("bdc9"),i=o("0e3f");for(var a in i)"default"!==a&&function(t){o.d(e,t,function(){return i[t]})}(a);o("67fe");var s=o("2877"),u=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,"0281d6d8",null);e["default"]=u.exports},9257:function(t,e,o){e=t.exports=o("2350")(!1),e.push([t.i,".Loading_view[data-v-11ff4219]{height:100vh;width:100%;text-align:center;background:#fff}.loading_image[data-v-11ff4219]{width:%?200?%;height:%?200?%;margin-top:50%}",""])},b871:function(t,e,o){var n=o("9257");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=o("4f06").default;i("0d0cf901",n,!0,{sourceMap:!1,shadowMode:!1})},bdc9:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",[t.loading?o("loading"):o("v-uni-view",[o("v-uni-view",{staticClass:"display_flex_bet list_item border_bottom"},[o("v-uni-view",{staticClass:"left_desc"},[t._v("客户昵称")]),o("v-uni-view",[t._v(t._s(t.custom.custom_name))])],1),o("v-uni-view",{staticClass:"display_flex_bet list_item border_bottom"},[o("v-uni-view",{staticClass:"left_desc"},[t._v("联系电话")]),t.custom.custom_phone?o("v-uni-view",[t._v(t._s(t.custom.custom_phone))]):o("v-uni-view",[t._v("未填写")])],1),o("v-uni-navigator",{staticClass:"display_flex_bet list_item border_bottom",attrs:{"hover-class":"none",url:"debt_history/debt_history?id="+t.custom.objectId+"&name="+t.custom.custom_name}},[o("v-uni-view",{staticClass:"left_desc"},[t._v("客户欠款")]),o("v-uni-view",{staticClass:"display_flex"},[o("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[t._v("￥"+t._s(t.custom.debt?t.custom.debt:0))]),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),o("v-uni-view",{staticClass:"display_flex_bet list_item border_bottom"},[o("v-uni-view",{staticClass:"left_desc"},[t._v("建立时间")]),o("v-uni-view",[t._v(t._s(t.custom.createdAt))])],1),o("v-uni-navigator",{staticClass:"list_item display_flex_bet",staticStyle:{margin:"20rpx 0"},attrs:{"hover-class":"none",url:"history/history?id="+t.custom.objectId}},[o("v-uni-text",{staticClass:"left_desc"},[t._v("交易历史")]),o("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1),o("uni-popup",{attrs:{show:t.modal_show,position:"middle",mode:"fixed"},on:{hidePopup:function(e){e=t.$handleEvent(e),t.modal_show=!1}}},[o("v-uni-view",{staticStyle:{width:"500rpx"}},[o("v-uni-view",{staticClass:"display_flex"},[o("v-uni-view",{staticStyle:{width:"160rpx",color:"#999"}},[t._v("本次收款：")]),o("v-uni-input",{staticClass:"uni-input",attrs:{placeholder:"请输入本次收款金额",type:"digit"},model:{value:t.modal_sk.sk_number,callback:function(e){t.$set(t.modal_sk,"sk_number",e)},expression:"modal_sk.sk_number"}})],1),o("v-uni-view",{staticClass:"display_flex"},[o("v-uni-view",{staticStyle:{width:"160rpx",color:"#999"}},[t._v("备注：")]),o("v-uni-input",{staticClass:"uni-input",attrs:{placeholder:"请输入备注信息"},model:{value:t.modal_sk.beizhu,callback:function(e){t.$set(t.modal_sk,"beizhu",e)},expression:"modal_sk.beizhu"}})],1),o("v-uni-view",{staticClass:"modal_confrimbutton",on:{click:function(e){e=t.$handleEvent(e),t.confrim_sk(e)}}},[t._v("确定")])],1)],1),o("v-uni-view",{staticClass:"getmoney_button",on:{click:function(e){e=t.$handleEvent(e),t.modal_show=!0}}},[t._v("收款")])],1)],1)},i=[];o.d(e,"a",function(){return n}),o.d(e,"b",function(){return i})},c315:function(t,e,o){"use strict";var n=o("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,o("c5f6");var i=n(o("5d73"));o("7514");var a=n(o("795b")),s={get_customList:function(t,e){return new a.default(function(o,n){var i=uni.getStorageSync("uid"),a=Bmob.Query("customs");a.order("num"),a.equalTo("parent","==",i),a.equalTo("disabled","==",t),e&&a.equalTo("name","==",{$regex:e+".*"}),a.find().then(function(t){o(t)})})},get_customCount:function(){return new a.default(function(t,e){var o=uni.getStorageSync("uid"),n=Bmob.Query("customs");n.equalTo("parent","==",o),n.find().then(function(e){var o=e,n=!0,a=!1,s=void 0;try{for(var u,r=function(){var t=u.value,e=Bmob.Query("Bills");e.equalTo("type","==",-1),e.equalTo("custom","==",t.objectId),e.find().then(function(e){t.relations=e})},c=(0,i.default)(o);!(n=(u=c.next()).done);n=!0)r()}catch(l){a=!0,s=l}finally{try{n||null==c.return||c.return()}finally{if(a)throw s}}t(o)})})},add_custom:function(t){console.log(t);var e=JSON.parse(localStorage.getItem("bmob")).objectId;return new a.default(function(o,n){var i=Bmob.Pointer("_User"),a=i.set(e);if(t.objectId){var s=Bmob.Query("customs");s.set("custom_name",t.custom_name),s.set("debt",Number(t.debt)),s.set("custom_address",t.custom_address),s.set("custom_phone",t.custom_phone),s.set("parent",a),s.set("disabled",!t.disabled),s.set("id",t.objectId),s.save().then(function(t){o(t)}).catch(function(t){console.log(t)})}else{var u=Bmob.Query("customs");u.equalTo("parent","==",e),u.equalTo("name","==",t.custom_name),u.find().then(function(e){if(console.log(e),0==e.length){var n=Bmob.Query("customs");n.set("custom_name",t.custom_name),n.set("debt",Number(t.debt)),n.set("custom_address",t.custom_address),n.set("custom_phone",t.custom_phone),n.set("have_out",0),n.set("disabled",!t.disabled),n.set("parent",a),n.save().then(function(t){o(t)}).catch(function(t){console.log(t)})}else o(!1)})}})},delete_custom:function(t){return new a.default(function(e,o){var n=Bmob.Query("customs");n.destroy(t).then(function(t){e(t)}).catch(function(t){console.log(t)})})},custom_detail:function(t){return new a.default(function(e,o){var n=Bmob.Query("customs");n.get(t).then(function(t){e(t)}).catch(function(t){console.log(t)})})},get_moneyList:function(t){return new a.default(function(e,o){var n=Bmob.Query("debt_history");n.equalTo("custom","==",t),n.include("operater"),n.find().then(function(t){console.log(t),e(t)})})}};e.default=s},c636:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",{staticClass:"Loading_view"},[o("v-uni-image",{staticClass:"loading_image",attrs:{src:"/static/timg.gif"}}),o("v-uni-view",{staticStyle:{color:"#999","margin-top":"3%"}},[t._v("加载中...")])],1)},i=[];o.d(e,"a",function(){return n}),o.d(e,"b",function(){return i})},c857:function(t,e,o){"use strict";var n=o("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,o("c5f6");var i,a=n(o("c315")),s=n(o("df06")),u=n(o("0914")),r=n(o("db37")),c=n(o("524a")),l={components:{faIcon:u.default,loading:c.default,uniPopup:r.default},data:function(){return{loading:!0,modal_show:!1,custom:{},modal_sk:{sk_number:"",beizhu:""}}},onLoad:function(t){i=this,a.default.custom_detail(t.id).then(function(t){console.log(t),i.custom=t,i.loading=!1})},methods:{confrim_sk:function(){console.log(i.modal_sk);var t=i.modal_sk.sk_number,e=i.modal_sk.beizhu,o=i.custom.objectId;if(null==t||0==t.length)uni.showToast({title:"请输入收款金额",icon:"none"});else{uni.showLoading({title:"加载中..."}),i.modal_show=!1;var n=Bmob.Query("customs");n.get(o).then(function(n){if(n.debt-Number(t)<0)uni.hideLoading(),uni.showToast({icon:"none",title:"收款金额过大"});else if(null==n.debt||0==n.debt)uni.hideLoading(),uni.showToast({icon:"none",title:"该客户没有欠款"});else{n.set("debt",n.debt-Number(t)),n.save();var u=Bmob.Pointer("customs"),r=u.set(o),c=Bmob.Pointer("_User"),l=c.set(uni.getStorageSync("uid")),d=Bmob.Pointer("_User"),f=d.set(uni.getStorageSync("masterId")),m=Bmob.Query("debt_history");m.set("custom",r),m.set("master",l),m.set("operater",f),m.set("debt_number",Number(t)),m.set("beizhu",e),m.save().then(function(e){console.log(e),s.default.log(uni.getStorageSync("user").nickName+"操作'"+i.custom.custom_name+"'客户还款￥"+t+"元",6,e.objectId),uni.hideLoading(),a.default.custom_detail(i.custom.objectId).then(function(t){console.log(t),i.custom=t,uni.showToast({title:"收款成功"})})}).catch(function(t){console.log(t)})}}).catch(function(t){console.log(t)})}}}};e.default=l},db37:function(t,e,o){"use strict";o.r(e);var n=o("6eb0"),i=o("4e00");for(var a in i)"default"!==a&&function(t){o.d(e,t,function(){return i[t]})}(a);o("33f5");var s=o("2877"),u=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,"aaf92358",null);e["default"]=u.exports},dc30:function(t,e,o){var n=o("1c24");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=o("4f06").default;i("3e9f8dd7",n,!0,{sourceMap:!1,shadowMode:!1})},df06:function(t,e,o){"use strict";var n=o("288e");o("6b54"),o("87b3"),o("c5f6");var i=n(o("5d73"));o("7514"),t.exports={handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("now_product"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(t,e,o){var n=Bmob.Pointer("_User"),i=n.set(uni.getStorageSync("uid")),a=Bmob.Query("logs");a.set("parent",i),a.set("log",t),a.set("detail_id",o),a.set("type",e),a.save().then(function(t){console.log(t)}).catch(function(t){console.log(t)})},record_shopOut:function(t,e){console.log(t,e);var o=Bmob.Query("shops");o.set("id",t),o.set("have_out",e),o.save().then(function(t){console.log(t)}).catch(function(t){console.log(t)})},record_staffOut:function(t){if(console.log(t,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var e=Bmob.Query("staffs");e.set("id",uni.getStorageSync("user").objectId),e.set("have_out",t+uni.getStorageSync("user").have_out),e.save().then(function(t){console.log(t)}).catch(function(t){console.log(t)})}},get_allCost:function(){var t=uni.getStorageSync("uid");console.log(t);var e=Bmob.Query("Goods");e.equalTo("userId","==",t),e.find().then(function(t){console.log(t);var e=!0,o=!1,n=void 0;try{for(var a,s=(0,i.default)(t);!(e=(a=s.next()).done);e=!0){var u=a.value;console.log(u),Number(u.costPrice)*u.reserve,u.reserve}}catch(r){o=!0,n=r}finally{try{e||null==s.return||s.return()}finally{if(o)throw n}}})},getDay:function(t,e){var o=this,n=new Date,i=n.getTime()+864e5*t;n.setTime(i);var a=n.getFullYear(),s=n.getMonth(),u=n.getDate();return s=o.handleMonth(s+1),u=o.handleMonth(u),e?a+"-"+s+"-"+u+" 00:00:00":a+"-"+s+"-"+u},handleMonth:function(t){var e=t;return 1==t.toString().length&&(e="0"+t),e}}},f68d:function(t,e,o){"use strict";var n=o("b871"),i=o.n(n);i.a}}]);