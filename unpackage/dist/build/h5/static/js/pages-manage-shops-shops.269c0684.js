(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-shops-shops"],{"26bb":function(e,t,n){"use strict";n("a9e3"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={name:"UniSegmentedControl",props:{current:{type:Number,default:0},values:{type:Array,default:function(){return[]}},activeColor:{type:String,default:"#007aff"},styleType:{type:String,default:"button"}},data:function(){return{currentIndex:0}},watch:{current:function(e){e!==this.currentIndex&&(this.currentIndex=e)}},created:function(){this.currentIndex=this.current},methods:{_onClick:function(e){this.currentIndex!==e&&(this.currentIndex=e,this.$emit("clickItem",e))}}};t.default=o},"54f8":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));n("a4d3"),n("e01a"),n("d28b"),n("e260"),n("d3b7"),n("3ca3"),n("ddb0");var o=n("dde1");function i(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(o["a"])(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a,r=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return r=e.done,e},e:function(e){s=!0,a=e},f:function(){try{r||null==i["return"]||i["return"]()}finally{if(s)throw a}}}}},"5f7b":function(e,t,n){"use strict";var o={"uni-nav-bar":n("96bd").default,"uni-icon":n("3628").default,"uni-segmented-control":n("c952").default},i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[e.loading?n("loading"):e._e(),n("v-uni-view",{attrs:{"wx:else":!0}},[n("uni-nav-bar",{attrs:{fixed:!1,color:"#333333","background-color":"#FFFFFF","right-text":"添加"},on:{"click-right":function(t){arguments[0]=t=e.$handleEvent(t),e.goto_add.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"input-view"},[n("uni-icon",{attrs:{type:"search",size:"22",color:"#666666"}}),n("v-uni-input",{staticClass:"input",attrs:{"confirm-type":"search",type:"text",placeholder:"输入搜索关键词"},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.input_confirm.apply(void 0,arguments)}}})],1)],1),n("v-uni-view",{staticClass:"uni-common-mt"},[n("uni-segmented-control",{attrs:{current:e.current,values:e.items,"style-type":"text","active-color":"#426ab3"},on:{clickItem:function(t){arguments[0]=t=e.$handleEvent(t),e.onClickItem.apply(void 0,arguments)}}})],1),e.shops&&e.shops.length>0?n("v-uni-scroll-view",{staticClass:"indexes",staticStyle:{height:"calc(100vh - 212rpx)"},attrs:{"scroll-y":!0,"scroll-with-animation":"true","enable-back-to-top":"true"}},e._l(e.shops,(function(t,o){return n("v-uni-view",{key:o},[n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"display_flex_bet",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.goto_detail(t)}}},[n("v-uni-view",{staticClass:"display_flex"},[t.Image&&t.Image.length>0?n("v-uni-image",{staticClass:"shop_avatar",attrs:{src:t.Image[0],mode:"aspectFit"},on:{click:function(n){n.stopPropagation(),arguments[0]=n=e.$handleEvent(n),e.priviewImg(t.Image[0])}}}):n("v-uni-image",{staticClass:"shop_avatar",attrs:{src:"/static/shop.png"}}),n("v-uni-view",[n("v-uni-view",{staticClass:"shop_name"},[e._v(e._s(t.name))]),n("v-uni-view",{staticClass:"shop_mobile"},[e._v("地址："),t.address?n("v-uni-text",[e._v(e._s(t.address))]):n("v-uni-text",[e._v("未填写")])],1)],1)],1),n("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1),n("v-uni-view",{staticClass:"right_item"},[e.is_choose?n("v-uni-view",{staticClass:"display_flex",staticStyle:{"justify-content":"flex-end",width:"100%"},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.select_this(t)}}},[n("v-uni-text",{staticStyle:{color:"#d93a49"}},[e._v("选择")])],1):e._e()],1)],1)],1)})),1):n("nocontent",{attrs:{type:1}})],1)],1)},a=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}))},6916:function(e,t,n){"use strict";var o=n("e3ec"),i=n.n(o);i.a},"7c0b":function(e,t,n){"use strict";n.r(t);var o=n("26bb"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},"8d57":function(e,t,n){"use strict";(function(e){var o=n("ee27");n("7db0"),n("d3b7"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("9546")),a={get_satffAuth:function(){return new Promise((function(e,t){var n=uni.getStorageSync("user").objectId,o=i.default.Query("_User");o.include("masterId"),o.get(n).then((function(t){t.masterId.is_vip?(t.is_vip=!0,t.vip_time=t.masterId.vip_time):(t.is_vip=!1,t.vip_time=0),uni.setStorageSync("user",t),e(t)})).catch((function(t){e()}))}))},get_stafflist:function(e,t){return new Promise((function(n,o){var a=JSON.parse(localStorage.getItem("bmob")).objectId,r=i.default.Query("_User");r.order("num"),r.equalTo("masterId","==",a),r.equalTo("disabled","==",e),r.include("shop"),t&&r.equalTo("name","==",{$regex:t+".*"}),r.find().then((function(e){localStorage.setItem("_User",JSON.stringify(e)),n(e)}))}))},add_staff:function(t){var n=JSON.parse(localStorage.getItem("bmob")).objectId;return new Promise((function(o,a){var r=i.default.Pointer("_User"),s=r.set(n),c=i.default.Pointer("shops"),u=c.set(t.shop);if(t.objectId){var d=i.default.Pointer("_User"),l=d.set(n),f=i.default.Query("_User");f.set("username",t.name),f.set("nickName",t.name),f.set("password",t.password),f.set("mobilePhoneNumber",t.mobilePhoneNumber),f.set("rights",t.rights),f.set("address",t.address),f.set("avatarUrl","http://bmob-cdn-23134.b0.upaiyun.com/2019/04/29/4705b31340bfff8080c068f52fd17e2c.png"),f.set("masterId",l),f.set("disabled",!t.disabled),f.set("shop",u),f.set("id",t.objectId),f.save().then((function(t){e.log(t),o(t)})).catch((function(t){e.log(t)}))}else{var v=i.default.Query("_User");v.equalTo("masterId","==",n),v.equalTo("mobilePhoneNumber","==",t.mobilePhoneNumber),v.find().then((function(n){if(e.log(n),0==n.length){var a=i.default.Query("_User");a.set("username",t.name),a.set("shop",u),a.set("nickName",t.name),a.set("password",t.password),a.set("mobilePhoneNumber",t.mobilePhoneNumber),a.set("rights",t.rights),a.set("address",t.address),a.set("avatarUrl","http://bmob-cdn-23134.b0.upaiyun.com/2019/04/29/4705b31340bfff8080c068f52fd17e2c.png"),a.set("masterId",s),a.set("have_out",0),a.set("disabled",!t.disabled),a.save().then((function(t){e.log(t),o(t)})).catch((function(t){e.log(t)}))}else o(!1,"已存在此账号")}))}}))},delete_staff:function(t){return new Promise((function(n,o){var a=i.default.Query("_User");a.destroy(t).then((function(e){n(e)})).catch((function(t){e.log(t)}))}))}};t.default=a}).call(this,n("5a52")["default"])},97960:function(e,t,n){"use strict";n.r(t);var o=n("a498"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},a498:function(e,t,n){"use strict";(function(e){var o=n("ee27");n("7db0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,a,r,s=o(n("54f8")),c=o(n("8d57")),u=o(n("9546")),d=o(n("c952")),l=o(n("120a")),f=o(n("4d52")),v=o(n("96bd")),b=o(n("3628")),h={components:{uniSegmentedControl:d.default,faIcon:f.default,loading:l.default,uniNavBar:v.default,uniIcon:b.default},data:function(){return{loading:!0,shops:null,is_choose:!1,items:["已启用","未启用"],current:0,disabled:!1}},onLoad:function(e){i=this,r=uni.getStorageSync("uid"),"choose"==e.type&&(i.is_choose=!0)},onShow:function(){uni.removeStorageSync("shop"),i.getshop_list()},onUnload:function(){a=""},methods:{priviewImg:function(e){uni.previewImage({current:e,urls:[e]})},goto_detail:function(e){uni.setStorageSync("shop",e),uni.navigateTo({url:"detail/detail"})},onClickItem:function(e){this.current!==e&&(this.current=e,0==e?(i.disabled=!1,i.getshop_list()):1==e&&(i.disabled=!0,i.getshop_list()))},select_this:function(e){uni.setStorageSync("shop",e),uni.navigateBack({delta:1})},goto_add:function(){var t=uni.getStorageSync("user"),n=uni.getStorageSync("identity");t.is_vip||i.shops.length<2?uni.navigateTo({url:"add/add"}):uni.showModal({title:"提示",content:"非会员最多上传2个门店",confirmText:"充值会员",success:function(t){t.confirm?1==n?uni.navigateTo({url:"/pages/mine/vip/vip"}):uni.showToast({title:"员工不能充值",icon:"none"}):t.cancel&&e.log("用户点击取消")}})},input_confirm:function(e){a=e.detail.value,i.getshop_list()},getshop_list:function(){var t=u.default.Query("shops");t.order("num"),t.equalTo("parent","==",r),t.equalTo("disabled","==",i.disabled),a&&t.equalTo("name","==",{$regex:a+".*"}),t.find().then((function(t){e.log(t,r),i.loading=!1;var n=t;uni.getStorage({key:"identity",success:function(t){"2"==t.data?c.default.get_satffAuth().then((function(t){e.log(t);var o=[];if(t.shop){var a,r=(0,s.default)(n);try{for(r.s();!(a=r.n()).done;){var c=a.value;c.objectId==t.shop.objectId&&o.push(c)}}catch(u){r.e(u)}finally{r.f()}}i.shops=o})):"1"==t.data&&(i.shops=n)}})}))}}};t.default=h}).call(this,n("5a52")["default"])},b85a:function(e,t,n){"use strict";n.r(t);var o=n("5f7b"),i=n("97960");for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("ee058");var r,s=n("f0c5"),c=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,"18e14596",null,!1,o["a"],r);t["default"]=c.exports},c952:function(e,t,n){"use strict";n.r(t);var o=n("ca58"),i=n("7c0b");for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("6916");var r,s=n("f0c5"),c=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,"917140dc",null,!1,o["a"],r);t["default"]=c.exports},ca58:function(e,t,n){"use strict";var o,i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"segmented-control",class:{text:"text"===e.styleType},style:{borderColor:"text"===e.styleType?"":e.activeColor}},e._l(e.values,(function(t,o){return n("v-uni-view",{key:o,staticClass:"segmented-control-item",class:[{text:"text"===e.styleType},{active:o===e.currentIndex}],style:{color:o===e.currentIndex?"text"===e.styleType?e.activeColor:"#fff":"text"===e.styleType?"#000":e.activeColor,backgroundColor:o===e.currentIndex&&"button"===e.styleType?e.activeColor:""},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._onClick(o)}}},[e._v(e._s(t))])})),1)},a=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}))},e0c8:function(e,t,n){var o=n("ee38");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=n("4f06").default;i("8400f54c",o,!0,{sourceMap:!1,shadowMode:!1})},e3ec:function(e,t,n){var o=n("fa11");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=n("4f06").default;i("573bb508",o,!0,{sourceMap:!1,shadowMode:!1})},ee058:function(e,t,n){"use strict";var o=n("e0c8"),i=n.n(o);i.a},ee38:function(e,t,n){var o=n("24fb");t=o(!1),t.push([e.i,"uni-page-body[data-v-18e14596]{height:100vh;background:#fafafa}.uni-common-mt[data-v-18e14596]{background:#fff;padding:%?20?% 0}.shop_name[data-v-18e14596]{font-weight:700;font-size:%?30?%;color:#3d3d3d;margin-bottom:%?4?%}.shop_mobile[data-v-18e14596]{color:#999}.right_item[data-v-18e14596]{padding-bottom:%?10?%;width:100%;border-bottom:%?1?% solid#ccc}.shop_avatar[data-v-18e14596]{width:%?90?%;height:%?70?%;margin-right:%?20?%}.content[data-v-18e14596]{padding:%?10?% %?30?%;background:#fff}body.?%PAGE?%[data-v-18e14596]{background:#fafafa}",""]),e.exports=t},fa11:function(e,t,n){var o=n("24fb");t=o(!1),t.push([e.i,".segmented-control[data-v-917140dc]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:75%;font-size:%?28?%;-webkit-box-sizing:border-box;box-sizing:border-box;margin:0 auto;overflow:hidden;border:1px solid;border-radius:%?10?%}.segmented-control.text[data-v-917140dc]{border:0;border-radius:0}.segmented-control-item[data-v-917140dc]{-webkit-box-flex:1;-webkit-flex:1;flex:1;text-align:center;line-height:%?60?%;-webkit-box-sizing:border-box;box-sizing:border-box;border-left:1px solid}.segmented-control-item.active[data-v-917140dc]{color:#fff}.segmented-control-item.text[data-v-917140dc]{border-left:0;color:#000}.segmented-control-item.text.active[data-v-917140dc]{border-bottom-style:solid}.segmented-control-item[data-v-917140dc]:first-child{border-left-width:0}",""]),e.exports=t}}]);