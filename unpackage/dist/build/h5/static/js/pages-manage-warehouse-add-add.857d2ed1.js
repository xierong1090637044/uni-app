(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-warehouse-add-add"],{"0371":function(e,t,a){var n=a("f785");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=a("4f06").default;i("2cc63ede",n,!0,{sourceMap:!1,shadowMode:!1})},"0e04":function(e,t,a){"use strict";var n=a("0371"),i=a.n(n);i.a},"54f8":function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return i}));a("a4d3"),a("e01a"),a("d28b"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");var n=a("dde1");function i(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(n["a"])(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r,s=!0,o=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return s=e.done,e},e:function(e){o=!0,r=e},f:function(){try{s||null==i["return"]||i["return"]()}finally{if(o)throw r}}}}},"5cc0":function(e,t,a){"use strict";a.r(t);var n=a("850c"),i=a.n(n);for(var r in n)"default"!==r&&function(e){a.d(t,e,(function(){return n[e]}))}(r);t["default"]=i.a},"850c":function(e,t,a){"use strict";(function(e){var n=a("ee27");a("7db0"),a("a434"),a("a9e3"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r,s,o,u,c,l=n(a("9546")),d=n(a("9ef1")),h=n(a("4d52")),f=n(a("96bd")),v={components:{faIcon:h.default,uniNavBar:f.default},data:function(){return{textDesc:"添加",user:uni.getStorageSync("user"),Images:[],warehouse_name:"",warehouse_shop:"",warehouse_num:0,warehouse_charge:"",warehouse_beizhu:"",phoneNumber:"",address:"",disabled:!0}},onLoad:function(e){i=this,c=uni.getStorageSync("uid")},onShow:function(){if(r=uni.getStorageSync("warehouse"),o=uni.getStorageSync("shop"),r?(s=r.Ncharge,i.Images=r.Image||[],i.warehouse_name=r.stock_name,i.warehouse_shop=r.shop||"",i.warehouse_num=r.num,i.warehouse_charge=r.Ncharge?r.Ncharge.nickName:"",i.warehouse_beizhu=r.beizhu||"",i.disabled=!r.disabled,i.phoneNumber=r.phoneNumber||"",i.address=r.address||"",i.textDesc="修改",uni.setNavigationBarTitle({title:"修改店仓信息"})):uni.setNavigationBarTitle({title:"新增店仓"}),o){i.warehouse_shop=o.name;var e=l.default.Pointer("shops");u=e.set(o.objectId)}uni.getStorageSync("charge")&&(s=uni.getStorageSync("charge"),i.warehouse_charge=s.username)},onUnload:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("shop"),uni.removeStorageSync("charge")},methods:{removeImg:function(e){i.Images.splice(e,1),i.Images=i.Images},upload_image:function(){d.default.upload_image(1).then((function(t){e.log(t),i.Images=t}))},switchChange:function(e){i.disabled=e.detail.value},start_add:function(){""==this.warehouse_name?uni.showToast({title:"请输入店仓名字",icon:"none"}):i.add_data()},add_data:function(){uni.showLoading({title:"上传中..."});var t=l.default.Pointer("_User"),a=t.set(c);if(r){var n=l.default.Query("stocks");if(n.set("Image",i.Images),n.set("stock_name",i.warehouse_name),n.set("num",Number(i.warehouse_num?i.warehouse_num:0)),o&&n.set("shop",u),s&&s.objectId){var d=l.default.Pointer("_User"),h=d.set(s.objectId);n.set("Ncharge",h)}n.set("beizhu",i.warehouse_beizhu||""),n.set("disabled",!i.disabled),n.set("phoneNumber",i.phoneNumber),n.set("address",i.address),n.set("parent",a),n.set("id",r.objectId),n.save().then((function(t){uni.hideLoading(),e.log(t),uni.showToast({icon:"none",title:"修改成功"}),setTimeout((function(){uni.navigateBack({delta:1})}),1e3)})).catch((function(t){e.log(t)}))}else{var f=l.default.Query("stocks");f.equalTo("parent","==",c),f.equalTo("stock_name","==",i.warehouse_name),f.find().then((function(t){if(e.log(t),0==t.length){var n=l.default.Query("stocks");if(n.set("Image",i.Images),n.set("stock_name",i.warehouse_name),n.set("num",Number(i.warehouse_num)),o&&n.set("shop",u),s&&s.objectId){var r=l.default.Pointer("_User"),c=r.set(s.objectId);n.set("Ncharge",c)}n.set("beizhu",i.warehouse_beizhu),n.set("disabled",!i.disabled),n.set("phoneNumber",i.phoneNumber),n.set("address",i.address),n.set("parent",a),n.save().then((function(t){e.log(t),uni.hideLoading(),uni.showToast({title:"添加成功"}),i.warehouse_name="",i.warehouse_shop="",i.warehouse_num=0,i.warehouse_charge="",i.warehouse_beizhu="",i.phoneNumber="",i.address="",i.disabled=!0})).catch((function(t){e.log(t)}))}else uni.showToast({title:"已存在此店仓",icon:"none"})}))}}}};t.default=v}).call(this,a("5a52")["default"])},"9ef1":function(e,t,a){"use strict";(function(t){var n=a("ee27");a("d3b7");var i=n(a("54f8")),r=n(a("9546"));e.exports={upload_image:function(e){return new Promise((function(a,n){var s=uni.getStorageSync("user"),o=[];s.is_vip?uni.chooseImage({count:e,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){t.log(e);var n,s,u=Date.parse(new Date),c=e.tempFilePaths,l=(0,i.default)(c);try{for(l.s();!(s=l.n()).done;){var d=s.value;n=r.default.File(u+".jpg",d)}}catch(h){l.e(h)}finally{l.f()}n.save().then((function(e){var t,n=(0,i.default)(e);try{for(n.s();!(t=n.n()).done;){t.value;o.push(e[0].url)}}catch(h){n.e(h)}finally{n.f()}a(o)}))}}):uni.showToast({title:"您还不是会员，无法使用",icon:"none"})}))}}}).call(this,a("5a52")["default"])},a8db:function(e,t,a){"use strict";var n={"uni-nav-bar":a("96bd").default},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("uni-nav-bar",{attrs:{fixed:!1,color:"#333333","background-color":"#FFFFFF","right-text":e.textDesc},on:{"click-right":function(t){arguments[0]=t=e.$handleEvent(t),e.start_add.apply(void 0,arguments)}}},[a("v-uni-view")],1),a("v-uni-view",[a("v-uni-view",{staticClass:"normalBorder",staticStyle:{background:"#fff",padding:"0 30rpx"}},[a("v-uni-view",{staticClass:"notice_text"},[e._v("上传店仓图(会员可用)")]),a("v-uni-view",{staticStyle:{width:"100%",padding:"20rpx 0"}},[a("v-uni-view",{staticClass:"upload_image display_flex"},[e._l(e.Images,(function(t,n){return e.Images.length>0?a("v-uni-view",{key:n,staticStyle:{position:"relative"}},[a("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx"},attrs:{src:t}}),a("fa-icon",{staticStyle:{position:"absolute",top:"-10rpx",right:"-10rpx"},attrs:{type:"times-circle-o",size:"20",color:"#426ab3"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.removeImg(n)}}})],1):e._e()})),0==e.Images.length?a("v-uni-view",{staticStyle:{width:"180rpx",height:"180rpx","line-height":"220rpx","text-align":"center",border:"1rpx solid#ccc","border-radius":"16rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.upload_image.apply(void 0,arguments)}}},[a("fa-icon",{attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1):e._e()],2)],1)],1),a("v-uni-view",{staticClass:"display_flex_bet item normalBorder"},[a("v-uni-view",{staticClass:"rightItem"},[a("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v("名称")]),a("v-uni-text",{staticStyle:{color:"#d93a49","margin-right":"20rpx"}},[e._v("*")])],1),a("v-uni-input",{staticClass:"leftItem",attrs:{placeholder:"请输入名称"},model:{value:e.warehouse_name,callback:function(t){e.warehouse_name=t},expression:"warehouse_name"}})],1),a("v-uni-view",{staticClass:"display_flex_bet item normalBorder"},[a("v-uni-view",{staticClass:"rightItem"},[a("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v("排序")]),a("v-uni-text",{staticStyle:{color:"#d93a49","margin-right":"20rpx"}},[e._v("*")])],1),a("v-uni-input",{staticClass:"leftItem",attrs:{placeholder:"请输入排序(数值越大,排列越靠前)",type:"number",maxlength:"11"},model:{value:e.warehouse_num,callback:function(t){e.warehouse_num=t},expression:"warehouse_num"}})],1),a("v-uni-navigator",{staticClass:"display_flex_bet item normalBorder",attrs:{"hover-class":"none",url:"../../staff/staff?type=choose"}},[a("v-uni-view",{staticClass:"rightItem"},[a("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v("负责人")])],1),a("v-uni-view",{staticClass:"display_flex"},[a("v-uni-input",{staticClass:"leftItem",attrs:{placeholder:"请选择负责人",disabled:"true"},model:{value:e.warehouse_charge,callback:function(t){e.warehouse_charge=t},expression:"warehouse_charge"}}),a("fa-icon",{staticStyle:{"margin-left":"10rpx"},attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),a("v-uni-view",{staticClass:"display_flex_bet item normalBorder"},[a("v-uni-view",{staticClass:"rightItem"},[a("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v("联系电话")])],1),a("v-uni-input",{staticClass:"leftItem",attrs:{placeholder:"请输入联系电话",type:"number",maxlength:"11"},model:{value:e.phoneNumber,callback:function(t){e.phoneNumber=t},expression:"phoneNumber"}})],1),a("v-uni-view",{staticClass:"display_flex_bet item"},[a("v-uni-view",{staticClass:"rightItem"},[a("v-uni-text",{staticStyle:{"margin-right":"6rpx"}},[e._v("地址")])],1),a("v-uni-input",{staticClass:"leftItem",attrs:{placeholder:"请输入地址"},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}})],1),a("v-uni-view",{staticClass:"display_flex_bet item normalBorder",staticStyle:{"margin-top":"30rpx"}},[a("v-uni-view",{staticClass:"rightItem"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("备注")])],1),a("v-uni-input",{staticClass:"leftItem",attrs:{placeholder:"请输入备注"},model:{value:e.warehouse_beizhu,callback:function(t){e.warehouse_beizhu=t},expression:"warehouse_beizhu"}})],1),a("v-uni-view",{staticClass:"display_flex_bet item"},[a("v-uni-text",{staticStyle:{"margin-right":"20rpx"}},[e._v("启用")]),a("v-uni-switch",{attrs:{checked:e.disabled},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.switchChange.apply(void 0,arguments)}}})],1)],1)],1)},r=[];a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return n}))},f785:function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,"uni-page-body[data-v-1bc26ad3]{background:#fafafa}.notice_text[data-v-1bc26ad3]{padding:%?20?% 0 0}.item[data-v-1bc26ad3]{padding:%?20?% %?30?%;background:#fff}.rights_item[data-v-1bc26ad3]{margin-bottom:%?20?%}.rightItem[data-v-1bc26ad3]{width:%?200?%}.leftItem[data-v-1bc26ad3]{text-align:right}body.?%PAGE?%[data-v-1bc26ad3]{background:#fafafa}",""]),e.exports=t},f80b:function(e,t,a){"use strict";a.r(t);var n=a("a8db"),i=a("5cc0");for(var r in i)"default"!==r&&function(e){a.d(t,e,(function(){return i[e]}))}(r);a("0e04");var s,o=a("f0c5"),u=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,"1bc26ad3",null,!1,n["a"],s);t["default"]=u.exports}}]);