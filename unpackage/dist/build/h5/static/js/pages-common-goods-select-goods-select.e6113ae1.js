(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-common-goods-select-goods-select"],{"3ae4":function(t,e,i){var n=i("b19c");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var o=i("4f06").default;o("e2727d2e",n,!0,{sourceMap:!1,shadowMode:!1})},"3fed":function(t,e,i){"use strict";i.r(e);var n=i("e7b6"),o=i("82b9");for(var a in o)"default"!==a&&function(t){i.d(e,t,function(){return o[t]})}(a);i("8fc7");var c=i("2877"),s=Object(c["a"])(o["default"],n["a"],n["b"],!1,null,"5d754a22",null);e["default"]=s.exports},"82b9":function(t,e,i){"use strict";i.r(e);var n=i("9e56"),o=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,function(){return n[t]})}(a);e["default"]=o.a},"8fc7":function(t,e,i){"use strict";var n=i("3ae4"),o=i.n(n);o.a},"9e56":function(t,e,i){"use strict";var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("7514");var o,a,c=n(i("5d73")),s=n(i("00eb")),r=n(i("b841")),l=n(i("e081")),u=n(i("c8e0")),d=n(i("11b1")),v=[],p=[],g=[],f="",h=30,_=1,w={components:{loading:r.default,uniNavBar:l.default,faIcon:s.default,uniIcon:u.default,uniPagination:d.default},data:function(){return{page_num:1,search_text:"",url:null,showOptions:!1,loading:!0,productList:null,checked_option:"createdAt",category:"",stock:"",type:""}},onLoad:function(t){a=this,this.handle_data(),"entering"==t.type?this.url="../good_confrim/good_confrim":"delivery"==t.type?this.url="../goods_out/goods_out":"returing"==t.type?this.url="../good_return/good_return":"counting"==t.type?this.url="../good_count/good_count":"allocation"==t.type&&(this.url="../good_allocation/good_allocation"),this.type=t.type,o=uni.getStorageSync("uid"),a.get_productList()},onShow:function(){uni.removeStorageSync("products"),uni.getStorageSync("category")&&(a.showOptions=!0,a.category=uni.getStorageSync("category")),uni.getStorageSync("warehouse")&&(a.showOptions=!0,a.stock=uni.getStorageSync("warehouse")[uni.getStorageSync("warehouse").length-1].stock),uni.getStorageSync("is_option")&&(this.productList=[],a.get_productList())},onHide:function(){f="",h=30,v=[],g=[],p=[],uni.removeStorageSync("is_option")},methods:{change_page:function(t){_=t.current,a.get_productList()},shaixuan:function(){a.showOptions=!0},confirm:function(t){f=t.detail.value,a.search_text=t.detail.value,a.page_num=1,_=1,a.get_productList()},confrim_this:function(){this.go_goodsconfrim()},option_reset:function(){this.productList=[],uni.removeStorageSync("category"),uni.removeStorageSync("warehouse"),a.category="",a.stock="",a.showOptions=!1,a.get_productList()},option_confrim:function(){this.productList=[],uni.getStorageSync("category")&&(a.category=uni.getStorageSync("category")),uni.getStorageSync("warehouse")&&(a.stock=uni.getStorageSync("warehouse")[uni.getStorageSync("warehouse").length-1].stock),a.showOptions=!1,a.get_productList()},selectd:function(t){h=30,a.checked_option=t,a.get_productList()},radioChange:function(t){f?p[_-1]=t.detail.value:v[_-1]=t.detail.value,g=p.concat(v),g=g.reduce(function(t,e){return t.concat(e)}),console.log(g)},go_goodsconfrim:function(){console.log(g),0==g.length?uni.showToast({title:"请选择产品",icon:"none"}):"allocation"==this.type?this.stock?this.confrim_next():uni.showToast({title:"请在筛选中选择调拨的仓库",icon:"none"}):this.confrim_next()},confrim_next:function(){var t=0;if("entering"==this.type){var e=!0,i=!1,n=void 0;try{for(var o,a=(0,c.default)(g);!(e=(o=a.next()).done);e=!0){var s=o.value;g[t]=JSON.parse(s),g[t].num=1,g[t].total_money=1*g[t].costPrice,g[t].modify_retailPrice=g[t].costPrice,t+=1}}catch(f){i=!0,n=f}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}else{var r=!0,l=!1,u=void 0;try{for(var d,v=(0,c.default)(g);!(r=(d=v.next()).done);r=!0){var p=d.value;g[t]=JSON.parse(p),g[t].num=1,g[t].total_money=1*g[t].retailPrice,g[t].modify_retailPrice=g[t].retailPrice,t+=1}}catch(f){l=!0,u=f}finally{try{r||null==v.return||v.return()}finally{if(l)throw u}}}uni.setStorageSync("products",g),uni.navigateTo({url:this.url})},get_productList:function(){var t=this;a.productList=[];var e=Bmob.Query("Goods");e.include("stocks"),e.equalTo("userId","==",o),e.equalTo("stocks","==",a.stock.objectId),e.equalTo("status","!=",-1),e.equalTo("second_class","==",a.category.objectId);var i=e.equalTo("goodsName","==",{$regex:f+".*"}),n=e.equalTo("packageContent","==",{$regex:f+".*"});e.or(i,n),e.limit(h),e.skip(h*(_-1)),e.order("-"+a.checked_option),e.find().then(function(e){if(g.length>=1){var i=!0,n=!1,o=void 0;try{for(var a,s=(0,c.default)(g);!(i=(a=s.next()).done);i=!0){var r=a.value,l=!0,u=!1,d=void 0;try{for(var v,p=(0,c.default)(e);!(l=(v=p.next()).done);l=!0){var f=v.value;f.objectId==JSON.parse(r).objectId&&(f.checked=!0)}}catch(h){u=!0,d=h}finally{try{l||null==p.return||p.return()}finally{if(u)throw d}}}}catch(h){n=!0,o=h}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}}t.productList=e,t.loading=!1})},handle_data:function(){uni.removeStorageSync("category"),uni.removeStorageSync("warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("shop"),f="",h=30}}};e.default=w},b19c:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,"uni-page-body[data-v-5d754a22]{background:#fff}.text_notice[data-v-5d754a22]{margin-left:%?6?%}.content[data-v-5d754a22]{height:100%;overflow:hidden}.uni-product-list[data-v-5d754a22]{padding:0 %?10?%;width:calc(100% - %?20?%);height:calc(100vh - %?236?%)}.uni-product[data-v-5d754a22]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:%?10?% 0;border-bottom:1px solid#ddd;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;width:100%;margin-left:%?20?%}.product_image[data-v-5d754a22]{width:%?80?%;height:%?80?%}.product_name[data-v-5d754a22]{font-weight:700;color:#333}.product_reserve[data-v-5d754a22]{color:#6c757d;font-size:%?24?%;font-weight:700}.title[data-v-5d754a22]{font-size:15px;line-height:20px;color:#333;padding:15px}.city[data-v-5d754a22]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;width:100%;margin-left:8px;white-space:nowrap}.input-view[data-v-5d754a22]{width:92%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;background-color:#e7e7e7;height:30px;border-radius:15px;padding:0 4%;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;margin:%?8?% 0;line-height:30px}.input-view .uni-icon[data-v-5d754a22]{line-height:30px!important}.input-view .input[data-v-5d754a22]{height:30px;line-height:30px;width:94%;padding:0 3%}body.?%PAGE?%[data-v-5d754a22]{background:#fff}",""])},e7b6:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"page"},[t.loading?i("loading"):i("v-uni-view",{staticClass:"content"},[i("uni-nav-bar",{attrs:{fixed:!1,color:"#333333","background-color":"#FFFFFF","right-text":"确定","left-text":"筛选"},on:{"click-left":function(e){e=t.$handleEvent(e),t.shaixuan(e)},"click-right":function(e){e=t.$handleEvent(e),t.confrim_this(e)}}},[i("v-uni-view",{staticClass:"input-view"},[i("uni-icon",{attrs:{type:"search",size:"22",color:"#666666"}}),i("v-uni-input",{staticClass:"input",attrs:{"confirm-type":"search",type:"text",placeholder:"输入搜索关键词"},on:{confirm:function(e){e=t.$handleEvent(e),t.confirm(e)}}})],1)],1),i("v-uni-view",{staticClass:"display_flex good_option_view"},[i("v-uni-view",{staticClass:"good_option",on:{click:function(e){e=t.$handleEvent(e),t.selectd("createdAt")}}},[i("v-uni-text",{class:"createdAt"==t.checked_option?"option_selected":""},[t._v("创建时间")]),"createdAt"==t.checked_option?i("fa-icon",{attrs:{type:"check",size:"20",color:"#1d953f"}}):t._e()],1),i("v-uni-view",{staticClass:"good_option",on:{click:function(e){e=t.$handleEvent(e),t.selectd("goodsName")}}},[i("v-uni-text",{class:"goodsName"==t.checked_option?"option_selected":""},[t._v("名字")]),"goodsName"==t.checked_option?i("fa-icon",{attrs:{type:"check",size:"20",color:"#1d953f"}}):t._e()],1),i("v-uni-view",{staticClass:"good_option",on:{click:function(e){e=t.$handleEvent(e),t.selectd("reserve")}}},[i("v-uni-text",{class:"reserve"==t.checked_option?"option_selected":""},[t._v("库存")]),"reserve"==t.checked_option?i("fa-icon",{attrs:{type:"check",size:"20",color:"#1d953f"}}):t._e()],1)],1),i("v-uni-view",{staticClass:"uni-product-list"},[t.productList.length>0?i("v-uni-scroll-view",{staticClass:"uni-product-list",attrs:{"scroll-y":""}},[i("v-uni-checkbox-group",{on:{change:function(e){e=t.$handleEvent(e),t.radioChange(e)}}},t._l(t.productList,function(e,n){return i("v-uni-view",{key:n,staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",[i("v-uni-checkbox",{staticClass:"round blue",staticStyle:{transform:"scale(0.9)"},attrs:{value:JSON.stringify(e),color:"#426ab3",data:n,id:""+n,checked:e.checked}})],1),i("v-uni-label",{staticClass:"uni-product",attrs:{for:""+n}},[i("v-uni-view",[e.goodsIcon?i("v-uni-image",{staticClass:"product_image",attrs:{src:e.goodsIcon,mode:"widthFix","lazy-load":"true"}}):i("v-uni-image",{staticClass:"product_image",attrs:{src:"/static/goods-default.png",mode:"widthFix","lazy-load":"true"}})],1),i("v-uni-view",{staticStyle:{"margin-left":"20rpx",width:"100%","line-height":"40rpx"}},[i("v-uni-view",{staticClass:"product_name",staticStyle:{"font-size":"30rpx"}},[t._v(t._s(e.goodsName))]),e.stocks?i("v-uni-view",{staticClass:"product_reserve"},[e.stocks.stock_name?i("v-uni-view",[t._v("所存仓库:"),i("v-uni-text",{staticClass:"text_notice"},[t._v(t._s(e.stocks.stock_name))])],1):t._e()],1):t._e(),e.packageContent&&e.packingUnit?i("v-uni-view",{staticClass:"product_reserve"},[t._v("规格:"),i("v-uni-text",{staticClass:"text_notice"},[t._v(t._s(e.packageContent)+"*"+t._s(e.packingUnit))])],1):t._e(),i("v-uni-view",{staticClass:"product_reserve"},[t._v("库存数量:"),i("v-uni-text",{staticClass:"text_notice"},[t._v(t._s(e.reserve))])],1),i("v-uni-view",{staticClass:"product_reserve"},[t._v("创建时间:"),i("v-uni-text",{staticClass:"text_notice"},[t._v(t._s(e.createdAt))])],1)],1)],1)],1)}),1)],1):i("nocontent",{attrs:{type:1}})],1),i("v-uni-view",{staticStyle:{padding:"6rpx 0","border-top":"1rpx solid#ddd"}},[i("uni-pagination",{attrs:{"show-icon":!0,total:"100000",current:t.page_num},on:{change:function(e){e=t.$handleEvent(e),t.change_page(e)}}})],1)],1),t.showOptions?i("v-uni-view",{staticClass:"modal_background"},[i("v-uni-view",{staticClass:"showOptions"},[i("v-uni-navigator",{staticClass:"input_item1",attrs:{"hover-class":"none",url:"/pages/manage/category/category?type=choose"}},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center",width:"100%"}},[i("v-uni-view",{staticClass:"left_item"},[t._v("类别")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"产品类别",value:t.category.class_text,disabled:"true"}})],1)],1),i("v-uni-view",[i("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),i("v-uni-navigator",{staticClass:"input_item1",attrs:{"hover-class":"none",url:"/pages/manage/warehouse/warehouse?type=choose"}},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center",width:"100%"}},[i("v-uni-view",{staticClass:"left_item"},[t._v("仓库")]),i("v-uni-view",{staticClass:"right_input"},[i("v-uni-input",{attrs:{placeholder:"存放仓库",value:t.stock.stock_name,disabled:"true"}})],1)],1),i("v-uni-view",[i("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),i("v-uni-view",{staticClass:"option_bottom"},[i("v-uni-view",{staticClass:"selection",on:{click:function(e){e=t.$handleEvent(e),t.option_reset(e)}}},[t._v("重置")]),i("v-uni-view",{staticClass:"selection1",on:{click:function(e){e=t.$handleEvent(e),t.option_confrim(e)}}},[t._v("确定")])],1)],1)],1):t._e()],1)},o=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return o})}}]);