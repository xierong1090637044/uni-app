(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-common-goods_out-out_detail-out_detail"],{"126f":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[n("v-uni-view",{staticClass:"page"},[n("v-uni-view",{staticStyle:{"line-height":"70rpx",padding:"20rpx 20rpx 0"}},[e._v("已选产品")]),n("v-uni-view",e._l(e.products,function(t,o){return n("v-uni-view",{key:o,staticClass:"pro_listitem"},[n("v-uni-view",{staticClass:"pro_list",staticStyle:{color:"#3D3D3D"}},[n("v-uni-view",[e._v("产品："+e._s(t.goodsName))]),n("v-uni-view",[e._v("零售价：￥"+e._s(t.retailPrice?t.retailPrice:0))])],1),t.selected_model?n("v-uni-view",e._l(t.selected_model,function(t,o){return n("v-uni-view",{key:o,staticClass:"display_flex_bet"},[n("v-uni-view",{staticStyle:{"font-size":"24rpx",color:"#999"}},[e._v(e._s(t.custom1.value+t.custom2.value+t.custom3.value+t.custom4.value))]),n("v-uni-view",{staticStyle:{"font-size":"24rpx",color:"#f30"}},[e._v(e._s(t.num))])],1)}),1):e._e(),n("v-uni-view",{staticClass:"pro_list"},[n("v-uni-view",[e._v("实际零售价：￥"+e._s(t.modify_retailPrice)+"（X"+e._s(t.num)+"）")]),n("v-uni-view",[e._v("合计：￥"+e._s(t.total_money))])],1)],1)}),1),n("v-uni-form",{attrs:{"report-submit":"true"},on:{submit:function(t){t=e.$handleEvent(t),e.formSubmit(t)}}},[n("v-uni-view",{staticStyle:{margin:"30rpx 0"}},[n("v-uni-view",{staticStyle:{margin:"0 0 10rpx 10rpx"}},[e._v("开单明细（用于记录是否有无欠款）")]),n("v-uni-view",{staticClass:"kaidan_detail",staticStyle:{"line-height":"70rpx"}},[n("v-uni-navigator",{staticClass:"display_flex",attrs:{"hover-class":"none",url:"/pages/manage/warehouse/warehouse?type=choose"}},[n("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("选择仓库")]),n("v-uni-view",{staticClass:"kaidan_rightinput"},[n("v-uni-input",{attrs:{placeholder:"选择仓库",disabled:"true",value:e.stock.stock_name}})],1)],1),n("v-uni-navigator",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0"},attrs:{"hover-class":"none",url:"/pages/manage/shops/shops?type=choose"}},[n("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("选择门店")]),n("v-uni-view",{staticClass:"kaidan_rightinput"},[n("v-uni-input",{attrs:{placeholder:"选择门店",disabled:"true",value:e.shop_name}})],1)],1),n("v-uni-navigator",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0"},attrs:{"hover-class":"none",url:"/pages/manage/custom/custom?type=custom"}},[n("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("客户姓名")]),n("v-uni-view",{staticClass:"kaidan_rightinput"},[n("v-uni-input",{attrs:{placeholder:"选择客户",disabled:"true",value:e.custom.custom_name}})],1)],1),n("v-uni-view",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0"}},[n("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("发货方式")]),n("v-uni-picker",{staticClass:"kaidan_rightinput",attrs:{range:e.pickerTypes,"range-key":"desc"},on:{change:function(t){t=e.$handleEvent(t),e.select_outType(t)}}},[n("v-uni-input",{attrs:{placeholder:"请选择发货方式",disabled:"true"},model:{value:e.outType.desc,callback:function(t){e.$set(e.outType,"desc",t)},expression:"outType.desc"}})],1)],1),2==e.outType.type||3==e.outType.type?n("v-uni-view",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0"}},[n("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("快递单号")]),n("v-uni-view",{staticClass:"kaidan_rightinput display_flex",attrs:{range:e.pickerTypes,"range-key":"desc"},on:{change:function(t){t=e.$handleEvent(t),e.select_outType(t)}}},[n("v-uni-input",{attrs:{placeholder:"请输入快递单号"},model:{value:e.expressNum,callback:function(t){e.expressNum=t},expression:"expressNum"}}),n("fa-icon",{attrs:{type:"clone",size:"16",color:"#426ab3"},on:{click:function(t){t=e.$handleEvent(t),e.scan_code(t)}}})],1)],1):e._e(),e.custom.discount?n("v-uni-view",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0"}},[n("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("折扣率")]),n("v-uni-view",{staticClass:"kaidan_rightinput display_flex"},[n("v-uni-input",{staticStyle:{color:"#d71345"},attrs:{placeholder:"输入折扣率",value:e.discount,type:"number"},on:{input:function(t){t=e.$handleEvent(t),e.getDiscount(t)}}}),e._v("%")],1)],1):e._e(),n("v-uni-view",{staticClass:"display_flex",staticStyle:{padding:"10rpx 0"}},[n("v-uni-view",{staticStyle:{width:"140rpx"}},[e._v("实际付款")]),n("v-uni-view",{staticClass:"kaidan_rightinput"},[n("v-uni-input",{staticStyle:{color:"#d71345"},attrs:{placeholder:"输入实际付款金额",type:"digit"},model:{value:e.real_money,callback:function(t){e.real_money=t},expression:"real_money"}})],1)],1)],1)],1),n("v-uni-view",{staticStyle:{"margin-top":"20px"}},[n("v-uni-input",{staticClass:"beizhu_style",attrs:{placeholder:"请输入备注",name:"input_beizhu",fixed:"true"}})],1),n("v-uni-view",{staticStyle:{"margin-top":"20px",background:"#fff",padding:"10rpx"}},[n("v-uni-view",{staticClass:"notice_text"},[e._v("上传凭证图(会员可用)")]),n("v-uni-view",{staticStyle:{width:"100%",padding:"20rpx 0"}},[n("v-uni-view",{staticClass:"upload_image display_flex"},[e._l(e.Images,function(t,o){return e.Images&&e.Images.length>0?n("v-uni-view",{key:o,staticStyle:{position:"relative"}},[n("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx","margin-right":"10rpx"},attrs:{src:t}}),n("fa-icon",{staticStyle:{position:"absolute",top:"-10rpx",right:"-10rpx"},attrs:{type:"times-circle-o",size:"20",color:"#426ab3"},on:{click:function(t){t=e.$handleEvent(t),e.removeImg(o)}}})],1):e._e()}),e.Images.length<3?n("v-uni-view",{staticStyle:{width:"180rpx",height:"180rpx","line-height":"220rpx","text-align":"center",border:"1rpx solid#ccc","border-radius":"16rpx"},on:{click:function(t){t=e.$handleEvent(t),e.upload_image(t)}}},[n("fa-icon",{attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1):e._e()],2)],1)],1),n("v-uni-view",{staticClass:"bottomEle display_flex_bet",staticStyle:{padding:"0 30rpx"}},[n("v-uni-view",[n("v-uni-text",[e._v("合计：￥"+e._s(e.real_money))])],1),n("v-uni-view",{staticClass:"display_flex"},[n("v-uni-button",{staticClass:"confrim_button",attrs:{disabled:e.button_disabled,"form-type":"submit","data-type":"2"}},[e._v("出库")])],1)],1)],1)],1)],1)},a=[];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a})},"2c57":function(e,t,n){"use strict";var o=n("f26e"),a=n.n(o);a.a},"3af4":function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,".page[data-v-929e3956]{color:#4d4d4d;font-size:%?28?%;height:calc(100vh - %?90?%);overflow:scroll}.bottomEle[data-v-929e3956]{position:fixed;bottom:0;left:0;width:calc(100% - %?30?%);background:#fafafa;padding:%?20?% %?0?% %?20?% %?30?%}.pro_list[data-v-929e3956]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between}.pro_listitem[data-v-929e3956]{background-color:#fff;padding:%?10?% %?20?%;border-bottom:%?1?% solid#ddd}.pro_allmoney[data-v-929e3956]{background-color:#fff;padding:%?10?% %?20?%;text-align:right;font-size:%?32?%;color:#f30}.beizhu_style[data-v-929e3956]{width:calc(100% - %?40?%);background-color:#fff;padding:%?20?%;font-size:%?32?%;max-height:%?100?%}.confrim_button[data-v-929e3956]{padding:0 %?50?%;background:#1651aa;color:#fff;font-weight:700;font-size:%?32?%;border-radius:unset}",""])},7329:function(e,t,n){"use strict";(function(e){var o=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("6b54"),n("87b3");var a=o(n("5d73"));n("c5f6"),n("7f7f");var i,r,s,u,l=o(n("c74b")),c=o(n("df06")),d=o(n("da3f")),p=o(n("b410")),m={data:function(){return{user:uni.getStorageSync("user"),identity:uni.getStorageSync("identity"),othercurrent:"",Images:[],stock:"",shop_name:"",products:null,button_disabled:!1,beizhu_text:"",real_money:0,all_money:0,custom:null,outType:"",discount:"",pickerTypes:[{desc:"自提",type:1},{desc:"快递",type:2},{desc:"物流",type:3},{desc:"送货上门",type:4}],expressNum:"",total_num:0}},onLoad:function(){r=this,i=uni.getStorageSync("uid"),this.products=uni.getStorageSync("products"),r.user.rights&&r.user.rights.othercurrent&&(r.othercurrent=r.user.rights.othercurrent)},onShow:function(){if(this.really_total_money=0,this.all_money=0,this.real_money=0,r.custom=uni.getStorageSync("custom"),u=uni.getStorageSync("shop"),u){r.shop_name=u.name;var e=l.default.Pointer("shops");s=e.set(u.objectId)}if(r.custom.discount){r.discount=r.custom.discount;for(var t=0;t<this.products.length;t++)this.all_money=Number((this.products[t].total_money+this.all_money).toFixed(2)),this.really_total_money=Number((this.products[t].really_total_money+this.really_total_money).toFixed(2));this.really_total_money=this.really_total_money*r.discount/100,this.real_money=Number(this.all_money.toFixed(2))*r.discount/100,this.all_money=this.all_money*r.discount/100}else{for(var n=0;n<this.products.length;n++)this.all_money=Number((this.products[n].total_money+this.all_money).toFixed(2)),this.really_total_money=Number((this.products[n].really_total_money+this.really_total_money).toFixed(2));this.real_money=Number(this.all_money.toFixed(2))}r.stock=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:""},methods:{scan_code:function(){this.$wechat.scanQRCode().then(function(e){r.expressNum=e.result})},removeImg:function(e){r.Images.splice(e,1),r.Images=r.Images},upload_image:function(){r.user.is_vip?uni.chooseImage({count:3,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){e.log(t);var n,o=Date.parse(new Date),i=t.tempFilePaths,s=!0,u=!1,c=void 0;try{for(var d,p=(0,a.default)(i);!(s=(d=p.next()).done);s=!0){var m=d.value;n=l.default.File(o+".jpg",m)}}catch(v){u=!0,c=v}finally{try{s||null==p.return||p.return()}finally{if(u)throw c}}n.save().then(function(e){var t=!0,n=!1,o=void 0;try{for(var i,s=(0,a.default)(e);!(t=(i=s.next()).done);t=!0){var u=i.value;r.Images.push(u.url)}}catch(v){n=!0,o=v}finally{try{t||null==s.return||s.return()}finally{if(n)throw o}}})}}):uni.showToast({title:"您还不是会员，无法使用",icon:"none"})},getDiscount:function(e){var t=Number(e.detail.value);t>=100?r.discount=100:(r.discount=t,r.real_money=Number(this.all_money.toFixed(2))*t/100)},select_outType:function(e){r.outType=r.pickerTypes[e.detail.value],2==r.outType.type&&3==r.outType.type||(r.expressNum="")},formSubmit:function(t){e.log(t),this.button_disabled=!0;var n=t.detail.formId,o=2;uni.showLoading({title:"上传中..."});for(var a=l.default.Pointer("stocks"),m=a.set(r.stock?r.stock.objectId:""),v=new Array,f=[],y=0;y<this.products.length;y++){var g=Number(this.products[y].reserve)-this.products[y].num,h=l.default.Query("Bills"),_={},b=l.default.Pointer("_User"),w=b.set(i),S=l.default.Pointer("_User"),x=S.set(uni.getStorageSync("masterId")),B=l.default.Pointer("Goods"),k=B.set(this.products[y].objectId);if(uni.getStorageSync("custom")){var R=l.default.Pointer("customs"),N=R.set(uni.getStorageSync("custom").objectId);h.set("custom",N)}h.set("goodsName",this.products[y].goodsName),h.set("retailPrice",this.products[y].modify_retailPrice.toString()),h.set("num",Number(this.products[y].num)),h.set("total_money",this.products[y].total_money),h.set("really_total_money",this.products[y].really_total_money),h.set("goodsId",k),h.set("userId",w),h.set("type",-1),h.set("extra_type",o),h.set("opreater",x),h.set("stock",m),h.set("status",2==o);var I={};_.goodsName=this.products[y].goodsName,_.modify_retailPrice=this.products[y].modify_retailPrice.toString(),_.retailPrice=this.products[y].retailPrice,_.total_money=this.products[y].total_money,I.costPrice=this.products[y].costPrice,I.retailPrice=this.products[y].retailPrice,I.objectId=this.products[y].objectId,I.reserve=g,this.products[y].selectd_model&&(I.selected_model=this.products[y].selected_model,I.models=this.products[y].models),_.goodsId=I,_.type=-1,_.num=this.products[y].num,_.warning_num=this.products[y].warning_num,u&&(h.set("shop",s),c.default.record_shopOut(u.objectId,u.have_out+this.products[y].num)),v.push(h),f.push(_)}l.default.Query("Bills").saveAll(v).then(function(a){for(var v=[],y=0;y<a.length;y++)v.push(a[y].success.objectId);var g=l.default.Pointer("_User"),h=g.set(i),_=uni.getStorageSync("masterId"),b=l.default.Pointer("_User"),w=b.set(_),S=l.default.Query("order_opreations");if(S.set("detail",f),S.set("bills",v),S.set("beizhu",t.detail.value.input_beizhu),S.set("type",-1),S.set("extra_type",o),S.set("opreater",w),S.set("stock",m),S.set("master",h),S.set("real_num",r.total_num),r.discount&&S.set("discount",r.discount),S.set("goodsName",r.products[0].goodsName),S.set("real_money",Number(r.real_money)),S.set("debt",r.all_money-Number(r.real_money)),u&&S.set("shop",s),r.custom){var x=l.default.Pointer("customs"),B=x.set(r.custom.objectId);if(S.set("custom",B),r.all_money-Number(r.real_money)>0){var k=l.default.Query("customs");k.get(r.custom.objectId).then(function(t){var n=null==t.debt?0:t.debt;n+=r.all_money-Number(r.real_money),e.log(n);var o=l.default.Query("customs");o.get(r.custom.objectId).then(function(e){e.set("debt",n),e.save()})})}}r.outType&&(S.set("typeDesc",r.outType.desc),S.set("expressNum",r.expressNum)),S.set("all_money",r.all_money),S.set("Images",r.Images),S.set("status",!1),S.save().then(function(e){var a=e.objectId;uni.hideLoading(),uni.removeStorageSync("customs"),2==o?uni.showToast({title:"产品出库成功",icon:"success",success:function(){c.default.outRedGoodNum(r.products).then(function(o){r.button_disabled=!1,uni.setStorageSync("is_option",!0),setTimeout(function(){uni.removeStorageSync("_warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("category"),uni.removeStorageSync("warehouse"),c.default.log(uni.getStorageSync("user").nickName+"出库了'"+r.products[0].goodsName+"'等"+r.products.length+"商品",-1,a);var o={data1:a,data2:uni.getStorageSync("user").nickName+"出库了'"+r.products[0].goodsName+"'等"+r.products.length+"商品",data3:r.stock?r.stock.stock_name:"未填写",data4:e.createdAt,remark:t.detail.value.input_beizhu?t.detail.value.input_beizhu:"未填写",url:"https://www.jimuzhou.com/h5/pages/report/EnteringHistory/detail/detail?id="+a};d.default.send_temp(o);var i={keyword1:{value:r.products[0].goodsName+"'等",color:"#173177"},keyword2:{value:t.detail.value.input_beizhu?t.detail.value.input_beizhu:"未填写"},keyword3:{value:e.createdAt},keyword4:{value:uni.getStorageSync("user").nickName}};i.form_Id=n,i.id=a,d.default.send_out_mini(i),uni.getStorageSync("setting").auto_print&&p.default.autoPrint(a),uni.navigateBack({delta:2})},500)})}}):1==o&&uni.showToast({title:"产品销售成功",icon:"success",success:function(){r.button_disabled=!1,uni.setStorageSync("is_option",!0),setTimeout(function(){uni.removeStorageSync("_warehouse"),uni.removeStorageSync("out_warehouse"),uni.removeStorageSync("category"),uni.removeStorageSync("warehouse"),c.default.log(uni.getStorageSync("user").nickName+"销售了'"+r.products[0].goodsName+"'等"+r.products.length+"商品",-1,e.objectId),uni.getStorageSync("setting").auto_print&&p.default.autoPrint(a),uni.navigateBack({delta:2})},500)}})})},function(t){e.log("异常处理")})}}};t.default=m}).call(this,n("5a52")["default"])},7874:function(e,t,n){"use strict";n.r(t);var o=n("7329"),a=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);t["default"]=a.a},"7b57":function(e,t,n){"use strict";n.r(t);var o=n("126f"),a=n("7874");for(var i in a)"default"!==i&&function(e){n.d(t,e,function(){return a[e]})}(i);n("2c57");var r=n("2877"),s=Object(r["a"])(a["default"],o["a"],o["b"],!1,null,"929e3956",null);t["default"]=s.exports},b410:function(e,t,n){"use strict";(function(e){var o=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("5d73")),i=o(n("c74b")),r={autoPrint:function(t){var n=this;e.log("sssss",t);var o=i.default.Query("order_opreations");o.include("opreater","custom","producer","stock"),o.get(t).then(function(t){e.log(t),n.print_operations(t,t.detail)})},print_goodDet:function(e){var t,n=uni.getStorageSync("now_product");n.objectId=e.good_id,n.stocks=e,n.productCode=e.productCode,t="<CB>商品信息</CB><BR>",t+="--------------------------------<BR>",t+="产品名称：　　 "+n.goodsName+"<BR>",n.stocks&&(t+="存放仓库：　　 "+n.stocks.stock_name+"<BR>"),n.position&&(t+="货架位置：　　 "+n.position+"<BR>"),n.producttime&&(t+="生产日期：　　 "+n.producttime+"<BR>"),n.nousetime&&(t+="失效日期：　　 "+n.nousetime+"<BR>"),t+="当前库存：　　 "+n.reserve+"<BR>",t+="产品规格:　　　"+n.packageContent+"*"+n.packingUnit+"<BR>",t+="进货价格:      "+n.costPrice+"<BR>",t+="零售价格:      "+n.retailPrice+"<BR>",n.bad_num&&(t+="货损数量:      "+n.bad_num+"<BR>"),t+="--------------------------------<BR>",t+="产品二维码：<BR>",t+="<QR>"+n.productCode+"</QR>",this.print_by_code(t)},print_operations:function(t,n){if(e.log(t),3==t.type){m="<CB>盘点单</CB><BR>",m+="--------------------------------<BR>";for(var o=0;o<n.length;o++)m+="产品名称："+n[o].goodsName+"<BR>",m+="盘点前库存："+n[o].reserve+"<BR>",m+="盘点后库存："+n[o].now_reserve+"<BR>",m+="--------------------------------<BR>"}else if(-2==t.type){m="<CB>调拨单</CB><BR>",m+="--------------------------------<BR>";for(var i=0;i<n.length;i++){m+="产品名称："+n[i].goodsName+"<BR>",m+="调拨数量："+n[i].num+"<BR>",m+="--------------------------------<BR>";var r=!0,s=!1,u=void 0;try{for(var l,c=(0,a.default)(t.detail);!(r=(l=c.next()).done);r=!0){var d=l.value;m+="调出仓库："+d.stock+"<BR>",m+="<RIGHT>当前库存："+(d.reserve-d.num)+"</RIGHT><BR>",m+="调入仓库："+d.out_stock+"<BR>",m+="<RIGHT>当前库存："+(d.out_reserve+d.num)+"</RIGHT><BR>"}}catch(f){s=!0,u=f}finally{try{r||null==c.return||c.return()}finally{if(s)throw u}}}m+="--------------------------------<BR>"}else if(2==t.type){m="<CB>退货单</CB><BR>",m+="--------------------------------<BR>";for(var p=0;p<n.length;p++)m+="产品名称："+n[p].goodsName+"<BR>",m+="零售价："+n[p].retailPrice+"<BR>",m+="数量    ：X"+n[p].num+"<BR>",m+="<RIGHT>总计："+n[p].total_money+"</RIGHT>",m+="--------------------------------<BR>",m+="退货明细：<BR>",null!=t.custom?m+="客户姓名："+t.custom.custom_name+"<BR>":m+="未记录客户 <BR>";m+="<BOLD><RIGHT>全部总计："+t.all_money+"</RIGHT></BOLD>",m+="--------------------------------<BR>"}else{var m;m=1==t.type?"<CB>入库单</CB><BR>":"<CB>出库单</CB><BR>",m+="--------------------------------<BR>";for(var v=0;v<n.length;v++)m+="产品名称："+n[v].goodsName+"<BR>",m+="实际单价："+n[v].retailPrice+"<BR>",m+="数量    ：X"+n[v].num+"<BR>",m+="<RIGHT>总计："+n[v].total_money+"</RIGHT>",m+="--------------------------------<BR>";m+="<BOLD><RIGHT>全部总计："+t.all_money+"</RIGHT></BOLD>",m+="--------------------------------<BR>",1==t.type&&(m+="开单明细：<BR>",m+="<BR>",null!=t.producer&&(m+="供货商姓名："+t.producer.producer_name+"<BR>"),null==t.real_money?m+="实际收款：未填写 <BR>":m+="实际收款："+t.real_money+"<BR>",t.debt>0&&(m+="本次欠款："+t.debt+"<BR>"),m+="--------------------------------<BR>"),-1==t.type&&(m+="开单明细：<BR>",m+="<BR>",t.custom&&(m+="客户姓名："+t.custom.custom_name+"<BR>"),t.real_money?m+="实际收款：未填写 <BR>":m+="实际收款："+t.real_money+"<BR>",t.debt>0&&(m+="本次欠款  ："+t.debt+"<BR>"),m+="--------------------------------<BR>")}m+="操作者："+t.opreater.nickName+"<BR>",m+="备注："+t.beizhu+"<BR>",m+="操作时间："+t.createdAt+"<BR>",this.print_by_code(m)},print_by_code:function(t){var n=uni.getStorageSync("setting").USER,o=uni.getStorageSync("setting").UKEY,a=uni.getStorageSync("setting").number,i="api.feieyun.cn",r="/Api/Open/",s=(new Date).getTime(),u=c(n+o+s);h(a,t,1);var l=0;function c(e){return g(d(y(e)))}function d(e){for(var t=e,n=Array(80),o=1732584193,a=-271733879,i=-1732584194,r=271733878,s=-1009589776,u=0;u<t.length;u+=16){for(var l=o,c=a,d=i,y=r,g=s,h=0;h<80;h++){n[h]=h<16?t[u+h]:f(n[h-3]^n[h-8]^n[h-14]^n[h-16],1);var _=v(v(f(o,5),p(h,a,i,r)),v(v(s,n[h]),m(h)));s=r,r=i,i=f(a,30),a=o,o=_}o=v(o,l),a=v(a,c),i=v(i,d),r=v(r,y),s=v(s,g)}return new Array(o,a,i,r,s)}function p(e,t,n,o){return e<20?t&n|~t&o:e<40?t^n^o:e<60?t&n|t&o|n&o:t^n^o}function m(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function v(e,t){var n=(65535&e)+(65535&t),o=(e>>16)+(t>>16)+(n>>16);return o<<16|65535&n}function f(e,t){return e<<t|e>>>32-t}function y(e){for(var t=1+(e.length+8>>6),n=new Array(16*t),o=0;o<16*t;o++)n[o]=0;for(o=0;o<e.length;o++)n[o>>2]|=e.charCodeAt(o)<<24-8*(3&o);return n[o>>2]|=128<<24-8*(3&o),n[16*t-1]=8*e.length,n}function g(e){for(var t=l?"0123456789ABCDEF":"0123456789abcdef",n="",o=0;o<4*e.length;o++)n+=t.charAt(e[o>>2]>>8*(3-o%4)+4&15)+t.charAt(e[o>>2]>>8*(3-o%4)&15);return n}function h(t,o,a){uni.request({url:"https://"+i+r,data:{user:n,stime:s,sig:u,apiname:"Open_printMsg",sn:t,content:o,times:a},method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t.data),0!=t.data.ret?uni.showToast({icon:"none",title:t.data.msg}):uni.showToast({icon:"none",title:"打印成功"})}})}}};t.default=r}).call(this,n("5a52")["default"])},da3f:function(e,t,n){"use strict";(function(e){var o=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("c74b")),i={send_in:function(t){var n=uni.getStorageSync("setting").wx_openid;uni.request({url:"https://www.jimuzhou.com/api/send_temp.php",method:"POST",data:{openid:n,frist:t.frist,data1:t.data1,data2:t.data2,remark:t.remark,url:t.url,type:"in"},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t)}})},send_in_noconfrim:function(t){var n=uni.getStorageSync("setting").wx_openid;uni.request({url:"https://www.jimuzhou.com/api/send_temp.php",method:"POST",data:{openid:n,frist:t.frist,data1:t.data1,data2:t.data2,data3:t.data3,data4:t.data4,remark:t.remark,url:t.url,type:"in_noconfrim"},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t)}})},send_in_mini:function(t){var n={touser:uni.getStorageSync("openid"),template_id:"nqZl9FWDofCo9cxU4de45grLKh2GU-PJcAvWSbJMy9k",page:"/pages/report/EnteringHistory/detail/detail?id="+t.id,form_id:t.form_Id,data:t,emphasis_keyword:""};a.default.sendWeAppMessage(n).then(function(t){e.log(t)}).catch(function(t){e.log(t)})},send_out_mini:function(t){var n={touser:uni.getStorageSync("openid"),template_id:"z0Km0FFiuvnNiUcXtZD046j43ue5_AxR05cDHFLLXPY",page:"/pages/report/EnteringHistory/detail/detail?id="+t.id,form_id:t.form_Id,data:t,emphasis_keyword:""};a.default.sendWeAppMessage(n).then(function(t){e.log(t)}).catch(function(t){e.log(t)})},send_temp:function(t){var n=uni.getStorageSync("setting").wx_openid;uni.request({url:"https://www.jimuzhou.com/api/send_temp.php",method:"POST",data:{openid:n,data1:t.data1,data2:t.data2,data3:t.data3,data4:t.data4,remark:"备注:"+t.remark,url:t.url,type:"out"},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.log(t)}})}};t.default=i}).call(this,n("5a52")["default"])},df06:function(e,t,n){"use strict";(function(t){var o=n("288e");n("6b54"),n("87b3"),n("7514");var a=o(n("5d73"));n("c5f6");var i=o(n("795b")),r=o(n("c74b"));e.exports={enterAddGoodNum:function(e){return new i.default(function(n,o){for(var i=function(o){var i=0,s=r.default.Query("Goods");s.get(e[o].objectId).then(function(r){if(t.log(e[o]),e[o].selectd_model){var s=!0,u=!1,l=void 0;try{for(var c,d=(0,a.default)(e[o].selected_model);!(s=(c=d.next()).done);s=!0){var p=c.value,m=!0,v=!1,f=void 0;try{for(var y,g=(0,a.default)(e[o].models);!(m=(y=g.next()).done);m=!0){var h=y.value;h.id==p.id&&(h.reserve=Number(h.reserve)+Number(p.num))}}catch(_){v=!0,f=_}finally{try{m||null==g.return||g.return()}finally{if(v)throw f}}}}catch(_){u=!0,l=_}finally{try{s||null==d.return||d.return()}finally{if(u)throw l}}i=Number(e[o].reserve)+Number(e[o].num),r.set("models",e[o].models)}else i=Number(e[o].reserve)+Number(e[o].num);r.set("reserve",i),r.set("stocktype",i>e[o].warning_num?1:0),r.save(),o==e.length-1&&n(!0)}).catch(function(e){t.log(e)})},s=0;s<e.length;s++)i(s)})},outRedGoodNum:function(e){var n=this;return new i.default(function(o,i){for(var s=function(i){var s=0,u=r.default.Query("Goods");u.get(e[i].objectId).then(function(t){if(e[i].selectd_model){var r=!0,u=!1,l=void 0;try{for(var c,d=(0,a.default)(e[i].selectd_model);!(r=(c=d.next()).done);r=!0){var p=c.value,m=!0,v=!1,f=void 0;try{for(var y,g=(0,a.default)(e[i].models);!(m=(y=g.next()).done);m=!0){var h=y.value;s+=Number(h.reserve),h.id==p.id&&(h.reserve=Number(h.reserve)-Number(p.num))}}catch(_){v=!0,f=_}finally{try{m||null==g.return||g.return()}finally{if(v)throw f}}}}catch(_){u=!0,l=_}finally{try{r||null==d.return||d.return()}finally{if(u)throw l}}s=Number(e[i].reserve)-Number(e[i].num),t.set("models",e[i].models)}else s=Number(e[i].reserve)-Number(e[i].num);t.set("reserve",s),t.set("stocktype",s>=e[i].warning_num?1:0),t.save(),e[i].warning_num>=s&&n.log(e[i].goodsName+"出库了"+e[i].num+"件，已经低于预警数量"+e[i].warning_num,-2,e[i].objectId),n.record_staffOut(Number(e[i].num)),i==e.length-1&&o(!0)}).catch(function(e){t.log(e)})},u=0;u<e.length;u++)s(u)})},handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(e,n,o){var a=r.default.Pointer("_User"),i=a.set(uni.getStorageSync("uid")),s=r.default.Query("logs");s.set("parent",i),s.set("log",e),s.set("detail_id",o),s.set("type",n),s.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})},record_shopOut:function(e,n){t.log(e,n);var o=r.default.Query("shops");o.set("id",e),o.set("have_out",n),o.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})},record_staffOut:function(e){if(t.log(e,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var n=r.default.Query("staffs");n.set("id",uni.getStorageSync("user").objectId),n.set("have_out",Number(e)+uni.getStorageSync("user").have_out),n.save().then(function(e){t.log(e)}).catch(function(e){t.log(e)})}},get_allCost:function(){var e=uni.getStorageSync("uid");t.log(e);var n=r.default.Query("Goods");n.equalTo("userId","==",e),n.find().then(function(e){t.log(e);var n=!0,o=!1,i=void 0;try{for(var r,s=(0,a.default)(e);!(n=(r=s.next()).done);n=!0){var u=r.value;t.log(u),Number(u.costPrice)*u.reserve,u.reserve}}catch(l){o=!0,i=l}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}})},getDay:function(e,t){var n=this,o=new Date,a=o.getTime()+864e5*e;o.setTime(a);var i=o.getFullYear(),r=o.getMonth(),s=o.getDate();return r=n.handleMonth(r+1),s=n.handleMonth(s),t?i+"-"+r+"-"+s+" 00:00:00":i+"-"+r+"-"+s},js_date_time:function(e,t){var n=new Date(e),o=n.getFullYear(),a=n.getMonth()+1;a=a<10?"0"+a:a;var i=n.getDate();i=i<10?"0"+i:i;var r=n.getHours();r=r<10?"0"+r:r;var s=n.getMinutes(),u=n.getSeconds();return s=s<10?"0"+s:s,u=u<10?"0"+u:u,t?o+"-"+a+"-"+i+" "+r+":"+s:o+"-"+a+"-"+i},handleMonth:function(e){var t=e;return 1==e.toString().length&&(t="0"+e),t}}}).call(this,n("5a52")["default"])},f26e:function(e,t,n){var o=n("3af4");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var a=n("4f06").default;a("fcedb296",o,!0,{sourceMap:!1,shadowMode:!1})}}]);