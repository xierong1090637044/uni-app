(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-good_det-edit_stock-edit_stock"],{"0860":function(e,t,n){"use strict";var i,o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"page"},[n("v-uni-form",{on:{submit:function(t){arguments[0]=t=e.$handleEvent(t),e.formSubmit.apply(void 0,arguments)}}},[n("v-uni-scroll-view",{staticStyle:{height:"calc(100vh - 148rpx)"},attrs:{"scroll-y":!0}},[n("v-uni-view",{staticClass:"frist"},[n("v-uni-view",{staticClass:"notice_text"},[e._v("产品图"),n("v-uni-text",{staticStyle:{"font-size":"20rpx",color:"#333"}},[e._v("(修改库存模式不支持上传图片)")])],1),n("v-uni-view",{staticStyle:{width:"100%",padding:"20rpx 0"}},[n("v-uni-view",{staticClass:"upload_image"},[e.goodsIcon?n("v-uni-image",{staticStyle:{width:"180rpx",height:"180rpx"},attrs:{src:e.goodsIcon}}):n("fa-icon",{staticStyle:{height:"180rpx","line-height":"180rpx"},attrs:{type:"plus-square-o",size:"40",color:"#426ab3"}})],1),n("v-uni-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{name:"goodsIcon",value:e.goodsIcon}})],1)],1),n("v-uni-view",{staticClass:"frist"},[n("v-uni-view",{staticClass:"notice_text"},[e._v("基本信息")]),n("v-uni-view",{staticClass:"input_item"},[n("v-uni-view",{staticClass:"left_item"},[e._v("名称"),n("v-uni-text",{staticStyle:{color:"#aa2116","margin-left":"4rpx"}},[e._v("*")])],1),n("v-uni-view",{staticClass:"right_input1"},[n("v-uni-input",{attrs:{placeholder:"产品名称",name:"goodsName",value:e.goodsName,disabled:"true"}})],1)],1),n("v-uni-navigator",{staticClass:"input_item2",attrs:{"hover-class":"none",url:"/pages/manage/category/category?type=choose"}},[n("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[n("v-uni-view",{staticClass:"left_item"},[e._v("类别")]),n("v-uni-view",{staticClass:"right_input1"},[n("v-uni-input",{attrs:{placeholder:"产品类别",name:"goodsClass",value:e.category.class_text,disabled:"true"}})],1)],1),n("v-uni-view",[n("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),n("v-uni-view",{staticClass:"input_item"},[n("v-uni-view",{staticClass:"left_item"},[e._v("进价")]),n("v-uni-view",{staticClass:"right_input1"},[n("v-uni-input",{attrs:{placeholder:"产品进价",name:"costPrice",type:"digit",value:e.costPrice,disabled:"true"}})],1)],1),n("v-uni-view",{staticClass:"input_item"},[n("v-uni-view",{staticClass:"left_item"},[e._v("售价")]),n("v-uni-view",{staticClass:"right_input1"},[n("v-uni-input",{attrs:{placeholder:"产品售价",name:"retailPrice",type:"digit",value:e.retailPrice,disabled:"true"}})],1)],1),n("v-uni-view",{staticClass:"input_item"},[n("v-uni-view",{staticClass:"left_item"},[e._v("包装含量")]),n("v-uni-view",{staticClass:"right_input1"},[n("v-uni-input",{attrs:{placeholder:"包装含量",name:"packageContent",value:e.packageContent,disabled:"true"}})],1)],1),n("v-uni-view",{staticClass:"input_item"},[n("v-uni-view",{staticClass:"left_item"},[e._v("包装单位")]),n("v-uni-view",{staticClass:"right_input1"},[n("v-uni-input",{attrs:{placeholder:"包装单位",name:"packingUnit",value:e.packingUnit,disabled:"true"}})],1)],1)],1),n("v-uni-view",{staticClass:"frist",staticStyle:{"margin-bottom":"30rpx"}},[e.models?n("v-uni-navigator",{staticClass:"input_item2",staticStyle:{"line-height":"70rpx"},attrs:{"hover-class":"none",url:"/pages/manage/goods_add_MoreG/G_More/G_More"}},[n("v-uni-view",{staticClass:"display_flex"},[n("v-uni-view",{staticClass:"input_item",staticStyle:{width:"100%"}},[n("v-uni-view",{staticClass:"left_item"},[e._v("初始库存")]),n("v-uni-input",{attrs:{placeholder:"初始库存",type:"digit",name:"reserve",disabled:"true"},model:{value:e.reserve,callback:function(t){e.reserve=t},expression:"reserve"}})],1)],1),n("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1):n("v-uni-view",{staticStyle:{"line-height":"70rpx"}},[n("v-uni-view",{staticClass:"display_flex_bet"},[n("v-uni-view",{staticClass:"input_item",staticStyle:{width:"100%"}},[n("v-uni-view",{staticClass:"left_item"},[e._v("初始库存")]),n("v-uni-input",{attrs:{placeholder:"初始库存",type:"digit",name:"reserve"},model:{value:e.reserve,callback:function(t){e.reserve=t},expression:"reserve"}})],1)],1)],1),n("v-uni-view",{staticClass:"input_item"},[n("v-uni-view",{staticClass:"left_item"},[e._v("预警库存")]),n("v-uni-view",{staticClass:"right_input1"},[n("v-uni-input",{attrs:{placeholder:"预警库存",name:"warning_num",type:"digit",value:e.warning_num}})],1)],1),n("v-uni-navigator",{staticClass:"input_item2",attrs:{"hover-class":"none",url:"/pages/manage/warehouse/warehouse?type=choose"}},[n("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[n("v-uni-view",{staticClass:"left_item"},[e._v("店仓")]),n("v-uni-view",{staticClass:"right_input1"},[n("v-uni-input",{attrs:{placeholder:"选择店仓",disabled:"true"},model:{value:e.stock_name,callback:function(t){e.stock_name=t},expression:"stock_name"}})],1)],1),n("v-uni-view",[n("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1)],1)],1),n("v-uni-view",{staticClass:"display_flex_bet"},[n("v-uni-button",{staticClass:"submit_button",attrs:{formType:"submit"}},[e._v(e._s(e.text_desc))]),n("v-uni-button",{staticClass:"reset_button",attrs:{formType:"reset"}},[e._v("重置")])],1)],1)],1)},a=[];n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}))},1961:function(e,t,n){var i=n("24fb");t=i(!1),t.push([e.i,'.uni-collapse[data-v-7cac7d33]{background-color:#fff;position:relative;width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.uni-collapse[data-v-7cac7d33]:after{position:absolute;z-index:10;right:0;bottom:0;left:0;height:1px;content:"";-webkit-transform:scaleY(.5);transform:scaleY(.5);background-color:#c8c7cc}.uni-collapse[data-v-7cac7d33]:before{position:absolute;z-index:10;right:0;top:0;left:0;height:1px;content:"";-webkit-transform:scaleY(.5);transform:scaleY(.5);background-color:#c8c7cc}',""]),e.exports=t},"30a6":function(e,t,n){"use strict";n.r(t);var i=n("8208"),o=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},"35fc":function(e,t,n){"use strict";n.r(t);var i=n("db7f"),o=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},"54f8":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));n("a4d3"),n("e01a"),n("d28b"),n("e260"),n("d3b7"),n("3ca3"),n("ddb0");var i=n("dde1");function o(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(i["a"])(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,r=!0,s=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return r=e.done,e},e:function(e){s=!0,a=e},f:function(){try{r||null==o["return"]||o["return"]()}finally{if(s)throw a}}}}},"70ae":function(e,t,n){var i=n("d0d7");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=n("4f06").default;o("0e00e705",i,!0,{sourceMap:!1,shadowMode:!1})},"72dd":function(e,t,n){"use strict";var i,o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"uni-collapse"},[e._t("default")],2)},a=[];n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}))},"7c20":function(e,t,n){"use strict";n.r(t);var i=n("ce70"),o=n("f9c7");for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("f12f");var r,s=n("f0c5"),l=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"07b66df4",null,!1,i["a"],r);t["default"]=l.exports},"7fd5":function(e,t,n){"use strict";(function(t){var i=n("ee27");n("7db0"),n("a9e3"),n("d3b7"),n("25f0");var o=i(n("54f8")),a=i(n("9546"));e.exports={enterAddGoodNum:function(e,n){var i=this;return new Promise((function(r,s){for(var l=function(s){var l=0,c=a.default.Query("Goods");c.get(e[s].objectId).then((function(u){var d=u;if(e[s].selectd_model){var f,v=(0,o.default)(e[s].selected_model);try{for(v.s();!(f=v.n()).done;){var g,m=f.value,h=(0,o.default)(d.models);try{for(h.s();!(g=h.n()).done;){var p=g.value;p.id==m.id&&(p.reserve=Number(p.reserve)+Number(m.num)),delete p.num}}catch(b){h.e(b)}finally{h.f()}}}catch(b){v.e(b)}finally{v.f()}l=Number(d.reserve)+Number(e[s].num),c.set("models",d.models)}else l=Number(d.reserve)+Number(e[s].num);c.set("reserve",l),c.set("id",e[s].objectId),c.save().then((function(t){if(e[s].header){var o=a.default.Query("Goods");o.equalTo("header","==",e[s].header.objectId),o.equalTo("order","==",1),o.statTo("sum","reserve"),o.find().then((function(t){var o=t[0]._sumReserve,l=a.default.Query("Goods");l.set("reserve",o),"purchase"==n&&l.set("costPrice",e[s].modify_retailPrice),l.set("id",e[s].header.objectId),l.save().then((function(t){i.modifyStockType(e[s].header.objectId),s==e.length-1&&r(!0)}))}))}else i.modifyStockType(e[s].objectId),s==e.length-1&&r(!0)})).catch((function(e){t.log(e)}))}))},c=0;c<e.length;c++)l(c)}))},outRedGoodNum:function(e){var n=this;return new Promise((function(i,r){for(var s=function(r){var s=0,l=a.default.Query("Goods");l.get(e[r].objectId).then((function(c){var u=c;if(e[r].selectd_model){var d,f=(0,o.default)(e[r].selected_model);try{for(f.s();!(d=f.n()).done;){var v,g=d.value,m=(0,o.default)(u.models);try{for(m.s();!(v=m.n()).done;){var h=v.value;s+=Number(h.reserve),h.id==g.id&&(h.reserve=Number(h.reserve)-Number(g.num)),delete h.num}}catch(p){m.e(p)}finally{m.f()}}}catch(p){f.e(p)}finally{f.f()}s=Number(u.reserve)-Number(e[r].num),l.set("models",u.models)}else s=Number(u.reserve)-Number(e[r].num);l.set("reserve",s),l.set("id",e[r].objectId),l.save().then((function(t){if(e[r].header){var o=a.default.Query("Goods");o.equalTo("header","==",e[r].header.objectId),o.equalTo("order","==",1),o.statTo("sum","reserve"),o.find().then((function(t){var o=t[0]._sumReserve,s=a.default.Query("Goods");s.set("reserve",o),s.set("id",e[r].header.objectId),s.save().then((function(t){n.modifyStockType(e[r].header.objectId),r==e.length-1&&i(!0)}))}))}else n.modifyStockType(e[r].objectId),r==e.length-1&&i(!0)})).catch((function(e){t.log(e)}))}))},l=0;l<e.length;l++)s(l)}))},enterAddGoodNumNew:function(e,n){var i=this;return new Promise((function(r,s){for(var l=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",c=uni.getStorageSync("uid"),u=function(s){var u=0,d=a.default.Query("Goods");d.equalTo("userId","==",c),d.equalTo("header","==",e[s].objectId),d.equalTo("stocks","==",l.objectId),d.find().then((function(c){if(0==c.length)i.upload_good_withNoCan(e[s],l,Number(e[s].num)).then((function(t){d.equalTo("header","==",e[s].objectId),d.equalTo("order","==",1),d.statTo("sum","reserve"),d.find().then((function(t){var i=t[0]._sumReserve;d.set("reserve",i),d.set("id",e[s].objectId),"purchase"==n&&d.set("costPrice",e[s].modify_retailPrice),d.save().then((function(t){s==e.length-1&&r(!0)}))}))}));else{var f=c[0],v=a.default.Query("Goods");if(e[s].selected_model){var g,m=(0,o.default)(e[s].selected_model);try{for(m.s();!(g=m.n()).done;){var h,p=g.value,b=(0,o.default)(f.models);try{for(b.s();!(h=b.n()).done;){var _=h.value;_.id==p.id&&(_.reserve=Number(_.reserve)+Number(p.num)),delete _.num}}catch(y){b.e(y)}finally{b.f()}}}catch(y){m.e(y)}finally{m.f()}u=Number(f.reserve)+Number(e[s].num),v.set("models",f.models)}else u=Number(f.reserve)+Number(e[s].num);v.set("reserve",u),v.set("id",f.objectId),v.save().then((function(t){v.equalTo("header","==",e[s].objectId),v.equalTo("order","==",1),v.statTo("sum","reserve"),v.find().then((function(t){var i=t[0]._sumReserve;v.set("reserve",i),"purchase"==n&&v.set("costPrice",e[s].modify_retailPrice.toString()),v.set("id",e[s].objectId),v.save().then((function(t){s==e.length-1&&r(!0)}))}))})).catch((function(e){t.log(e)}))}}))},d=0;d<e.length;d++)u(d)}))},outRedGoodNumNew:function(e){var n=this;return new Promise((function(i,r){for(var s=uni.getStorageSync("warehouse")?uni.getStorageSync("warehouse")[0].stock:"",l=uni.getStorageSync("uid"),c=function(r){var c=0,u=a.default.Query("Goods");u.equalTo("userId","==",l),u.equalTo("header","==",e[r].objectId),u.equalTo("stocks","==",s.objectId),u.find().then((function(l){if(0==l.length)n.upload_good_withNoCan(e[r],s,Number(e[r].num),"out").then((function(t){u.equalTo("header","==",e[r].objectId),u.equalTo("order","==",1),u.statTo("sum","reserve"),u.find().then((function(t){var n=t[0]._sumReserve;u.set("reserve",n),u.set("id",e[r].objectId),u.save().then((function(t){a.default.functions("warn_GoodNum",{uid:uni.getStorageSync("uid"),goodId:e[r].objectId}).then((function(e){})),r==e.length-1&&i(!0)}))}))}));else{var d=l[0];if(e[r].selected_model){var f,v=(0,o.default)(e[r].selected_model);try{for(v.s();!(f=v.n()).done;){var g,m=f.value,h=(0,o.default)(d.models);try{for(h.s();!(g=h.n()).done;){var p=g.value;p.id==m.id&&(p.reserve=Number(p.reserve)-Number(m.num)),delete p.num}}catch(b){h.e(b)}finally{h.f()}}}catch(b){v.e(b)}finally{v.f()}c=Number(d.reserve)-Number(e[r].num),u.set("models",d.models)}else c=Number(d.reserve)-Number(e[r].num);u.set("reserve",c),u.set("id",d.objectId),u.save().then((function(t){u.equalTo("header","==",e[r].objectId),u.equalTo("order","==",1),u.statTo("sum","reserve"),u.find().then((function(t){var n=t[0]._sumReserve;u.set("reserve",n),u.set("id",e[r].objectId),u.save().then((function(t){a.default.functions("warn_GoodNum",{uid:uni.getStorageSync("uid"),goodId:e[r].objectId}).then((function(e){})),r==e.length-1&&i(!0)}))}))})).catch((function(e){t.log(e)}))}}))},u=0;u<e.length;u++)c(u)}))},upload_good_withNoCan:function(e,n,i,r){return new Promise((function(s,l){var c=uni.getStorageSync("uid"),u=a.default.Pointer("_User"),d=u.set(c),f=a.default.Pointer("stocks"),v=f.set(n.objectId),g=a.default.Pointer("Goods"),m="";m=e.header?g.set(e.header.objectId):g.set(e.objectId);var h=a.default.Query("Goods");if(h.set("goodsName",e.goodsName),h.set("goodsIcon",e.goodsIcon),"out"==r){if(h.set("reserve",0-Number(i)),e.goodsId&&e.goodsId.models){var p,b=(0,o.default)(e.goodsId.models);try{for(b.s();!(p=b.n()).done;){var _=p.value;_.reserve=0-Number(_.num)}}catch(z){b.e(z)}finally{b.f()}h.set("models",e.goodsId.models)}else if(e.models&&e.models.length>0){var y,w=(0,o.default)(e.models);try{for(w.s();!(y=w.n()).done;){var k=y.value;k.reserve=0-Number(k.num)}}catch(z){w.e(z)}finally{w.f()}h.set("models",e.models)}}else if("allocation"==r){if(h.set("reserve",Number(i)),e.selected_model&&e.selected_model.length>0){var x,S=(0,o.default)(e.selected_model);try{for(S.s();!(x=S.n()).done;){var I=x.value;I.reserve=Number(I.num),delete I.num}}catch(z){S.e(z)}finally{S.f()}h.set("models",e.selected_model)}}else if(h.set("reserve",Number(i)),e.goodsId&&e.goodsId.models){var C,N=(0,o.default)(e.goodsId.models);try{for(N.s();!(C=N.n()).done;){var j=C.value;j.reserve=Number(j.num)}}catch(z){N.e(z)}finally{N.f()}h.set("models",e.goodsId.models)}else if(e.models&&e.models.length>0){var T,P=(0,o.default)(e.models);try{for(P.s();!(T=P.n()).done;){var G=T.value;G.reserve=Number(G.num?G.num:0)}}catch(z){P.e(z)}finally{P.f()}h.set("models",e.models)}h.set("stocks",v),h.set("userId",d),h.set("header",m),h.set("costPrice",""+e.costPrice),h.set("retailPrice",""+e.retailPrice),h.set("order",1),h.save().then((function(e){t.log(e),s([!0,e])})).catch((function(e){t.log(e)}))}))},handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(e,n,i){var o=a.default.Pointer("_User"),r=o.set(uni.getStorageSync("uid"));if(-2==n){var s=a.default.Pointer("Goods"),l=s.set(i),c=a.default.Query("logs");c.equalTo("goodId","==",i),c.find().then((function(i){if(0==i.length){var o=a.default.Query("logs");o.set("parent",r),o.set("goodId",l),o.set("log",e),o.set("type",n),o.save().then((function(e){t.log(e)})).catch((function(e){t.log(e)}))}}))}else{var u=a.default.Query("logs");u.set("parent",r),u.set("log",e),u.set("detail_id",i),u.set("type",n),u.save().then((function(e){t.log(e)})).catch((function(e){t.log(e)}))}},modifyStockType:function(e){var n=this,i=a.default.Query("Goods");i.get(e).then((function(e){var t=e;""==t.warning_num&&""==t.max_num?e.set("stocktype",1):void 0==t.warning_num&&void 0==t.max_num?e.set("stocktype",1):null==t.warning_num&&null==t.max_num?e.set("stocktype",1):(""!=t.warning_num&&(t.warning_num>=t.reserve?(e.set("stocktype",0),n.log(t.goodsName+"已经超过设置的最小库存值"+t.warning_num,-2,t.objectId)):t.warning_num<t.reserve&&t.reserve<t.max_num&&e.set("stocktype",1)),""!=t.max_num&&(t.max_num<=t.reserve?(e.set("stocktype",2),n.log(t.goodsName+"已经超过设置的最大库存值"+t.max_num,-2,t.objectId)):t.warning_num<t.reserve&&t.reserve<t.max_num&&e.set("stocktype",1))),e.save()})).catch((function(e){t.log(e)}))},record_shopOut:function(e,n){t.log(e,n);var i=a.default.Query("shops");i.set("id",e),i.set("have_out",n),i.save().then((function(e){t.log(e)})).catch((function(e){t.log(e)}))},record_staffOut:function(e){if(t.log(e,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var n=a.default.Query("_User");n.set("id",uni.getStorageSync("user").objectId),n.set("have_out",Number(e)+uni.getStorageSync("user").have_out),n.save().then((function(e){t.log(e)})).catch((function(e){t.log(e)}))}},get_allCost:function(){var e=uni.getStorageSync("uid");t.log(e);var n=a.default.Query("Goods");n.equalTo("userId","==",e),n.find().then((function(e){t.log(e);var n,i=(0,o.default)(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;t.log(a),Number(a.costPrice)*a.reserve,a.reserve}}catch(r){i.e(r)}finally{i.f()}}))},getDay:function(e,t,n){var i=this,o=new Date,a=o.getTime()+864e5*e;o.setTime(a);var r=o.getFullYear(),s=o.getMonth(),l=o.getDate();return s=i.handleMonth(s+1),l=i.handleMonth(l),t?n?r+"-"+s+"-01 00:00:00":r+"-"+s+"-"+l+" 00:00:00":r+"-"+s+"-"+l},js_date_time:function(e,t){var n=new Date(e),i=n.getFullYear(),o=n.getMonth()+1;o=o<10?"0"+o:o;var a=n.getDate();a=a<10?"0"+a:a;var r=n.getHours();r=r<10?"0"+r:r;var s=n.getMinutes(),l=n.getSeconds();return s=s<10?"0"+s:s,l=l<10?"0"+l:l,t?i+"-"+o+"-"+a+" "+r+":"+s:i+"-"+o+"-"+a},handleMonth:function(e){var t=e;return 1==e.toString().length&&(t="0"+e),t}}}).call(this,n("5a52")["default"])},8208:function(e,t,n){"use strict";(function(e){var i=n("ee27");n("7db0"),n("a9e3"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,r=i(n("54f8")),s=i(n("9546")),l=i(n("7fd5")),c=i(n("4d52")),u=i(n("b4ab")),d=i(n("7c20")),f={components:{uniCollapse:u.default,uniCollapseItem:d.default,faIcon:c.default},data:function(){return{text_desc:"保存",goodsName:"",costPrice:"",retailPrice:"",packageContent:"",packingUnit:"",warning_num:"",producer:"",regNumber:"",position:"",product_info:"",productCode:"",category:"",reserve:0,goodsIcon:"",stock_name:"",stocks:"",producttime:"",nousetime:"",product_state:!1,models:""}},onLoad:function(e){o=this,a=uni.getStorageSync("uid"),uni.removeStorageSync("category"),uni.removeStorageSync("is_add"),e.id&&o.scan_by_id(e.id)},onShow:function(){if(uni.getStorageSync("now_product")){uni.setNavigationBarTitle({title:"编辑产品"});var t=uni.getStorageSync("now_product");if(o.text_desc="修改",o.goodsName=t.goodsName,o.costPrice=t.costPrice,o.retailPrice=t.retailPrice,o.packageContent=t.packageContent,o.packingUnit=t.packingUnit,o.warning_num=t.warning_num,o.producer=t.producer,o.regNumber=t.regNumber,o.position=t.position,o.product_info=t.product_info,o.productCode=t.productCode,o.category=t.second_class?t.second_class:"",o.reserve=t.reserve,o.goodsIcon=t.goodsIcon,o.product_state=t.product_state,t.models){var n;o.models=t.models,o.reserve=0,uni.getStorageSync("now_model")?n=uni.getStorageSync("now_model"):(n=t.models,uni.setStorageSync("now_model",n));var i,a=(0,r.default)(n);try{for(a.s();!(i=a.n()).done;){var l=i.value;o.reserve+=Number(l.reserve)}}catch(v){a.e(v)}finally{a.f()}}if(t.goodsClass){var c=s.default.Pointer("class_user");c.set(t.goodsClass.objectId)}if(t.second_class){var u=s.default.Pointer("second_class");u.set(t.second_class.objectId)}}if(uni.getStorageSync("warehouse")&&(o.stocks=uni.getStorageSync("warehouse")[0].stock,o.stock_name=uni.getStorageSync("warehouse")[0].stock.stock_name),uni.getStorageSync("category")){o.category=uni.getStorageSync("category");var d=s.default.Pointer("class_user");d.set(o.category.parent.objectId);var f=s.default.Pointer("second_class");f.set(o.category.objectId),e.log(o.category.parent.objectId,o.category.objectId)}},onUnload:function(){"","","",l.default.handleData()},methods:{formSubmit:function(t){e.log(t.detail.value);var n=t.detail.value;""==n.goodsName?uni.showToast({title:"请输入产品名称",icon:"none"}):o.upload_good(n)},upload_good:function(e){if(uni.showLoading({title:"上传中..."}),uni.getStorageSync("now_product"))o.add_good(e,"edit");else{var t=s.default.Query("Goods");t.equalTo("userId","==",a),t.equalTo("goodsName","==",e.goodsName),t.find().then((function(t){t.length>=1?uni.showToast({title:"你的库存中已存在此产品",icon:"none"}):o.add_good(e,"add")}))}},add_good:function(t,n){var i=s.default.Pointer("_User"),r=i.set(a),c=o.stocks.objectId?o.stocks.objectId:"",u=s.default.Pointer("stocks"),d=u.set(c),f=s.default.Query("Goods");f.set("stocks",d),f.set("reserve",Number(t.reserve)),uni.getStorageSync("now_model")&&f.set("models",uni.getStorageSync("now_model")),f.set("warning_num",Number(t.warning_num)),f.set("stocktype",Number(t.warning_num)>=Number(o.reserve)?0:1),f.set("userId",r),f.set("id",uni.getStorageSync("now_product")?uni.getStorageSync("now_product").objectId:""),f.save().then((function(e){uni.hideLoading(),l.default.log(uni.getStorageSync("user").nickName+"修改了产品'"+t.goodsName+"'",5,uni.getStorageSync("now_product").objectId),uni.navigateBack({delta:2}),setTimeout((function(){uni.showToast({title:"修改成功",duration:1e3})}),1e3),uni.setStorageSync("is_add",!0)})).catch((function(t){e.log(t)}))},handledata:function(){o.goodsName="",o.costPrice="",o.retailPrice="",o.packageContent="",o.packingUnit="",o.warning_num="",o.producer="",o.regNumber="",o.position="",o.product_info="",o.productCode="",o.category="",o.reserve=0,o.goodsIcon="",o.stocks="",o.stock_name="",o.producttime="",o.nousetime=""}}};t.default=f}).call(this,n("5a52")["default"])},"83ef":function(e,t,n){var i=n("24fb");t=i(!1),t.push([e.i,"[data-v-4c962800]::-webkit-scrollbar{width:2px;height:6px;background-color:initial}.uni-input-placeholder[data-v-4c962800]{font-size:12px}uni-input[data-v-4c962800]{font-size:12px}\n\n/*定义滑块 内阴影+圆角*/[data-v-4c962800]::-webkit-scrollbar-thumb{border-radius:10px;background-color:#999}.page[data-v-4c962800]{font-size:%?28?%;background:#fafafa;height:100vh;overflow:scroll}.frist[data-v-4c962800]{padding:0 %?20?%;background:#fff;margin-top:%?30?%}.input_item[data-v-4c962800]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;line-height:%?80?%;height:%?80?%;border-bottom:%?1?% solid#f6f5ec}.input_item2[data-v-4c962800]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;line-height:%?80?%;height:%?80?%;border-bottom:%?1?% solid#f6f5ec}.left_item[data-v-4c962800]{color:#333;width:%?150?%}.right_input1[data-v-4c962800]{font-size:12px}.submit_button[data-v-4c962800]{width:50%;background:#426ab3;border-radius:%?40?%;margin:%?30?%;height:%?88?%;line-height:%?88?%;color:#fff;font-size:%?30?%}.upload_image[data-v-4c962800]{width:%?180?%;height:%?180?%;line-height:%?220?%;text-align:center;border:%?1?% solid#999;border-radius:%?8?%}.notice_text[data-v-4c962800]{padding-top:%?20?%;font-size:%?32?%;color:#3d3d3d;font-weight:700}.reset_button[data-v-4c962800]{font-size:%?30?%;width:50%;background:#999;border-radius:%?40?%;margin:%?30?%;height:%?88?%;line-height:%?88?%;color:#fff}",""]),e.exports=t},"8dce":function(e,t,n){"use strict";n.r(t);var i=n("0860"),o=n("30a6");for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("ea8a");var r,s=n("f0c5"),l=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"4c962800",null,!1,i["a"],r);t["default"]=l.exports},a04f:function(e,t,n){"use strict";var i=n("ee27");n("4160"),n("a9e3"),n("d3b7"),n("ac1f"),n("25f0"),n("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n("3628")),a={name:"UniCollapseItem",components:{uniIcon:o.default},props:{title:{type:String,default:""},name:{type:[Number,String],default:0},disabled:{type:Boolean,default:!1},showAnimation:{type:Boolean,default:!1},open:{type:Boolean,default:!1},thumb:{type:String,default:""}},data:function(){var e=this.__call_hook?"uni_collapse_item":"Uni_".concat(Math.ceil(1e6*Math.random()).toString(36));return{isOpen:!1,height:"auto",elId:e}},watch:{open:function(e){this.isOpen=e}},inject:["collapse"],created:function(){if(this.isOpen=this.open,this.nameSync=this.name?this.name:this.collapse.childrens.length,this.collapse.childrens.push(this),this.collapse.accordion&&this.isOpen){var e=this.collapse.childrens[this.collapse.childrens.length-2];e&&(this.collapse.childrens[this.collapse.childrens.length-2].isOpen=!1)}},mounted:function(){this.getSize()},methods:{getSize:function(){var e=this;this.showAnimation&&uni.createSelectorQuery().in(this).select("#".concat(this.elId)).boundingClientRect().exec((function(t){e.height=t[0].height+"px"}))},onClick:function(){var e=this;this.disabled||(this.collapse.accordion&&this.collapse.childrens.forEach((function(t){t!==e&&(t.isOpen=!1)})),this.isOpen=!this.isOpen,this.collapse.onChange&&this.collapse.onChange())}}};t.default=a},b4ab:function(e,t,n){"use strict";n.r(t);var i=n("72dd"),o=n("35fc");for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("d6b8");var r,s=n("f0c5"),l=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"7cac7d33",null,!1,i["a"],r);t["default"]=l.exports},ce70:function(e,t,n){"use strict";var i={"uni-icon":n("3628").default},o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{class:["uni-collapse-cell",{"uni-collapse-cell--disabled":e.disabled,"uni-collapse-cell--open":e.isOpen}],attrs:{"hover-class":e.disabled?"":"uni-collapse-cell--hover"}},[n("v-uni-view",{staticClass:"uni-collapse-cell__title",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onClick.apply(void 0,arguments)}}},[e.thumb?n("v-uni-view",{staticClass:"uni-collapse-cell__title-extra"},[n("v-uni-image",{staticClass:"uni-collapse-cell__title-img",attrs:{src:e.thumb}})],1):e._e(),n("v-uni-view",{staticClass:"uni-collapse-cell__title-inner"},[n("v-uni-view",{staticClass:"uni-collapse-cell__title-text"},[e._v(e._s(e.title))])],1),n("v-uni-view",{staticClass:"uni-collapse-cell__title-arrow",class:{"uni-active":e.isOpen,"uni-collapse-cell--animation":!0===e.showAnimation}},[n("uni-icon",{attrs:{color:"#bbb",size:"20",type:"arrowdown"}})],1)],1),n("v-uni-view",{staticClass:"uni-collapse-cell__content",class:{"uni-collapse-cell--animation":!0===e.showAnimation},style:{height:e.isOpen?"auto":"0px"}},[n("v-uni-view",{attrs:{id:e.elId}},[e._t("default")],2)],1)],1)},a=[];n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}))},d0d7:function(e,t,n){var i=n("24fb");t=i(!1),t.push([e.i,'.uni-collapse-cell[data-v-07b66df4]{position:relative}.uni-collapse-cell--hover[data-v-07b66df4]{background-color:#f1f1f1}.uni-collapse-cell--open[data-v-07b66df4]{background-color:#f1f1f1}.uni-collapse-cell--disabled[data-v-07b66df4]{opacity:.3}.uni-collapse-cell--animation[data-v-07b66df4]{-webkit-transition:all .3s;transition:all .3s}.uni-collapse-cell[data-v-07b66df4]:after{position:absolute;z-index:3;right:0;bottom:0;left:0;height:1px;content:"";-webkit-transform:scaleY(.5);transform:scaleY(.5);background-color:#c8c7cc}.uni-collapse-cell__title[data-v-07b66df4]{padding:%?12?% %?30?%;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-flex:1;-webkit-flex:1;flex:1;position:relative;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.uni-collapse-cell__title-extra[data-v-07b66df4]{margin-right:%?18?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.uni-collapse-cell__title-img[data-v-07b66df4]{height:%?52?%;width:%?52?%}.uni-collapse-cell__title-arrow[data-v-07b66df4]{width:20px;height:20px;-webkit-transform:rotate(0);transform:rotate(0);-webkit-transform-origin:center center;transform-origin:center center}.uni-collapse-cell__title-arrow.uni-active[data-v-07b66df4]{-webkit-transform:rotate(-180deg);transform:rotate(-180deg)}.uni-collapse-cell__title-inner[data-v-07b66df4]{-webkit-box-flex:1;-webkit-flex:1;flex:1;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.uni-collapse-cell__title-text[data-v-07b66df4]{font-size:%?24?%;text-overflow:ellipsis;white-space:nowrap;color:inherit;line-height:1.5;overflow:hidden}.uni-collapse-cell__content[data-v-07b66df4]{position:relative;width:100%;overflow:hidden;background:#fff}.uni-collapse-cell__content uni-view[data-v-07b66df4]{font-size:%?28?%}',""]),e.exports=t},d24d:function(e,t,n){var i=n("83ef");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=n("4f06").default;o("f0b46e5e",i,!0,{sourceMap:!1,shadowMode:!1})},d6b8:function(e,t,n){"use strict";var i=n("e25f"),o=n.n(i);o.a},db7f:function(e,t,n){"use strict";n("4160"),n("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"UniCollapse",props:{accordion:{type:Boolean,default:!1}},data:function(){return{}},provide:function(){return{collapse:this}},created:function(){this.childrens=[]},methods:{onChange:function(){var e=[];this.childrens.forEach((function(t,n){t.isOpen&&e.push(t.nameSync)})),this.$emit("change",e)}}};t.default=i},e25f:function(e,t,n){var i=n("1961");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=n("4f06").default;o("2a095985",i,!0,{sourceMap:!1,shadowMode:!1})},ea8a:function(e,t,n){"use strict";var i=n("d24d"),o=n.n(i);o.a},f12f:function(e,t,n){"use strict";var i=n("70ae"),o=n.n(i);o.a},f9c7:function(e,t,n){"use strict";n.r(t);var i=n("a04f"),o=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a}}]);