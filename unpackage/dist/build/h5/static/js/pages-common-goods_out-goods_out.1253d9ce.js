(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-common-goods_out-goods_out"],{"20d8":function(t,e,i){"use strict";(function(t){var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("c5f6"),i("28a5");var o=n(i("5d73"));i("7514");var a,r,l=n(i("906f")),c=n(i("5e7b")),u=n(i("a99a")),s=n(i("eaf0")),d=n(i("f4e7")),f=n(i("36cf")),p={components:{unicard:c.default,faIcon:s.default,uninumberbox:u.default,uniNavBar:d.default,uniIcon:f.default},data:function(){return{products:null}},onLoad:function(e){var i=this;if(t.log(e),uni.removeStorageSync("is_option"),a=uni.getStorageSync("uid"),r=this,e.id){uni.showLoading({title:"加载中..."});var n=l.default.Query("Goods");"false"==e.type?n.equalTo("objectId","==",e.id):n.equalTo("productCode","==",e.id),n.equalTo("userId","==",a),n.find().then(function(e){t.log(e),-1==e[0].status?uni.showToast({title:"该产品已删除",icon:"none"}):(e[0].num=1,e[0].total_money=1*e[0].retailPrice,e[0].really_total_money=1*e[0].retailPrice,e[0].modify_retailPrice=e[0].retailPrice,i.products=e),wx.hideLoading()})}else{this.products=uni.getStorageSync("products");var c=0,u=!0,s=!1,d=void 0;try{for(var f,p=(0,o.default)(uni.getStorageSync("products"));!(u=(f=p.next()).done);u=!0){var v=f.value;t.log(v),v.selectd_model&&this.make_goods(v,v.selectd_model,c),c==uni.getStorageSync("products").length-1&&(this.products=[].concat.apply([],this.products)),c+=1}}catch(m){s=!0,d=m}finally{try{u||null==p.return||p.return()}finally{if(s)throw d}}}},methods:{scanGoods:function(){uni.scanCode({success:function(e){uni.showLoading({title:"加载中..."});var i=e.result,n=i.split("-"),c=l.default.Query("Goods");"false"==n[1]?c.equalTo("objectId","==",n[0]):c.equalTo("productCode","==",n[0]),c.equalTo("userId","==",a),c.find().then(function(e){if(t.log(e),-1==e[0].status)uni.showToast({title:"该产品已删除",icon:"none"});else{var i=!0,n=!1,a=void 0;try{for(var l,c=(0,o.default)(e);!(i=(l=c.next()).done);i=!0){var u=l.value;u.num=1,u.total_money=1*u.retailPrice,u.really_total_money=1*u.retailPrice,u.modify_retailPrice=u.retailPrice}}catch(s){n=!0,a=s}finally{try{i||null==c.return||c.return()}finally{if(n)throw a}}r.products=r.products.concat(e)}uni.hideLoading()})},fail:function(t){uni.showToast({title:"未识别到条形码",icon:"none"})}})},make_goods:function(e,i,n){t.log(e,i,n);var a=[];this.products.splice(n,1);var r=!0,l=!1,c=void 0;try{for(var u,s=(0,o.default)(JSON.parse(i));!(r=(u=s.next()).done);r=!0){var d=u.value,f={};f.reserve=JSON.parse(d).reserve,f.costPrice=e.costPrice,f.createdAt=e.createdAt,f.goodsIcon=e.goodsIcon,f.goodsName=e.goodsName+JSON.parse(d).custom1.value+JSON.parse(d).custom2.value+JSON.parse(d).custom3.value+JSON.parse(d).custom4.value,f.is_selected=e.is_selected,f.key=e.key,f.models=e.models,f.modify_retailPrice=e.modify_retailPrice,f.num=e.num,f.objectId=e.objectId,f.packageContent=e.packageContent,f.packingUnit=e.packingUnit,f.position=e.position,f.producer=e.producer,f.productCode=e.productCode,f.product_info=e.product_info,f.product_state=e.product_state,f.regNumber=e.regNumber,f.retailPrice=e.retailPrice,f.selectd_model=e.selectd_model,f.stocks=e.stocks,f.stocktype=e.stocktype,f.total_money=e.total_money,f.really_total_money=e.really_total_money,f.updatedAt=e.updatedAt,f.userId=e.userId,f.warning_num=e.warning_num,a.push(f)}}catch(p){l=!0,c=p}finally{try{r||null==s.return||s.return()}finally{if(l)throw c}}this.products[n]=a},confrim_this:function(){uni.navigateTo({url:"/pages/common/goods_out/out_detail/out_detail"})},handleNumChange:function(t,e){this.products[e].num=Number(t),this.products[e].total_money=Number(t)*Number(this.products[e].modify_retailPrice),this.products[e].really_total_money=Number(t)*Number(this.products[e].really_total_money),uni.setStorageSync("products",this.products)},handleDel:function(e){t.log(e),1==this.products.length?uni.showToast({title:"最少选择一个产品",icon:"none"}):(this.products.splice(e,1),uni.setStorageSync("products",this.products))},getrealprice:function(t,e){this.products[e].modify_retailPrice=t.target.value,this.products[e].total_money=this.products[e].num*Number(t.target.value),uni.setStorageSync("products",this.products)}}};e.default=p}).call(this,i("5a52")["default"])},"25cb":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".page[data-v-bd29adc2]{font-size:%?28?%;height:calc(100vh - %?88?%);overflow:scroll}.margin-b-10[data-v-bd29adc2]{margin-top:%?20?%}.input_withlabel[data-v-bd29adc2]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;margin:%?10?% 0}.bottom_del[data-v-bd29adc2]{text-align:right}.del[data-v-bd29adc2]{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;background:#aa2116;color:#fff;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;padding:%?4?% %?12?%;border-radius:%?8?%}.input_label[data-v-bd29adc2]{border:%?1?% solid#ddd;border-radius:%?8?%;padding:0 %?6?%;width:%?140?%;color:#aa2116}",""])},3081:function(t,e,i){"use strict";i.r(e);var n=i("6665"),o=i("8063");for(var a in o)"default"!==a&&function(t){i.d(e,t,function(){return o[t]})}(a);i("9305");var r=i("2877"),l=Object(r["a"])(o["default"],n["a"],n["b"],!1,null,"bd29adc2",null);e["default"]=l.exports},6665:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("uni-nav-bar",{attrs:{fixed:!1,color:"#333333","background-color":"#FFFFFF","right-text":"确定",leftIcon:"scan","left-text":"扫码"},on:{"click-right":function(e){e=t.$handleEvent(e),t.confrim_this(e)},"click-left":function(e){e=t.$handleEvent(e),t.scanGoods(e)}}}),i("v-uni-view",{staticClass:"page"},t._l(t.products,function(e,n){return i("v-uni-view",{key:n,staticClass:"margin-b-10"},[i("unicard",{attrs:{title:"品名："+e.goodsName}},[i("v-uni-view",[i("v-uni-view",{staticStyle:{"margin-bottom":"10rpx"}},[t._v("库存："+t._s(e.reserve))]),i("v-uni-view",[t._v("建议零售价格："+t._s(e.retailPrice)+"(元)")]),i("v-uni-view",{staticClass:"input_withlabel"},[i("v-uni-view",[t._v("实际价格(可修改)：")]),i("v-uni-view",[i("v-uni-input",{staticClass:"input_label",attrs:{placeholder:e.retailPrice,type:"digit"},on:{input:function(e){e=t.$handleEvent(e),t.getrealprice(e,n)}}})],1)],1),i("v-uni-view",{staticClass:"margin-t-5"},[t._v("出库量："),i("uninumberbox",{attrs:{min:1,max:e.reserve},on:{change:function(e){e=t.$handleEvent(e),t.handleNumChange(e,n)}}})],1),i("v-uni-view",{staticClass:"bottom_del"},[i("v-uni-view",{staticClass:"del",on:{click:function(e){e=t.$handleEvent(e),t.handleDel(n)}}},[i("fa-icon",{attrs:{type:"close",size:"15",color:"#fff"}}),t._v("删除")],1)],1)],1)],1)],1)}),1)],1)},o=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return o})},8063:function(t,e,i){"use strict";i.r(e);var n=i("20d8"),o=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,function(){return n[t]})}(a);e["default"]=o.a},9305:function(t,e,i){"use strict";var n=i("bbd8"),o=i.n(n);o.a},bbd8:function(t,e,i){var n=i("25cb");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var o=i("4f06").default;o("0c0dfc98",n,!0,{sourceMap:!1,shadowMode:!1})}}]);