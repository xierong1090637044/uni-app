(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-productCount-productCount"],{"0306":function(t,e,a){"use strict";(function(t){var i=a("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(a("5d73"));a("7514");var n,s,r,d,u=i(a("906f")),l=i(a("93e8")),c={components:{},data:function(){return{starttime:"起始时间",endtime:"截止时间",dataList:[],pageSize:30,pageNum:1,is_selected:!1,searchGoodName:"",category:""}},onLoad:function(t){n=this,s=wx.getStorageSync("uid"),uni.removeStorageSync("category");var e=new Date,a=e.getFullYear(),i=e.getMonth()+1;n.starttime=a+"-"+i+"-01",n.endtime=l.default.getDay(0),r=a+"-"+i+"-01",d=l.default.getDay(0),n.getdetail()},onShow:function(){uni.getStorageSync("category")&&(n.category=uni.getStorageSync("category"),n.is_selected=!1,n.getdetail())},methods:{seachGoodName:function(t){n.is_selected=!0,n.searchGoodName=t.detail.value,n.getdetail()},selected_startday:function(t){n.starttime=t.detail.value,n.starttime==r&&n.endtime==d?n.is_selected=!1:n.is_selected=!0,n.getdetail()},selected_endday:function(t){n.endtime=t.detail.value,n.starttime==r&&n.endtime==d?n.is_selected=!1:n.is_selected=!0,n.getdetail()},getdetail:function(){uni.showLoading({title:"加载中..."});var t=u.default.Query("Bills");t.equalTo("userId","==",s),t.equalTo("createdAt",">=",n.starttime+" 00:00:00"),t.equalTo("createdAt","<=",n.endtime+" 23:59:59"),t.equalTo("goodsName","==",{$regex:n.searchGoodName+".*"});var e=t.equalTo("type","==",1),a=t.equalTo("type","==",-1);t.or(e,a),t.include("goodsId"),t.statTo("sum","num,total_money"),t.statTo("groupby","goodsId,type"),t.statTo("order","-_sumnum"),t.find().then(function(t){uni.hideLoading();var e=[],a=!0,i=!1,s=void 0;try{for(var r,d=(0,o.default)(t);!(a=(r=d.next()).done);a=!0){var u=r.value,l={};1==u.type?(l.type=1,l.goodsId=u.goodsId,l._sumNum1=u._sumNum,l._sumTotal_money1=u._sumTotal_money,l._sumNum2=0,l._sumTotal_money2=0):-1==u.type&&(l.type=-1,l.goodsId=u.goodsId,l._sumNum1=0,l._sumTotal_money1=0,l._sumNum2=u._sumNum,l._sumTotal_money2=u._sumTotal_money),e.push(l)}}catch(c){i=!0,s=c}finally{try{a||null==d.return||d.return()}finally{if(i)throw s}}n.filterRoomNames(e)})},filterRoomNames:function(e){for(var a={},i=[],r=0;r<e.length;r++){var d=e[r];if(a[d.goodsId.objectId])for(var l=0;l<i.length;l++){var c=i[l];c.goodsId.objectId==d.goodsId.objectId&&(1==c.type?(c._sumNum2=d._sumNum2,c._sumTotal_money2=d._sumTotal_money2):-1==c.type&&(c._sumNum1=d._sumNum1,c._sumTotal_money1=d._sumTotal_money1))}else i.push(d),a[d.goodsId.objectId]=d}if(n.is_selected)n.dataList=i;else{var v=[],f=[],g=u.default.Query("Goods");g.equalTo("userId","==",s),g.equalTo("status","!=",-1),1==n.category.type?g.equalTo("goodsClass","==",n.category.objectId):g.equalTo("second_class","==",n.category.objectId),g.select("goodsName,reserve"),g.limit(500),g.find().then(function(t){var e=!0,a=!1,n=void 0;try{for(var s,r=(0,o.default)(t);!(e=(s=r.next()).done);e=!0){var d=s.value,u={};u.goodsId=d,u._sumNum2=0,u._sumTotal_money2=0,u._sumNum1=0,u._sumTotal_money1=0,f.push(u),v.push(d.objectId)}}catch(g){a=!0,n=g}finally{try{e||null==r.return||r.return()}finally{if(a)throw n}}for(var l=0;l<i.length;l++){var c=i[l];v.indexOf(c.goodsId.objectId)>-1&&(f.splice(v.indexOf(c.goodsId.objectId),1),f.unshift(c))}}),t.log(f),n.dataList=f}wx.hideLoading()}}};e.default=c}).call(this,a("5a52")["default"])},"08e9":function(t,e,a){var i=a("6253");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=a("4f06").default;o("b9b84838",i,!0,{sourceMap:!1,shadowMode:!1})},"11e5":function(t,e,a){"use strict";var i=a("08e9"),o=a.n(i);o.a},"2d2f":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"uni-tab-bar"},[a("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"30rpx 0","border-bottom":"6rpx solid#DDDDDD"}},[a("v-uni-picker",{staticClass:"frist_item display_flex",attrs:{mode:"date",fields:"day",start:t.starttime},on:{change:function(e){e=t.$handleEvent(e),t.selected_startday(e)}}},[a("v-uni-text",{staticStyle:{"margin-right":"10rpx"}},[t._v(t._s(t.starttime))]),a("fa-icon",{attrs:{type:"angle-down",size:"20",color:"#999"}})],1),a("v-uni-picker",{staticClass:"frist_item display_flex",attrs:{mode:"date",fields:"day",start:t.endtime},on:{change:function(e){e=t.$handleEvent(e),t.selected_endday(e)}}},[a("v-uni-text",{staticStyle:{"margin-right":"10rpx"}},[t._v(t._s(t.endtime))]),a("fa-icon",{attrs:{type:"angle-down",size:"20",color:"#999"}})],1)],1),a("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{padding:"20rpx 30rpx"}},[a("v-uni-view",{staticClass:"input_goodname"},[a("v-uni-input",{staticStyle:{height:"60rpx"},attrs:{placeholder:"请输入产品名字"},on:{confirm:function(e){e=t.$handleEvent(e),t.seachGoodName(e)},blur:function(e){e=t.$handleEvent(e),t.seachGoodName(e)}}})],1),a("v-uni-navigator",{staticClass:"display_flex",attrs:{"hover-class":"none",url:"/pages/manage/category/category?type=choose"}},[a("v-uni-view",[a("v-uni-input",{staticStyle:{width:"140rpx"},attrs:{placeholder:"产品类别",value:t.category.class_text,disabled:"true"}})],1),a("fa-icon",{attrs:{type:"angle-right",size:"20",color:"#999"}})],1)],1),a("v-uni-view",{staticStyle:{padding:"4rpx 30rpx"}},[a("v-uni-view",{staticClass:"display_flex_bet",staticStyle:{background:"#90d7ec",padding:"10rpx 0"}},[a("v-uni-view",{staticClass:"Listitem",staticStyle:{padding:"0 10rpx"}},[t._v("产品名称")]),a("v-uni-view",{staticClass:"Listitem",staticStyle:{padding:"0 10rpx"}},[t._v("当前库存")]),a("v-uni-view",{staticClass:"Listitem"},[t._v("进")]),a("v-uni-view",{staticClass:"Listitem"},[t._v("出")]),a("v-uni-view",{staticClass:"Listitem"},[t._v("总成本")]),a("v-uni-view",{staticClass:"Listitem"},[t._v("销售额")])],1)],1),a("v-uni-scroll-view",{staticClass:"content",attrs:{"scroll-y":""}},t._l(t.dataList,function(e,i){return a("v-uni-view",{key:i,staticClass:"display_flex_bet",style:{padding:"10rpx 0;",background:i%2==0?"#f2eada":""}},[a("v-uni-view",{staticClass:"text_overflow_2  Listitem",staticStyle:{padding:"0 10rpx"}},[t._v(t._s(e.goodsId.goodsName))]),a("v-uni-view",{staticClass:"Listitem",staticStyle:{padding:"0 10rpx"}},[t._v(t._s(e.goodsId.reserve))]),a("v-uni-view",{staticClass:"Listitem"},[t._v(t._s(e._sumNum1))]),a("v-uni-view",{staticClass:"Listitem"},[t._v(t._s(e._sumNum2))]),a("v-uni-view",{staticClass:"Listitem"},[t._v(t._s(e._sumTotal_money1))]),a("v-uni-view",{staticClass:"Listitem"},[t._v(t._s(e._sumTotal_money2))])],1)}),1)],1)},o=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return o})},"426a":function(t,e,a){"use strict";a.r(e);var i=a("0306"),o=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,function(){return i[t]})}(n);e["default"]=o.a},6253:function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,"uni-page-body[data-v-1f296640]{font-size:%?28?%;color:#3d3d3d;background:#fff}.input_goodname[data-v-1f296640]{background:#e5e5e5;border-radius:%?40?%;padding:0 %?20?%;font-size:%?24?%}.Listitem[data-v-1f296640]{width:16.66%;text-align:center;font-size:%?24?%}.bottomEle[data-v-1f296640]{position:fixed;bottom:%?0?%;-webkit-box-shadow:0 %?0?% %?10?% rgba(0,0,0,.5);box-shadow:0 %?0?% %?10?% rgba(0,0,0,.5);width:calc(100% - %?60?%);padding:%?20?% %?30?%;font-weight:700;background:#fff}.text_overflow_2[data-v-1f296640]{word-break:break-all;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.swiper-tab-list[data-v-1f296640]{height:100%;line-height:%?100?%!important}.frist_item[data-v-1f296640]{-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;width:50%}.content[data-v-1f296640]{width:100%;padding:%?10?% %?30?%;width:calc(100% - %?60?%);height:calc(100vh - %?182?%)}.content_time[data-v-1f296640]{text-align:right;color:#999}.detail_item[data-v-1f296640]{border-bottom:%?1?% solid#ccc;margin-bottom:%?10?%;padding-bottom:%?10?%}.detail_name[data-v-1f296640]{font-size:%?32?%;margin-bottom:%?6?%;font-weight:700}body.?%PAGE?%[data-v-1f296640]{background:#fff}",""])},"93e8":function(t,e,a){"use strict";(function(e){var i=a("288e");a("6b54"),a("87b3"),a("c5f6");var o=i(a("5d73"));a("7514");var n=i(a("906f"));t.exports={handleData:function(){uni.removeStorageSync("warehouse"),uni.removeStorageSync("stock"),uni.removeStorageSync("custom"),uni.removeStorageSync("category"),uni.removeStorageSync("class_user"),uni.removeStorageSync("second_class")},log:function(t,a,i){var o=n.default.Pointer("_User"),s=o.set(uni.getStorageSync("uid")),r=n.default.Query("logs");r.set("parent",s),r.set("log",t),r.set("detail_id",i),r.set("type",a),r.save().then(function(t){e.log(t)}).catch(function(t){e.log(t)})},record_shopOut:function(t,a){e.log(t,a);var i=n.default.Query("shops");i.set("id",t),i.set("have_out",a),i.save().then(function(t){e.log(t)}).catch(function(t){e.log(t)})},record_staffOut:function(t){if(e.log(t,uni.getStorageSync("user").have_out),1==uni.getStorageSync("identity"));else{var a=n.default.Query("staffs");a.set("id",uni.getStorageSync("user").objectId),a.set("have_out",t+uni.getStorageSync("user").have_out),a.save().then(function(t){e.log(t)}).catch(function(t){e.log(t)})}},get_allCost:function(){var t=uni.getStorageSync("uid");e.log(t);var a=n.default.Query("Goods");a.equalTo("userId","==",t),a.find().then(function(t){e.log(t);var a=!0,i=!1,n=void 0;try{for(var s,r=(0,o.default)(t);!(a=(s=r.next()).done);a=!0){var d=s.value;e.log(d),Number(d.costPrice)*d.reserve,d.reserve}}catch(u){i=!0,n=u}finally{try{a||null==r.return||r.return()}finally{if(i)throw n}}})},getDay:function(t,e){var a=this,i=new Date,o=i.getTime()+864e5*t;i.setTime(o);var n=i.getFullYear(),s=i.getMonth(),r=i.getDate();return s=a.handleMonth(s+1),r=a.handleMonth(r),e?n+"-"+s+"-"+r+" 00:00:00":n+"-"+s+"-"+r},js_date_time:function(t,e){var a=new Date(t),i=a.getFullYear(),o=a.getMonth()+1;o=o<10?"0"+o:o;var n=a.getDate();n=n<10?"0"+n:n;var s=a.getHours();s=s<10?"0"+s:s;var r=a.getMinutes(),d=a.getSeconds();return r=r<10?"0"+r:r,d=d<10?"0"+d:d,e?i+"-"+o+"-"+n+" "+s+":"+r:i+"-"+o+"-"+n},handleMonth:function(t){var e=t;return 1==t.toString().length&&(e="0"+t),e}}}).call(this,a("5a52")["default"])},e12c:function(t,e,a){"use strict";a.r(e);var i=a("2d2f"),o=a("426a");for(var n in o)"default"!==n&&function(t){a.d(e,t,function(){return o[t]})}(n);a("11e5");var s=a("2877"),r=Object(s["a"])(o["default"],i["a"],i["b"],!1,null,"1f296640",null);e["default"]=r.exports}}]);